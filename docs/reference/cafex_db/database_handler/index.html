
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="http://127.0.0.1:8000/C%3A/Users/pratik_mehta/PycharmProjects/cafex/docs/reference/cafex_db/database_handler/">
      
      
        <link rel="prev" href="../assertions/">
      
      
        <link rel="next" href="../databricks_utils/">
      
      
      <link rel="icon" href="../../../../../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.34">
    
    
      
        <title>database_handler - CafeX Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../../../../../../../assets/stylesheets/main.35f28582.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../../../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../../../../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cafex_db.database_handler" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../../../../../.." title="CafeX Documentation" class="md-header__button md-logo" aria-label="CafeX Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CafeX Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              database_handler
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../../../../../.." title="CafeX Documentation" class="md-nav__button md-logo" aria-label="CafeX Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    CafeX Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../license/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    C:
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            C:
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Users
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Users
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1_1" id="__nav_3_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Pratik mehta
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1_1">
            <span class="md-nav__icon md-icon"></span>
            Pratik mehta
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_1" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1_1_1" id="__nav_3_1_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    PycharmProjects
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_1_1_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1_1_1">
            <span class="md-nav__icon md-icon"></span>
            PycharmProjects
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_1_1" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1_1_1_1" id="__nav_3_1_1_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cafex
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_3_1_1_1_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1_1_1_1">
            <span class="md-nav__icon md-icon"></span>
            Cafex
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_1_1_1" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1_1_1_1_1" id="__nav_3_1_1_1_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Docs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_3_1_1_1_1_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1_1_1_1_1">
            <span class="md-nav__icon md-icon"></span>
            Docs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_1_1_1_1" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1_1_1_1_1_1" id="__nav_3_1_1_1_1_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="7" aria-labelledby="__nav_3_1_1_1_1_1_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1_1_1_1_1_1">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cafex
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_1_1_1_1_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../cafex_api/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    cafex_api
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_1_1_1_1_2" id="__nav_3_1_1_1_1_1_1_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="8" aria-labelledby="__nav_3_1_1_1_1_1_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_1_1_1_1_2">
            <span class="md-nav__icon md-icon"></span>
            cafex_api
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_api/assertions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    assertions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_api/request_builder/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    request_builder
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_api/response_parser_json/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    response_parser_json
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_api/response_parser_xml/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    response_parser_xml
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_api/socket_handler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    socket_handler
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_1_1_1_1_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../cafex_core/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    cafex_core
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_1_1_1_1_3" id="__nav_3_1_1_1_1_1_1_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="8" aria-labelledby="__nav_3_1_1_1_1_1_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_1_1_1_1_3">
            <span class="md-nav__icon md-icon"></span>
            cafex_core
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_1_1_1_1_3_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../cafex_core/handlers/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    handlers
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_1_1_1_1_3_1" id="__nav_3_1_1_1_1_1_1_3_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="9" aria-labelledby="__nav_3_1_1_1_1_1_1_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_1_1_1_1_3_1">
            <span class="md-nav__icon md-icon"></span>
            handlers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/handlers/file_handler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    file_handler
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/handlers/folder_handler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    folder_handler
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/integrations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    integrations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_1_1_1_1_3_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../cafex_core/logging/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    logging
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_1_1_1_1_3_3" id="__nav_3_1_1_1_1_1_1_3_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="9" aria-labelledby="__nav_3_1_1_1_1_1_1_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_1_1_1_1_3_3">
            <span class="md-nav__icon md-icon"></span>
            logging
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/logging/colargulog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    colargulog
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/logging/logger_/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    logger_
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_1_1_1_1_3_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../cafex_core/parsers/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    parsers
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_1_1_1_1_3_4" id="__nav_3_1_1_1_1_1_1_3_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="9" aria-labelledby="__nav_3_1_1_1_1_1_1_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_1_1_1_1_3_4">
            <span class="md-nav__icon md-icon"></span>
            parsers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/parsers/html_parser/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    html_parser
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/parsers/ini_parser/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ini_parser
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/parsers/json_parser/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    json_parser
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/parsers/text_file_parser/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    text_file_parser
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/parsers/xml_parser/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    xml_parser
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/post_install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    post_install
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_1_1_1_1_3_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../cafex_core/singletons_/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    singletons_
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_1_1_1_1_3_6" id="__nav_3_1_1_1_1_1_1_3_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="9" aria-labelledby="__nav_3_1_1_1_1_1_1_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_1_1_1_1_3_6">
            <span class="md-nav__icon md-icon"></span>
            singletons_
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/singletons_/request_/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    request_
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/singletons_/session_/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    session_
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_1_1_1_1_3_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../cafex_core/utils/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    utils
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_1_1_1_1_3_7" id="__nav_3_1_1_1_1_1_1_3_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="9" aria-labelledby="__nav_3_1_1_1_1_1_1_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_1_1_1_1_3_7">
            <span class="md-nav__icon md-icon"></span>
            utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/apache_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    apache_utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/assertions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    assertions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/config_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    config_utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/constants/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    constants
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/core_database_handler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    core_database_handler
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/core_security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    core_security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/custom_encryption/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    custom_encryption
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/date_time_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    date_time_utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/elastic_search_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    elastic_search_utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/email_alert_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    email_alert_utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/error_category/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    error_category
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/exceptions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    exceptions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/file_reader_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    file_reader_utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/file_transfer_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    file_transfer_utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/ftplib_wrapper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ftplib_wrapper
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_1_1_1_1_3_7_16" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../cafex_core/utils/hooks_/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    hooks_
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_1_1_1_1_3_7_16" id="__nav_3_1_1_1_1_1_1_3_7_16_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="10" aria-labelledby="__nav_3_1_1_1_1_1_1_3_7_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_1_1_1_1_3_7_16">
            <span class="md-nav__icon md-icon"></span>
            hooks_
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/hooks_/hook_helper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hook_helper
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/hooks_/hook_util/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hook_util
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/hooks_/pytest_add_option_hook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pytest_add_option_hook
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/hooks_/pytest_after_scenario_hook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pytest_after_scenario_hook
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/hooks_/pytest_after_step_hook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pytest_after_step_hook
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/hooks_/pytest_bdd_before_step/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pytest_bdd_before_step
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/hooks_/pytest_bdd_step_error/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pytest_bdd_step_error
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/hooks_/pytest_before_scenario_hook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pytest_before_scenario_hook
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/hooks_/pytest_collection_finish_hook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pytest_collection_finish_hook
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/hooks_/pytest_configure_hook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pytest_configure_hook
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/hooks_/pytest_run_test_logreport/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pytest_run_test_logreport
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/hooks_/pytest_run_test_setup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pytest_run_test_setup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/hooks_/pytest_session_finish_/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pytest_session_finish_
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/hooks_/pytest_session_start_hook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pytest_session_start_hook
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/implicit_ftp_tls/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    implicit_ftp_tls
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/item_access/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    item_access
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/kibana_reporting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kibana_reporting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/local_reporting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    local_reporting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/log/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    log
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/ms_teams_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ms_teams_utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/old_hook_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    old_hook_utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/parsing_logs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    parsing_logs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/pyglobals/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pyglobals
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/ssh_handler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ssh_handler
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_core/utils/windows_remote_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    windows_remote_utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_1_1_1_1_4" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    cafex_db
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_1_1_1_1_4" id="__nav_3_1_1_1_1_1_1_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="8" aria-labelledby="__nav_3_1_1_1_1_1_1_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1_1_1_1_1_1_4">
            <span class="md-nav__icon md-icon"></span>
            cafex_db
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../assertions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    assertions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    database_handler
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    database_handler
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cafex_db.database_handler" class="md-nav__link">
    <span class="md-ellipsis">
      database_handler
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler" class="md-nav__link">
    <span class="md-ellipsis">
      DatabaseHandler
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DatabaseHandler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.__difference_formatter" class="md-nav__link">
    <span class="md-ellipsis">
      __difference_formatter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.cassandra" class="md-nav__link">
    <span class="md-ellipsis">
      cassandra
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.cassandra_resultset_to_list" class="md-nav__link">
    <span class="md-ellipsis">
      cassandra_resultset_to_list
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.check_data_in_column" class="md-nav__link">
    <span class="md-ellipsis">
      check_data_in_column
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.check_db_exists" class="md-nav__link">
    <span class="md-ellipsis">
      check_db_exists
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.check_headers_in_resultlist" class="md-nav__link">
    <span class="md-ellipsis">
      check_headers_in_resultlist
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.check_table_exists" class="md-nav__link">
    <span class="md-ellipsis">
      check_table_exists
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.check_value_exists_in_column" class="md-nav__link">
    <span class="md-ellipsis">
      check_value_exists_in_column
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.check_value_not_exists_in_column" class="md-nav__link">
    <span class="md-ellipsis">
      check_value_not_exists_in_column
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.close" class="md-nav__link">
    <span class="md-ellipsis">
      close
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.compare_dataframes_distinct" class="md-nav__link">
    <span class="md-ellipsis">
      compare_dataframes_distinct
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.compare_resultlists" class="md-nav__link">
    <span class="md-ellipsis">
      compare_resultlists
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.create_db_connection" class="md-nav__link">
    <span class="md-ellipsis">
      create_db_connection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.data_frame_diff" class="md-nav__link">
    <span class="md-ellipsis">
      data_frame_diff
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.dataframe_to_csv" class="md-nav__link">
    <span class="md-ellipsis">
      dataframe_to_csv
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.execute_query_from_file" class="md-nav__link">
    <span class="md-ellipsis">
      execute_query_from_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.execute_statement" class="md-nav__link">
    <span class="md-ellipsis">
      execute_statement
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.get_column_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_column_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.get_headers" class="md-nav__link">
    <span class="md-ellipsis">
      get_headers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.get_rowcount" class="md-nav__link">
    <span class="md-ellipsis">
      get_rowcount
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.hive_execute_statement" class="md-nav__link">
    <span class="md-ellipsis">
      hive_execute_statement
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.hiveconnection" class="md-nav__link">
    <span class="md-ellipsis">
      hiveconnection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.is_rowcount_zero" class="md-nav__link">
    <span class="md-ellipsis">
      is_rowcount_zero
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.list_to_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      list_to_dataframe
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.modify_sql_query" class="md-nav__link">
    <span class="md-ellipsis">
      modify_sql_query
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.mssql" class="md-nav__link">
    <span class="md-ellipsis">
      mssql
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.mysql" class="md-nav__link">
    <span class="md-ellipsis">
      mysql
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.oracle" class="md-nav__link">
    <span class="md-ellipsis">
      oracle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.postgres" class="md-nav__link">
    <span class="md-ellipsis">
      postgres
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.resultlist_to_csv" class="md-nav__link">
    <span class="md-ellipsis">
      resultlist_to_csv
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.spark_execute_statement" class="md-nav__link">
    <span class="md-ellipsis">
      spark_execute_statement
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.verify_column_metadata" class="md-nav__link">
    <span class="md-ellipsis">
      verify_column_metadata
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../databricks_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    databricks_utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../db_security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    db_security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../snowflake_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    snowflake_utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_1_1_1_1_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../cafex_ui/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    cafex_ui
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_1_1_1_1_5" id="__nav_3_1_1_1_1_1_1_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="8" aria-labelledby="__nav_3_1_1_1_1_1_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_1_1_1_1_5">
            <span class="md-nav__icon md-icon"></span>
            cafex_ui
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_ui/assertions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    assertions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_ui/image_comparision_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    image_comparision_utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_1_1_1_1_5_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../cafex_ui/mobile_client/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    mobile_client
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_1_1_1_1_5_3" id="__nav_3_1_1_1_1_1_1_5_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="9" aria-labelledby="__nav_3_1_1_1_1_1_1_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_1_1_1_1_5_3">
            <span class="md-nav__icon md-icon"></span>
            mobile_client
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_ui/mobile_client/mobile_client_actions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mobile_client_actions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_ui/mobile_client/mobile_driver_factory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mobile_driver_factory
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_ui/mobile_client/mobile_driver_initializer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mobile_driver_initializer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_ui/mobile_client/mobile_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mobile_utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_ui/self_healing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    self_healing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_1_1_1_1_5_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../cafex_ui/thick_client/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    thick_client
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_1_1_1_1_5_5" id="__nav_3_1_1_1_1_1_1_5_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="9" aria-labelledby="__nav_3_1_1_1_1_1_1_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_1_1_1_1_5_5">
            <span class="md-nav__icon md-icon"></span>
            thick_client
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_ui/thick_client/thick_client_actions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    thick_client_actions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_ui/thick_client/thick_client_application_handler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    thick_client_application_handler
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_ui/ui_security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ui_security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_1_1_1_1_5_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../cafex_ui/web_client/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    web_client
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_1_1_1_1_5_7" id="__nav_3_1_1_1_1_1_1_5_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="9" aria-labelledby="__nav_3_1_1_1_1_1_1_5_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_1_1_1_1_5_7">
            <span class="md-nav__icon md-icon"></span>
            web_client
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_ui/web_client/base_driver_factory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    base_driver_factory
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_1_1_1_1_1_5_7_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../cafex_ui/web_client/drivers/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    drivers
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1_1_1_1_1_1_5_7_2" id="__nav_3_1_1_1_1_1_1_5_7_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="10" aria-labelledby="__nav_3_1_1_1_1_1_1_5_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1_1_1_1_1_1_5_7_2">
            <span class="md-nav__icon md-icon"></span>
            drivers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_ui/web_client/drivers/chrome_driver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chrome_driver
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_ui/web_client/drivers/edge_driver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    edge_driver
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_ui/web_client/drivers/firefox_driver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    firefox_driver
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_ui/web_client/drivers/headless_chrome_driver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    headless_chrome_driver
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_ui/web_client/drivers/internet_explorer_driver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    internet_explorer_driver
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_ui/web_client/drivers/safari_driver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    safari_driver
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_ui/web_client/keyboard_mouse_actions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    keyboard_mouse_actions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_ui/web_client/selenium_helper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    selenium_helper
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_ui/web_client/ui_web_driver_initializer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ui_web_driver_initializer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_ui/web_client/web_client_actions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    web_client_actions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_ui/web_client/web_client_enum/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    web_client_enum
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cafex_ui/web_client/web_driver_factory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    web_driver_factory
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../cafex/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cafex
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../cafex_api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cafex api
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../cafex_core/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cafex core
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../cafex_ui/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cafex ui
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../developer_guide/DEV-README/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Developer guide
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cafex
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../../../../../reference/cafex_api/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    cafex_api
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_9_2" id="__nav_9_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_2">
            <span class="md-nav__icon md-icon"></span>
            cafex_api
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_api/assertions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    assertions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_api/request_builder/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    request_builder
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_api/response_parser_json/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    response_parser_json
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_api/response_parser_xml/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    response_parser_xml
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_api/socket_handler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    socket_handler
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../../../../../reference/cafex_core/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    cafex_core
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_9_3" id="__nav_9_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_3">
            <span class="md-nav__icon md-icon"></span>
            cafex_core
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_3_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../../../../../reference/cafex_core/handlers/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    handlers
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_9_3_1" id="__nav_9_3_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_9_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_3_1">
            <span class="md-nav__icon md-icon"></span>
            handlers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/handlers/file_handler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    file_handler
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/handlers/folder_handler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    folder_handler
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/integrations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    integrations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_3_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../../../../../reference/cafex_core/logging/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    logging
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_9_3_3" id="__nav_9_3_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_9_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_3_3">
            <span class="md-nav__icon md-icon"></span>
            logging
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/logging/colargulog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    colargulog
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/logging/logger_/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    logger_
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_3_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../../../../../reference/cafex_core/parsers/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    parsers
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_9_3_4" id="__nav_9_3_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_9_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_3_4">
            <span class="md-nav__icon md-icon"></span>
            parsers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/parsers/html_parser/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    html_parser
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/parsers/ini_parser/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ini_parser
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/parsers/json_parser/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    json_parser
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/parsers/text_file_parser/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    text_file_parser
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/parsers/xml_parser/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    xml_parser
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/post_install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    post_install
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_3_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../../../../../reference/cafex_core/singletons_/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    singletons_
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_9_3_6" id="__nav_9_3_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_9_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_3_6">
            <span class="md-nav__icon md-icon"></span>
            singletons_
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/singletons_/request_/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    request_
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/singletons_/session_/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    session_
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_3_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../../../../../reference/cafex_core/utils/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    utils
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_9_3_7" id="__nav_9_3_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_9_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_3_7">
            <span class="md-nav__icon md-icon"></span>
            utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/apache_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    apache_utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/assertions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    assertions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/config_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    config_utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/constants/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    constants
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/core_database_handler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    core_database_handler
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/core_security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    core_security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/custom_encryption/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    custom_encryption
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/date_time_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    date_time_utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/elastic_search_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    elastic_search_utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/email_alert_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    email_alert_utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/error_category/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    error_category
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/exceptions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    exceptions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/file_reader_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    file_reader_utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/file_transfer_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    file_transfer_utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/ftplib_wrapper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ftplib_wrapper
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_3_7_16" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../../../../../reference/cafex_core/utils/hooks_/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    hooks_
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_9_3_7_16" id="__nav_9_3_7_16_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_9_3_7_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_3_7_16">
            <span class="md-nav__icon md-icon"></span>
            hooks_
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/hooks_/hook_helper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hook_helper
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/hooks_/hook_util/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hook_util
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/hooks_/pytest_add_option_hook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pytest_add_option_hook
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/hooks_/pytest_after_scenario_hook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pytest_after_scenario_hook
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/hooks_/pytest_after_step_hook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pytest_after_step_hook
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/hooks_/pytest_bdd_before_step/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pytest_bdd_before_step
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/hooks_/pytest_bdd_step_error/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pytest_bdd_step_error
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/hooks_/pytest_before_scenario_hook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pytest_before_scenario_hook
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/hooks_/pytest_collection_finish_hook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pytest_collection_finish_hook
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/hooks_/pytest_configure_hook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pytest_configure_hook
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/hooks_/pytest_run_test_logreport/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pytest_run_test_logreport
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/hooks_/pytest_run_test_setup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pytest_run_test_setup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/hooks_/pytest_session_finish_/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pytest_session_finish_
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/hooks_/pytest_session_start_hook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pytest_session_start_hook
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/implicit_ftp_tls/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    implicit_ftp_tls
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/item_access/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    item_access
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/kibana_reporting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kibana_reporting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/local_reporting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    local_reporting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/log/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    log
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/ms_teams_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ms_teams_utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/old_hook_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    old_hook_utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/parsing_logs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    parsing_logs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/pyglobals/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pyglobals
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/ssh_handler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ssh_handler
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_core/utils/windows_remote_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    windows_remote_utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../../../../../reference/cafex_db/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    cafex_db
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_9_4" id="__nav_9_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_4">
            <span class="md-nav__icon md-icon"></span>
            cafex_db
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_db/assertions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    assertions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_db/database_handler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    database_handler
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_db/databricks_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    databricks_utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_db/db_security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    db_security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_db/snowflake_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    snowflake_utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../../../../../reference/cafex_ui/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    cafex_ui
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_9_5" id="__nav_9_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_5">
            <span class="md-nav__icon md-icon"></span>
            cafex_ui
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_ui/assertions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    assertions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_ui/image_comparision_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    image_comparision_utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_5_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../../../../../reference/cafex_ui/mobile_client/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    mobile_client
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_9_5_3" id="__nav_9_5_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_9_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_5_3">
            <span class="md-nav__icon md-icon"></span>
            mobile_client
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_ui/mobile_client/mobile_client_actions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mobile_client_actions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_ui/mobile_client/mobile_driver_factory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mobile_driver_factory
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_ui/mobile_client/mobile_driver_initializer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mobile_driver_initializer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_ui/mobile_client/mobile_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mobile_utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_ui/self_healing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    self_healing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_5_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../../../../../reference/cafex_ui/thick_client/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    thick_client
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_9_5_5" id="__nav_9_5_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_9_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_5_5">
            <span class="md-nav__icon md-icon"></span>
            thick_client
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_ui/thick_client/thick_client_actions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    thick_client_actions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_ui/thick_client/thick_client_application_handler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    thick_client_application_handler
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_ui/ui_security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ui_security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_5_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../../../../../reference/cafex_ui/web_client/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    web_client
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_9_5_7" id="__nav_9_5_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_9_5_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_5_7">
            <span class="md-nav__icon md-icon"></span>
            web_client
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_ui/web_client/base_driver_factory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    base_driver_factory
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_5_7_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../../../../../reference/cafex_ui/web_client/drivers/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    drivers
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_9_5_7_2" id="__nav_9_5_7_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_9_5_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_5_7_2">
            <span class="md-nav__icon md-icon"></span>
            drivers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_ui/web_client/drivers/chrome_driver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chrome_driver
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_ui/web_client/drivers/edge_driver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    edge_driver
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_ui/web_client/drivers/firefox_driver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    firefox_driver
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_ui/web_client/drivers/headless_chrome_driver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    headless_chrome_driver
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_ui/web_client/drivers/internet_explorer_driver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    internet_explorer_driver
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_ui/web_client/drivers/safari_driver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    safari_driver
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_ui/web_client/keyboard_mouse_actions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    keyboard_mouse_actions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_ui/web_client/selenium_helper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    selenium_helper
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_ui/web_client/ui_web_driver_initializer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ui_web_driver_initializer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_ui/web_client/web_client_actions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    web_client_actions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_ui/web_client/web_client_enum/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    web_client_enum
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../../../../reference/cafex_ui/web_client/web_driver_factory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    web_driver_factory
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cafex_db.database_handler" class="md-nav__link">
    <span class="md-ellipsis">
      database_handler
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler" class="md-nav__link">
    <span class="md-ellipsis">
      DatabaseHandler
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DatabaseHandler">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.__difference_formatter" class="md-nav__link">
    <span class="md-ellipsis">
      __difference_formatter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.cassandra" class="md-nav__link">
    <span class="md-ellipsis">
      cassandra
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.cassandra_resultset_to_list" class="md-nav__link">
    <span class="md-ellipsis">
      cassandra_resultset_to_list
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.check_data_in_column" class="md-nav__link">
    <span class="md-ellipsis">
      check_data_in_column
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.check_db_exists" class="md-nav__link">
    <span class="md-ellipsis">
      check_db_exists
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.check_headers_in_resultlist" class="md-nav__link">
    <span class="md-ellipsis">
      check_headers_in_resultlist
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.check_table_exists" class="md-nav__link">
    <span class="md-ellipsis">
      check_table_exists
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.check_value_exists_in_column" class="md-nav__link">
    <span class="md-ellipsis">
      check_value_exists_in_column
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.check_value_not_exists_in_column" class="md-nav__link">
    <span class="md-ellipsis">
      check_value_not_exists_in_column
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.close" class="md-nav__link">
    <span class="md-ellipsis">
      close
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.compare_dataframes_distinct" class="md-nav__link">
    <span class="md-ellipsis">
      compare_dataframes_distinct
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.compare_resultlists" class="md-nav__link">
    <span class="md-ellipsis">
      compare_resultlists
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.create_db_connection" class="md-nav__link">
    <span class="md-ellipsis">
      create_db_connection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.data_frame_diff" class="md-nav__link">
    <span class="md-ellipsis">
      data_frame_diff
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.dataframe_to_csv" class="md-nav__link">
    <span class="md-ellipsis">
      dataframe_to_csv
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.execute_query_from_file" class="md-nav__link">
    <span class="md-ellipsis">
      execute_query_from_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.execute_statement" class="md-nav__link">
    <span class="md-ellipsis">
      execute_statement
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.get_column_data" class="md-nav__link">
    <span class="md-ellipsis">
      get_column_data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.get_headers" class="md-nav__link">
    <span class="md-ellipsis">
      get_headers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.get_rowcount" class="md-nav__link">
    <span class="md-ellipsis">
      get_rowcount
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.hive_execute_statement" class="md-nav__link">
    <span class="md-ellipsis">
      hive_execute_statement
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.hiveconnection" class="md-nav__link">
    <span class="md-ellipsis">
      hiveconnection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.is_rowcount_zero" class="md-nav__link">
    <span class="md-ellipsis">
      is_rowcount_zero
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.list_to_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      list_to_dataframe
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.modify_sql_query" class="md-nav__link">
    <span class="md-ellipsis">
      modify_sql_query
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.mssql" class="md-nav__link">
    <span class="md-ellipsis">
      mssql
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.mysql" class="md-nav__link">
    <span class="md-ellipsis">
      mysql
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.oracle" class="md-nav__link">
    <span class="md-ellipsis">
      oracle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.postgres" class="md-nav__link">
    <span class="md-ellipsis">
      postgres
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.resultlist_to_csv" class="md-nav__link">
    <span class="md-ellipsis">
      resultlist_to_csv
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.spark_execute_statement" class="md-nav__link">
    <span class="md-ellipsis">
      spark_execute_statement
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cafex_db.database_handler.DatabaseHandler.verify_column_metadata" class="md-nav__link">
    <span class="md-ellipsis">
      verify_column_metadata
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>database_handler</h1>

<div class="doc doc-object doc-module">



<a id="cafex_db.database_handler"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="cafex_db.database_handler.DatabaseHandler" class="doc doc-heading">
            <code>DatabaseHandler</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="cafex_core.utils.core_database_handler.CoreDatabaseHandler" href="../../cafex_core/utils/core_database_handler/#cafex_core.utils.core_database_handler.CoreDatabaseHandler">CoreDatabaseHandler</a></code></p>


        <p>This class provides methods for various database operations.</p>


<details class="note" open>
  <summary>Note</summary>
  <p>The class provides methods for:
1. Database connection (with username/pwd and with SSL) for MSSQL, MYSQL, Oracle, HIVE, Postgres, Cassandra
2. Executing a query statement
3. Fetching resultset/recordset
4. Compare 2 resultsets
    i.   1-1 comparison
    ii.  Comparison based on Headers
    iii. Compare only few columns
    iv.  Compare by ignoring column data type
5. Reading data from files(csv, excel) and convert into list
6. Export data frame/resultset to csv</p>
</details>
              <details class="quote">
                <summary>Source code in <code>cafex_db\database_handler.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  15</span>
<span class="normal">  16</span>
<span class="normal">  17</span>
<span class="normal">  18</span>
<span class="normal">  19</span>
<span class="normal">  20</span>
<span class="normal">  21</span>
<span class="normal">  22</span>
<span class="normal">  23</span>
<span class="normal">  24</span>
<span class="normal">  25</span>
<span class="normal">  26</span>
<span class="normal">  27</span>
<span class="normal">  28</span>
<span class="normal">  29</span>
<span class="normal">  30</span>
<span class="normal">  31</span>
<span class="normal">  32</span>
<span class="normal">  33</span>
<span class="normal">  34</span>
<span class="normal">  35</span>
<span class="normal">  36</span>
<span class="normal">  37</span>
<span class="normal">  38</span>
<span class="normal">  39</span>
<span class="normal">  40</span>
<span class="normal">  41</span>
<span class="normal">  42</span>
<span class="normal">  43</span>
<span class="normal">  44</span>
<span class="normal">  45</span>
<span class="normal">  46</span>
<span class="normal">  47</span>
<span class="normal">  48</span>
<span class="normal">  49</span>
<span class="normal">  50</span>
<span class="normal">  51</span>
<span class="normal">  52</span>
<span class="normal">  53</span>
<span class="normal">  54</span>
<span class="normal">  55</span>
<span class="normal">  56</span>
<span class="normal">  57</span>
<span class="normal">  58</span>
<span class="normal">  59</span>
<span class="normal">  60</span>
<span class="normal">  61</span>
<span class="normal">  62</span>
<span class="normal">  63</span>
<span class="normal">  64</span>
<span class="normal">  65</span>
<span class="normal">  66</span>
<span class="normal">  67</span>
<span class="normal">  68</span>
<span class="normal">  69</span>
<span class="normal">  70</span>
<span class="normal">  71</span>
<span class="normal">  72</span>
<span class="normal">  73</span>
<span class="normal">  74</span>
<span class="normal">  75</span>
<span class="normal">  76</span>
<span class="normal">  77</span>
<span class="normal">  78</span>
<span class="normal">  79</span>
<span class="normal">  80</span>
<span class="normal">  81</span>
<span class="normal">  82</span>
<span class="normal">  83</span>
<span class="normal">  84</span>
<span class="normal">  85</span>
<span class="normal">  86</span>
<span class="normal">  87</span>
<span class="normal">  88</span>
<span class="normal">  89</span>
<span class="normal">  90</span>
<span class="normal">  91</span>
<span class="normal">  92</span>
<span class="normal">  93</span>
<span class="normal">  94</span>
<span class="normal">  95</span>
<span class="normal">  96</span>
<span class="normal">  97</span>
<span class="normal">  98</span>
<span class="normal">  99</span>
<span class="normal"> 100</span>
<span class="normal"> 101</span>
<span class="normal"> 102</span>
<span class="normal"> 103</span>
<span class="normal"> 104</span>
<span class="normal"> 105</span>
<span class="normal"> 106</span>
<span class="normal"> 107</span>
<span class="normal"> 108</span>
<span class="normal"> 109</span>
<span class="normal"> 110</span>
<span class="normal"> 111</span>
<span class="normal"> 112</span>
<span class="normal"> 113</span>
<span class="normal"> 114</span>
<span class="normal"> 115</span>
<span class="normal"> 116</span>
<span class="normal"> 117</span>
<span class="normal"> 118</span>
<span class="normal"> 119</span>
<span class="normal"> 120</span>
<span class="normal"> 121</span>
<span class="normal"> 122</span>
<span class="normal"> 123</span>
<span class="normal"> 124</span>
<span class="normal"> 125</span>
<span class="normal"> 126</span>
<span class="normal"> 127</span>
<span class="normal"> 128</span>
<span class="normal"> 129</span>
<span class="normal"> 130</span>
<span class="normal"> 131</span>
<span class="normal"> 132</span>
<span class="normal"> 133</span>
<span class="normal"> 134</span>
<span class="normal"> 135</span>
<span class="normal"> 136</span>
<span class="normal"> 137</span>
<span class="normal"> 138</span>
<span class="normal"> 139</span>
<span class="normal"> 140</span>
<span class="normal"> 141</span>
<span class="normal"> 142</span>
<span class="normal"> 143</span>
<span class="normal"> 144</span>
<span class="normal"> 145</span>
<span class="normal"> 146</span>
<span class="normal"> 147</span>
<span class="normal"> 148</span>
<span class="normal"> 149</span>
<span class="normal"> 150</span>
<span class="normal"> 151</span>
<span class="normal"> 152</span>
<span class="normal"> 153</span>
<span class="normal"> 154</span>
<span class="normal"> 155</span>
<span class="normal"> 156</span>
<span class="normal"> 157</span>
<span class="normal"> 158</span>
<span class="normal"> 159</span>
<span class="normal"> 160</span>
<span class="normal"> 161</span>
<span class="normal"> 162</span>
<span class="normal"> 163</span>
<span class="normal"> 164</span>
<span class="normal"> 165</span>
<span class="normal"> 166</span>
<span class="normal"> 167</span>
<span class="normal"> 168</span>
<span class="normal"> 169</span>
<span class="normal"> 170</span>
<span class="normal"> 171</span>
<span class="normal"> 172</span>
<span class="normal"> 173</span>
<span class="normal"> 174</span>
<span class="normal"> 175</span>
<span class="normal"> 176</span>
<span class="normal"> 177</span>
<span class="normal"> 178</span>
<span class="normal"> 179</span>
<span class="normal"> 180</span>
<span class="normal"> 181</span>
<span class="normal"> 182</span>
<span class="normal"> 183</span>
<span class="normal"> 184</span>
<span class="normal"> 185</span>
<span class="normal"> 186</span>
<span class="normal"> 187</span>
<span class="normal"> 188</span>
<span class="normal"> 189</span>
<span class="normal"> 190</span>
<span class="normal"> 191</span>
<span class="normal"> 192</span>
<span class="normal"> 193</span>
<span class="normal"> 194</span>
<span class="normal"> 195</span>
<span class="normal"> 196</span>
<span class="normal"> 197</span>
<span class="normal"> 198</span>
<span class="normal"> 199</span>
<span class="normal"> 200</span>
<span class="normal"> 201</span>
<span class="normal"> 202</span>
<span class="normal"> 203</span>
<span class="normal"> 204</span>
<span class="normal"> 205</span>
<span class="normal"> 206</span>
<span class="normal"> 207</span>
<span class="normal"> 208</span>
<span class="normal"> 209</span>
<span class="normal"> 210</span>
<span class="normal"> 211</span>
<span class="normal"> 212</span>
<span class="normal"> 213</span>
<span class="normal"> 214</span>
<span class="normal"> 215</span>
<span class="normal"> 216</span>
<span class="normal"> 217</span>
<span class="normal"> 218</span>
<span class="normal"> 219</span>
<span class="normal"> 220</span>
<span class="normal"> 221</span>
<span class="normal"> 222</span>
<span class="normal"> 223</span>
<span class="normal"> 224</span>
<span class="normal"> 225</span>
<span class="normal"> 226</span>
<span class="normal"> 227</span>
<span class="normal"> 228</span>
<span class="normal"> 229</span>
<span class="normal"> 230</span>
<span class="normal"> 231</span>
<span class="normal"> 232</span>
<span class="normal"> 233</span>
<span class="normal"> 234</span>
<span class="normal"> 235</span>
<span class="normal"> 236</span>
<span class="normal"> 237</span>
<span class="normal"> 238</span>
<span class="normal"> 239</span>
<span class="normal"> 240</span>
<span class="normal"> 241</span>
<span class="normal"> 242</span>
<span class="normal"> 243</span>
<span class="normal"> 244</span>
<span class="normal"> 245</span>
<span class="normal"> 246</span>
<span class="normal"> 247</span>
<span class="normal"> 248</span>
<span class="normal"> 249</span>
<span class="normal"> 250</span>
<span class="normal"> 251</span>
<span class="normal"> 252</span>
<span class="normal"> 253</span>
<span class="normal"> 254</span>
<span class="normal"> 255</span>
<span class="normal"> 256</span>
<span class="normal"> 257</span>
<span class="normal"> 258</span>
<span class="normal"> 259</span>
<span class="normal"> 260</span>
<span class="normal"> 261</span>
<span class="normal"> 262</span>
<span class="normal"> 263</span>
<span class="normal"> 264</span>
<span class="normal"> 265</span>
<span class="normal"> 266</span>
<span class="normal"> 267</span>
<span class="normal"> 268</span>
<span class="normal"> 269</span>
<span class="normal"> 270</span>
<span class="normal"> 271</span>
<span class="normal"> 272</span>
<span class="normal"> 273</span>
<span class="normal"> 274</span>
<span class="normal"> 275</span>
<span class="normal"> 276</span>
<span class="normal"> 277</span>
<span class="normal"> 278</span>
<span class="normal"> 279</span>
<span class="normal"> 280</span>
<span class="normal"> 281</span>
<span class="normal"> 282</span>
<span class="normal"> 283</span>
<span class="normal"> 284</span>
<span class="normal"> 285</span>
<span class="normal"> 286</span>
<span class="normal"> 287</span>
<span class="normal"> 288</span>
<span class="normal"> 289</span>
<span class="normal"> 290</span>
<span class="normal"> 291</span>
<span class="normal"> 292</span>
<span class="normal"> 293</span>
<span class="normal"> 294</span>
<span class="normal"> 295</span>
<span class="normal"> 296</span>
<span class="normal"> 297</span>
<span class="normal"> 298</span>
<span class="normal"> 299</span>
<span class="normal"> 300</span>
<span class="normal"> 301</span>
<span class="normal"> 302</span>
<span class="normal"> 303</span>
<span class="normal"> 304</span>
<span class="normal"> 305</span>
<span class="normal"> 306</span>
<span class="normal"> 307</span>
<span class="normal"> 308</span>
<span class="normal"> 309</span>
<span class="normal"> 310</span>
<span class="normal"> 311</span>
<span class="normal"> 312</span>
<span class="normal"> 313</span>
<span class="normal"> 314</span>
<span class="normal"> 315</span>
<span class="normal"> 316</span>
<span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span>
<span class="normal">1870</span>
<span class="normal">1871</span>
<span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span>
<span class="normal">1879</span>
<span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span>
<span class="normal">1902</span>
<span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span>
<span class="normal">1906</span>
<span class="normal">1907</span>
<span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span>
<span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span>
<span class="normal">1919</span>
<span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span>
<span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span>
<span class="normal">1935</span>
<span class="normal">1936</span>
<span class="normal">1937</span>
<span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span>
<span class="normal">1950</span>
<span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span>
<span class="normal">1958</span>
<span class="normal">1959</span>
<span class="normal">1960</span>
<span class="normal">1961</span>
<span class="normal">1962</span>
<span class="normal">1963</span>
<span class="normal">1964</span>
<span class="normal">1965</span>
<span class="normal">1966</span>
<span class="normal">1967</span>
<span class="normal">1968</span>
<span class="normal">1969</span>
<span class="normal">1970</span>
<span class="normal">1971</span>
<span class="normal">1972</span>
<span class="normal">1973</span>
<span class="normal">1974</span>
<span class="normal">1975</span>
<span class="normal">1976</span>
<span class="normal">1977</span>
<span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span>
<span class="normal">1986</span>
<span class="normal">1987</span>
<span class="normal">1988</span>
<span class="normal">1989</span>
<span class="normal">1990</span>
<span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span>
<span class="normal">1997</span>
<span class="normal">1998</span>
<span class="normal">1999</span>
<span class="normal">2000</span>
<span class="normal">2001</span>
<span class="normal">2002</span>
<span class="normal">2003</span>
<span class="normal">2004</span>
<span class="normal">2005</span>
<span class="normal">2006</span>
<span class="normal">2007</span>
<span class="normal">2008</span>
<span class="normal">2009</span>
<span class="normal">2010</span>
<span class="normal">2011</span>
<span class="normal">2012</span>
<span class="normal">2013</span>
<span class="normal">2014</span>
<span class="normal">2015</span>
<span class="normal">2016</span>
<span class="normal">2017</span>
<span class="normal">2018</span>
<span class="normal">2019</span>
<span class="normal">2020</span>
<span class="normal">2021</span>
<span class="normal">2022</span>
<span class="normal">2023</span>
<span class="normal">2024</span>
<span class="normal">2025</span>
<span class="normal">2026</span>
<span class="normal">2027</span>
<span class="normal">2028</span>
<span class="normal">2029</span>
<span class="normal">2030</span>
<span class="normal">2031</span>
<span class="normal">2032</span>
<span class="normal">2033</span>
<span class="normal">2034</span>
<span class="normal">2035</span>
<span class="normal">2036</span>
<span class="normal">2037</span>
<span class="normal">2038</span>
<span class="normal">2039</span>
<span class="normal">2040</span>
<span class="normal">2041</span>
<span class="normal">2042</span>
<span class="normal">2043</span>
<span class="normal">2044</span>
<span class="normal">2045</span>
<span class="normal">2046</span>
<span class="normal">2047</span>
<span class="normal">2048</span>
<span class="normal">2049</span>
<span class="normal">2050</span>
<span class="normal">2051</span>
<span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span>
<span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span>
<span class="normal">2062</span>
<span class="normal">2063</span>
<span class="normal">2064</span>
<span class="normal">2065</span>
<span class="normal">2066</span>
<span class="normal">2067</span>
<span class="normal">2068</span>
<span class="normal">2069</span>
<span class="normal">2070</span>
<span class="normal">2071</span>
<span class="normal">2072</span>
<span class="normal">2073</span>
<span class="normal">2074</span>
<span class="normal">2075</span>
<span class="normal">2076</span>
<span class="normal">2077</span>
<span class="normal">2078</span>
<span class="normal">2079</span>
<span class="normal">2080</span>
<span class="normal">2081</span>
<span class="normal">2082</span>
<span class="normal">2083</span>
<span class="normal">2084</span>
<span class="normal">2085</span>
<span class="normal">2086</span>
<span class="normal">2087</span>
<span class="normal">2088</span>
<span class="normal">2089</span>
<span class="normal">2090</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">DatabaseHandler</span><span class="p">(</span><span class="n">CoreDatabaseHandler</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class provides methods for various database operations.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        None</span>

<span class="sd">    Methods:</span>
<span class="sd">        Various methods for database operations are provided.</span>

<span class="sd">    Note:</span>
<span class="sd">        The class provides methods for:</span>
<span class="sd">        1. Database connection (with username/pwd and with SSL) for MSSQL, MYSQL, Oracle, HIVE, Postgres, Cassandra</span>
<span class="sd">        2. Executing a query statement</span>
<span class="sd">        3. Fetching resultset/recordset</span>
<span class="sd">        4. Compare 2 resultsets</span>
<span class="sd">            i.   1-1 comparison</span>
<span class="sd">            ii.  Comparison based on Headers</span>
<span class="sd">            iii. Compare only few columns</span>
<span class="sd">            iv.  Compare by ignoring column data type</span>
<span class="sd">        5. Reading data from files(csv, excel) and convert into list</span>
<span class="sd">        6. Export data frame/resultset to csv</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">          Initializes the class and creates a DBSecurity instance.</span>
<span class="sd">          &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_decrytor</span> <span class="o">=</span> <span class="n">DBSecurity</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">create_db_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pstr_database_type</span><span class="p">,</span> <span class="n">pstr_server_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Description:</span>
<span class="sd">            |This method creates a DB connection</span>

<span class="sd">        :param pstr_database_type: This parameter can accept only mssql/mysql/oracle/hive/postgres/cassandra/spark/ec2_hive</span>
<span class="sd">        :type pstr_database_type: String</span>
<span class="sd">        :param pstr_server_name: server name</span>
<span class="sd">        :type pstr_server_name: String</span>
<span class="sd">        :param pstr_database_name: database name</span>
<span class="sd">        :type pstr_database_name: kwargs</span>
<span class="sd">        :param pstr_username: username</span>
<span class="sd">        :type pstr_username: kwargs</span>
<span class="sd">        :param pstr_password: password</span>
<span class="sd">        :type pstr_password: kwargs</span>
<span class="sd">        :param pint_port_number: port</span>
<span class="sd">        :type pint_port_number: kwargs</span>
<span class="sd">        :param pbool_ispasswordencoded: True/False</span>
<span class="sd">        :type pbool_ispasswordencoded: kwargs</span>
<span class="sd">        :param ppem_file: SSH key file path</span>
<span class="sd">        :type ppem_file: kwargs</span>
<span class="sd">        :param psecret_key: secret key</span>
<span class="sd">        :type psecret_key: kwargs</span>
<span class="sd">        :param pstr_sid: SID</span>
<span class="sd">        :type pstr_sid: kwargs</span>
<span class="sd">        :param pstr_service_name: Service Name</span>
<span class="sd">        :type pstr_service_name: kwargs</span>
<span class="sd">        :param pstr_encoding: encoding format</span>
<span class="sd">        :type pstr_encoding: kwargs</span>
<span class="sd">        :param pint_control_timeout: Query control parameter for cassandra and mssql connections</span>
<span class="sd">        :type pint_control_timeout: kwargs</span>


<span class="sd">        :return: Database Connection Object</span>

<span class="sd">        Examples:</span>
<span class="sd">            |  1. create_db_connection(&#39;mssql&#39;, &#39;database server name&#39;, pstr_database_name=&#39;database name&#39;)</span>
<span class="sd">            |  2. create_db_connection(&#39;mssql&#39;, &#39;database server name&#39;, pstr_database_name=&#39;database name&#39;, pstr_username=&#39;username&#39;, pstr_password=&#39;Welcome@123&#39;, bool_ispasswordencode=True)</span>
<span class="sd">            |  3. create_db_connection(&#39;mssql&#39;, &#39;database server name&#39;, pstr_database_name=&#39;database name&#39;, pstr_username=&#39;username&#39;, pstr_password=&#39;Welcome%40123&#39;, bool_ispasswordencode=False, pint_control_timeout=int_in_second)</span>
<span class="sd">            |  4. create_db_connection(&#39;oracle&#39;, &#39;host&#39;, pstr_database_name=&#39;database name&#39;, pstr_username=&#39;username&#39;, pstr_password=&#39;password&#39;, pint_port_number=port, pstr_service_name=&#39;service_name&#39;)</span>
<span class="sd">            |  5. create_db_connection(&#39;oracle&#39;, &#39;host&#39;, pstr_database_name=&#39;database name&#39;, pstr_username=&#39;username&#39;, pstr_password=&#39;password&#39;, pint_port_number=port, pstr_sid=&#39;sid&#39;)</span>
<span class="sd">            |  6. create_db_connection(&#39;hive&#39;, &#39;database server name&#39;, pstr_database_name=&#39;database name&#39;, pstr_username=&#39;username&#39;, pstr_password=&#39;password&#39;)</span>
<span class="sd">            |  7. create_db_connection(&#39;hive&#39;, &#39;database server name&#39;, pstr_username=&#39;username&#39;, ppem_file=&#39;SSH Key file path&#39;)</span>
<span class="sd">            |  8. create_db_connection(&#39;postgres&#39;, &#39;database server name&#39;, pint_port_number=port, pstr_database_name=&#39;database server name&#39;, pstr_username=&#39;username&#39;, pstr_password=&#39;password&#39;)</span>
<span class="sd">            |  9. create_db_connection(&#39;cassandra&#39;, &#39;database server name&#39;, pstr_database_name=&#39;database name&#39;, pstr_username=&#39;username&#39;, pstr_password=&#39;password&#39;)</span>

<span class="sd">        .. notes::</span>
<span class="sd">            |  Encoding format option is available only for oracle connection for now.</span>
<span class="sd">            |  mssql method expects password in url encoded format, here urllib.parse.quote_plus() is encoding the passwords with special characters &amp; non-ASCII text.</span>
<span class="sd">            |  pbool_ispasswordencoded is set to False by default for mssql db connection method:mssql.</span>
<span class="sd">            |  If user chooses to pass password as, for ex:Welcome%40123 instead of Welcome@123(original one, un-encoded format), pbool_ispasswordencoded should be set to False.</span>
<span class="sd">            |  If pbool_ispasswordencoded is True, then given uncoded password will be encoded to be parsed correctly to the connection string.</span>
<span class="sd">            |  If user chooses to pass password as it is ie., in un-encoded format for ex:Welcome@123 then, pbool_ispasswordencoded should be set to True.</span>

<span class="sd">        .. warning::</span>
<span class="sd">            |  Old reference - Oracle instant client is a must be available on the host for oracle connection. Refer to the documentation at https://cx-oracle.readthedocs.io/en/latest/installation.html#installing-cx-oracle-on-windows to understand the setup process.</span>
<span class="sd">        	|  Latest reference - Oracle instant client is a must be available on the host for oracle connection. Refer to the documentation at https://cx-oracle.readthedocs.io/en/latest/user_guide/installation.html#installing-cx-oracle-on-windows to understand the setup process.</span>
<span class="sd">            |  pint_control_timeout - This parameter is only for cassandra which states the timeout for scheme quering for nodes.This can be inform of float as well</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">pstr_database_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pstr_database_name&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">pstr_username</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pstr_username&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">pstr_password</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pstr_password&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">pint_port_number</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pint_port_number&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">pbool_ispasswordencoded</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pbool_ispasswordencoded&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">ppem_file</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ppem_file&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">psecret_key</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;psecret_key&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">pstr_sid</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pstr_sid&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">pstr_service_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pstr_service_name&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">pstr_encoding</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pstr_encoding&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">int_control_timeout</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pint_control_timeout&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">int_query_timeout</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pint_control_timeout&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">db_connection</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">if</span> <span class="n">pstr_database_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_database_type</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">pstr_server_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_server_name</span><span class="p">()</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">pstr_database_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;mssql&quot;</span><span class="p">,</span> <span class="s2">&quot;mysql&quot;</span><span class="p">,</span> <span class="s2">&quot;oracle&quot;</span><span class="p">,</span> <span class="s2">&quot;postgres&quot;</span><span class="p">,</span> <span class="s2">&quot;cassandra&quot;</span><span class="p">]):</span>
                <span class="k">if</span> <span class="n">pstr_username</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">pstr_password</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_password</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">pbool_ispasswordencoded</span> <span class="ow">and</span> <span class="n">psecret_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">pstr_database_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;mssql&#39;</span><span class="p">,</span> <span class="s1">&#39;mysql&#39;</span><span class="p">,</span> <span class="s1">&#39;oracle&#39;</span><span class="p">,</span> <span class="s1">&#39;postgres&#39;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_secret_key</span><span class="p">()</span>

            <span class="c1"># Actual database connections start from here</span>
            <span class="c1"># Check for MS SQL</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">pstr_database_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;mssql&quot;</span><span class="p">]):</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">pstr_database_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_database_name</span><span class="p">()</span>

                <span class="n">db_connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mssql</span><span class="p">(</span><span class="n">pstr_server_name</span><span class="p">,</span> <span class="n">pstr_database_name</span><span class="p">,</span> <span class="n">pint_port_number</span><span class="o">=</span><span class="n">pint_port_number</span><span class="p">,</span>
                                           <span class="n">pstr_username</span><span class="o">=</span><span class="n">pstr_username</span><span class="p">,</span> <span class="n">pstr_password</span><span class="o">=</span><span class="n">pstr_password</span><span class="p">,</span>
                                           <span class="n">bool_ispasswordencode</span><span class="o">=</span><span class="n">pbool_ispasswordencoded</span><span class="p">,</span>
                                           <span class="n">pint_control_timeout</span><span class="o">=</span><span class="n">int_query_timeout</span><span class="p">)</span>

            <span class="c1"># Check for MySQL</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">pstr_database_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;mysql&quot;</span><span class="p">]):</span>
                <span class="n">db_connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mysql</span><span class="p">(</span><span class="n">pstr_server_name</span><span class="p">,</span> <span class="n">pstr_database_name</span><span class="p">,</span> <span class="n">pint_port_number</span><span class="o">=</span><span class="n">pint_port_number</span><span class="p">,</span>
                                           <span class="n">pstr_username</span><span class="o">=</span><span class="n">pstr_username</span><span class="p">,</span> <span class="n">pstr_password</span><span class="o">=</span><span class="n">pstr_password</span><span class="p">,</span>
                                           <span class="n">bool_ispasswordencode</span><span class="o">=</span><span class="n">pbool_ispasswordencoded</span><span class="p">)</span>

            <span class="c1"># Check for Oracle</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">pstr_database_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;oracle&quot;</span><span class="p">]):</span>

                <span class="k">if</span> <span class="n">pstr_sid</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">pstr_service_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_service_name</span><span class="p">()</span>

                <span class="n">db_connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">oracle</span><span class="p">(</span><span class="n">pstr_server_name</span><span class="p">,</span> <span class="n">pstr_username</span><span class="o">=</span><span class="n">pstr_username</span><span class="p">,</span> <span class="n">pstr_password</span><span class="o">=</span><span class="n">pstr_password</span><span class="p">,</span>
                                            <span class="n">pint_port_number</span><span class="o">=</span><span class="n">pint_port_number</span><span class="p">,</span> <span class="n">pstr_sid</span><span class="o">=</span><span class="n">pstr_sid</span><span class="p">,</span>
                                            <span class="n">pstr_service_name</span><span class="o">=</span><span class="n">pstr_service_name</span><span class="p">,</span> <span class="n">pstr_encoding</span><span class="o">=</span><span class="n">pstr_encoding</span><span class="p">,</span>
                                            <span class="n">bool_ispasswordencode</span><span class="o">=</span><span class="n">pbool_ispasswordencoded</span><span class="p">)</span>

            <span class="c1"># check for Hive</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">pstr_database_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;hive&quot;</span><span class="p">,</span> <span class="s2">&quot;spark&quot;</span><span class="p">,</span> <span class="s2">&quot;ec2_hive&quot;</span><span class="p">]):</span>
                <span class="k">if</span> <span class="n">pstr_password</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ppem_file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span>
                        <span class="s2">&quot;For hive/Spark/ec2_hive, Password and ppem file cannot be null&quot;</span><span class="p">)</span>

                <span class="n">db_connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hiveconnection</span><span class="p">(</span><span class="n">pstr_server_name</span><span class="p">,</span> <span class="n">pstr_username</span><span class="o">=</span><span class="n">pstr_username</span><span class="p">,</span>
                                                    <span class="n">pstr_password</span><span class="o">=</span><span class="n">pstr_password</span><span class="p">,</span> <span class="n">ppem_file</span><span class="o">=</span><span class="n">ppem_file</span><span class="p">,</span>
                                                    <span class="n">bool_ispasswordencode</span><span class="o">=</span><span class="n">pbool_ispasswordencoded</span><span class="p">,</span>
                                                    <span class="n">psecret_key</span><span class="o">=</span><span class="n">psecret_key</span><span class="p">,</span> <span class="n">pint_port_number</span><span class="o">=</span><span class="n">pint_port_number</span><span class="p">)</span>

            <span class="c1"># Check for postgres</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">pstr_database_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;postgres&quot;</span><span class="p">]):</span>
                <span class="n">db_connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postgres</span><span class="p">(</span><span class="n">pstr_server_name</span><span class="p">,</span> <span class="n">pstr_database_name</span><span class="p">,</span> <span class="n">pstr_username</span><span class="o">=</span><span class="n">pstr_username</span><span class="p">,</span>
                                              <span class="n">pstr_password</span><span class="o">=</span><span class="n">pstr_password</span><span class="p">,</span> <span class="n">pint_port_number</span><span class="o">=</span><span class="n">pint_port_number</span><span class="p">,</span>
                                              <span class="n">bool_ispasswordencode</span><span class="o">=</span><span class="n">pbool_ispasswordencoded</span><span class="p">)</span>

            <span class="c1"># Check for cassandra</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">pstr_database_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;cassandra&quot;</span><span class="p">]):</span>
                <span class="n">db_connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cassandra</span><span class="p">(</span><span class="n">pstr_server_name</span><span class="p">,</span> <span class="n">pstr_database_name</span><span class="p">,</span> <span class="n">pstr_username</span><span class="o">=</span><span class="n">pstr_username</span><span class="p">,</span>
                                               <span class="n">pstr_password</span><span class="o">=</span><span class="n">pstr_password</span><span class="p">,</span> <span class="n">pint_port_number</span><span class="o">=</span><span class="n">pint_port_number</span><span class="p">,</span>
                                               <span class="n">pint_control_timeout</span><span class="o">=</span><span class="n">int_control_timeout</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_invalid_database_type</span><span class="p">()</span>

            <span class="k">return</span> <span class="n">db_connection</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">mssql</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pstr_server_name</span><span class="p">,</span> <span class="n">pstr_database_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Description:</span>
<span class="sd">            |  This method deals with creating a connection to mssql database.</span>

<span class="sd">        :return: Database Connection Object</span>

<span class="sd">        .. notes::</span>
<span class="sd">        	|  For input parameters, refer to the method description of create_db_connection</span>
<span class="sd">        	|  Autocommit is set to True</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">mssql_connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_decrytor</span><span class="o">.</span><span class="n">mssql</span><span class="p">(</span><span class="n">pstr_server_name</span><span class="p">,</span> <span class="n">pstr_database_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">mssql_connection</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">mysql</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pstr_server_name</span><span class="p">,</span> <span class="n">pstr_database_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Description:</span>
<span class="sd">            |  This method deals with creating a connection to mysql database</span>

<span class="sd">        :return: Database Connection Object</span>

<span class="sd">        .. notes::</span>
<span class="sd">        	|  For input parameters, refer to the method description of create_db_connection</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">mysql_connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_decrytor</span><span class="o">.</span><span class="n">mysql</span><span class="p">(</span><span class="n">pstr_server_name</span><span class="p">,</span> <span class="n">pstr_database_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">mysql_connection</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">postgres</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pstr_server_name</span><span class="p">,</span> <span class="n">pstr_database_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Description:</span>
<span class="sd">            |  This method deals with creating a connection to postgres database</span>

<span class="sd">        :param pint_port_number: port</span>
<span class="sd">        :type pint_port_number: kwargs</span>
<span class="sd">        :return: Database Connection Object</span>

<span class="sd">        .. notes::</span>
<span class="sd">        	|  For input parameters, refer to the method description of create_db_connection</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">postgres_connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_decrytor</span><span class="o">.</span><span class="n">postgres</span><span class="p">(</span><span class="n">pstr_server_name</span><span class="p">,</span> <span class="n">pstr_database_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">postgres_connection</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">hiveconnection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pstr_server_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Description:</span>
<span class="sd">            |  This method deals with creating a connection to HIVE database using the SSH protocol</span>

<span class="sd">        :return: Database Connection Object</span>

<span class="sd">        .. notes::</span>
<span class="sd">        	|  For input parameters, refer to the method description of create_db_connection</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">HiveClient</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_decrytor</span><span class="o">.</span><span class="n">hive_connection</span><span class="p">(</span><span class="n">pstr_server_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">HiveClient</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">cassandra</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pstr_server_name</span><span class="p">,</span> <span class="n">pstr_database_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Description:</span>
<span class="sd">            |  This method deals with creating a connection to cassandra database</span>

<span class="sd">        :return: Database Connection Object</span>

<span class="sd">        .. notes::</span>
<span class="sd">        	|  For input parameters, refer to the method description of create_db_connection</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">cassandra_connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_decrytor</span><span class="o">.</span><span class="n">cassandra</span><span class="p">(</span><span class="n">pstr_server_name</span><span class="p">,</span> <span class="n">pstr_database_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">cassandra_connection</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">oracle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pstr_server_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Description:</span>
<span class="sd">            |  This method deals with creating a connection to Oracle database</span>

<span class="sd">        :return: Database Connection Object</span>

<span class="sd">        .. notes::</span>
<span class="sd">        	|  For input parameters, refer to the method description of create_db_connection</span>


<span class="sd">        .. warning::</span>
<span class="sd">        	|  Oracle instant client is a must be available on the host where this method is called. Refer to the documentation at https://cx-oracle.readthedocs.io/en/latest/installation.html#installing-cx-oracle-on-windows to understand the setup process.</span>
<span class="sd">            |  More information different oracle encoding can be seen at https://www.oracle.com/database/technologies/faq-nls-lang.html.</span>

<span class="sd">        Examples:</span>
<span class="sd">	        |  mi_data_ingestion.mi_establish_connection(server,pstr_encoding=&quot;utf8&quot;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">oracle_connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_decrytor</span><span class="o">.</span><span class="n">oracle</span><span class="p">(</span><span class="n">pstr_server_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">oracle_connection</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="c1">## This section deals with database operations</span>

    <span class="k">def</span> <span class="nf">execute_statement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pobject_connection</span><span class="p">,</span> <span class="n">psql_query</span><span class="p">,</span> <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;list&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Description:</span>
<span class="sd">            |  This method allows user to execute a database query statement.</span>

<span class="sd">        :param pobject_connection:</span>
<span class="sd">        :type pobject_connection: Database Connection Object</span>
<span class="sd">        :param psql_query:</span>
<span class="sd">        :type psql_query: String</span>
<span class="sd">        :param pstr_return_type: list/resultset</span>
<span class="sd">        :type pstr_return_type: String</span>


<span class="sd">        :return: List or ResultSet or Boolean</span>

<span class="sd">        .. notes::</span>
<span class="sd">        	|  This method returns a list or a resultset based on the parameter pstr_return_type. &#39;select&#39; statements will returns List/Resultset and other type of statements will return Boolean.</span>

<span class="sd">        .. warning::</span>
<span class="sd">	        |  This method can not be used to execute HIVE statements.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">pobject_connection</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_database_object</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">psql_query</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_query</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">pstr_return_type</span> <span class="ow">is</span> <span class="s1">&#39;list&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">psql_query</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;select&#39;</span><span class="p">):</span>
                    <span class="n">resultset</span> <span class="o">=</span> <span class="n">pobject_connection</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">psql_query</span><span class="p">)</span>
                    <span class="k">if</span> <span class="s1">&#39;cassandra&#39;</span> <span class="ow">in</span> <span class="nb">repr</span><span class="p">(</span><span class="n">pobject_connection</span><span class="p">):</span>
                        <span class="n">datalist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cassandra_resultset_to_list</span><span class="p">(</span><span class="n">resultset</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">datalist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resultset_to_list</span><span class="p">(</span><span class="n">resultset</span><span class="p">,</span> <span class="n">pbool_include_headers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="n">datalist</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span>
                        <span class="s2">&quot;For pstr_return_type == &#39;list&#39;, only select statements are allowed&quot;</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">pstr_return_type</span> <span class="ow">is</span> <span class="s1">&#39;resultset&#39;</span><span class="p">:</span>

                <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">psql_query</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;select&#39;</span><span class="p">):</span>
                    <span class="n">resultset</span> <span class="o">=</span> <span class="n">pobject_connection</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">psql_query</span><span class="p">)</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="n">resultset</span>
                <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">psql_query</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;insert&#39;</span><span class="p">):</span>
                    <span class="n">resultset</span> <span class="o">=</span> <span class="n">pobject_connection</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">psql_query</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">resultset</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Successully inserted&quot;</span><span class="p">)</span>
                        <span class="n">result</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">psql_query</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;update&#39;</span><span class="p">):</span>
                    <span class="n">resultset</span> <span class="o">=</span> <span class="n">pobject_connection</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">psql_query</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">resultset</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Successully Updated&quot;</span><span class="p">)</span>
                        <span class="n">result</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">psql_query</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;delete&#39;</span><span class="p">):</span>
                    <span class="n">pobject_connection</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">psql_query</span><span class="p">)</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">resultset</span> <span class="o">=</span> <span class="n">pobject_connection</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">psql_query</span><span class="p">)</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="n">resultset</span>

            <span class="k">return</span> <span class="n">result</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">hive_execute_statement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pobject_hiveclient</span><span class="p">,</span> <span class="n">p_query</span><span class="p">,</span> <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Description:</span>
<span class="sd">            |  This method allows user to execute a HIVE database query statement.</span>

<span class="sd">        :param pobject_hiveclient:</span>
<span class="sd">        :type pobject_hiveclient: Hive Database Connection Object</span>
<span class="sd">        :param p_query:</span>
<span class="sd">        :type p_query: String</span>
<span class="sd">        :param pstr_return_type: list/resultset</span>
<span class="sd">        :type pstr_return_type: String</span>
<span class="sd">        :param pbool_include_header: default value is False, if set to true will print the headers also</span>
<span class="sd">        :type pbool_include_header: kwargs:bool</span>
<span class="sd">        :param pstr_server_connect: If the user needs to connect to a server then he can send the command to this pararmeter</span>
<span class="sd">        :type pstr_server_connect: kwargs:string</span>


<span class="sd">        :return: List or ResultSet or Boolean</span>

<span class="sd">        .. notes::</span>
<span class="sd">            |  This method returns a list or a resultset based on the parameter pstr_return_type. &#39;select&#39; statements will returns List/Resultset and other type of statements will return Boolean.</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">bool_include_header</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pbool_include_header&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">str_server_connect</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pstr_server_connect&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">pobject_hiveclient</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_hive_object</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">p_query</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_query</span><span class="p">()</span>

            <span class="n">pobject_hiveclient</span><span class="o">.</span><span class="n">invoke_shell</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">str_server_connect</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">pobject_hiveclient</span><span class="o">.</span><span class="n">exec_command</span><span class="p">(</span><span class="n">str_server_connect</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">bool_include_header</span><span class="p">:</span>
                <span class="n">pobject_hiveclient</span><span class="o">.</span><span class="n">exec_command</span><span class="p">(</span><span class="s1">&#39;set hive.cli.print.header=true;&#39;</span><span class="p">)</span>

            <span class="n">stdin</span><span class="p">,</span> <span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span> <span class="o">=</span> <span class="n">pobject_hiveclient</span><span class="o">.</span><span class="n">exec_command</span><span class="p">(</span><span class="s1">&#39;hive -e </span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">p_query</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
            <span class="n">rs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe_to_resultset</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">pstr_return_type</span> <span class="o">==</span> <span class="s1">&#39;list&#39;</span><span class="p">:</span>
                <span class="n">rs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resultset_to_list</span><span class="p">(</span><span class="n">rs</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">rs</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">execute_query_from_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pobject_connection</span><span class="p">,</span> <span class="n">pstr_filepath</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Description:</span>
<span class="sd">            |  This method allows user to execute a query available in a file.</span>

<span class="sd">        :param pobject_connection:</span>
<span class="sd">        :type pobject_connection: Database Connection Object</span>
<span class="sd">        :param pstr_filepath:</span>
<span class="sd">        :type pstr_filepath: String</span>
<span class="sd">        :type pstr_return_type: String</span>


<span class="sd">        :return: ResultSet</span>

<span class="sd">        .. notes::</span>
<span class="sd">            |  This method returns a list or a resultset based on the parameter pstr_return_type. &#39;select&#39; statements will returns List/Resultset and other type of statements will return Boolean.</span>
<span class="sd">            |</span>
<span class="sd">            |  This method accepts only text/sql files.</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pstr_filepath</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_filepath</span><span class="p">()</span>

            <span class="n">str_filepath</span> <span class="o">=</span> <span class="n">pstr_filepath</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">pobject_connection</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_database_object</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">str_filepath</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;.sql&#39;</span><span class="p">,</span> <span class="s1">&#39;.txt&#39;</span><span class="p">)):</span>
                <span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">str_filepath</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                        <span class="n">query</span> <span class="o">=</span> <span class="n">query</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">line</span>
                <span class="n">resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobject_connection</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span>
                                                   <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>  <span class="c1"># pobject_connection.cursor().execute(query)</span>
                <span class="k">return</span> <span class="n">resultset</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Accepted file formats are .sql and .txt&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pobject_connection</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Description:</span>
<span class="sd">        	|  This method closes the database connection.</span>

<span class="sd">        :param pobject_connection:</span>
<span class="sd">        :type pobject_connection: Database Connection Object</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pobject_connection</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_database_object</span><span class="p">()</span>

            <span class="k">if</span> <span class="s1">&#39;cassandra&#39;</span> <span class="ow">in</span> <span class="nb">repr</span><span class="p">(</span><span class="n">pobject_connection</span><span class="p">):</span>
                <span class="n">pobject_connection</span><span class="o">.</span><span class="n">cluster</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
            <span class="k">elif</span> <span class="s1">&#39;paramiko&#39;</span> <span class="ow">in</span> <span class="nb">repr</span><span class="p">(</span><span class="n">pobject_connection</span><span class="p">):</span>
                <span class="n">pobject_connection</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">elif</span> <span class="nb">any</span><span class="p">(</span><span class="n">s</span> <span class="ow">in</span> <span class="nb">repr</span><span class="p">(</span><span class="n">pobject_connection</span><span class="o">.</span><span class="n">dialect</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;mssql&#39;</span><span class="p">,</span> <span class="s1">&#39;postgres&#39;</span><span class="p">,</span> <span class="s1">&#39;oracle&#39;</span><span class="p">)):</span>
                <span class="n">pobject_connection</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;The connection &quot;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">pobject_connection</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;is closed&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">check_table_exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pobject_connection</span><span class="p">,</span> <span class="n">pstr_database_name</span><span class="p">,</span> <span class="n">pstr_table_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Description:</span>
<span class="sd">            |  This method check if a table exists in a database.</span>

<span class="sd">        :param pobject_connection:</span>
<span class="sd">        :type pobject_connection: Database Connection Object</span>
<span class="sd">        :param pstr_database_name:</span>
<span class="sd">        :type pstr_database_name: String</span>
<span class="sd">        :param pstr_table_name:</span>
<span class="sd">        :type pstr_table_name: String</span>


<span class="sd">        :return: Boolean</span>

<span class="sd">        .. warning::</span>
<span class="sd">            |  The method does not support HIVE right now.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pobject_connection</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_database_object</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">pstr_database_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_database_name</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">pstr_table_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_table_name</span><span class="p">()</span>

            <span class="n">str_schema</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pstr_schema&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">bln_is_table_exists</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="k">if</span> <span class="s1">&#39;cassandra&#39;</span> <span class="ow">in</span> <span class="nb">repr</span><span class="p">(</span><span class="n">pobject_connection</span><span class="p">):</span>
                <span class="n">temp_engine</span> <span class="o">=</span> <span class="n">pobject_connection</span><span class="o">.</span><span class="n">cluster</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">pstr_database_name</span><span class="p">)</span>
                <span class="n">rs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">temp_engine</span><span class="p">,</span>
                                            <span class="s2">&quot;SELECT table_name FROM system_schema.tables WHERE keyspace_name=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_database_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; and table_name=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span> <span class="o">+</span> <span class="s2">&quot;&#39;;&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">bln_is_table_exists</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">bln_is_table_exists</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="k">elif</span> <span class="nb">any</span><span class="p">(</span><span class="n">s</span> <span class="ow">in</span> <span class="nb">repr</span><span class="p">(</span><span class="n">pobject_connection</span><span class="o">.</span><span class="n">dialect</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;mssql&#39;</span><span class="p">,</span> <span class="s1">&#39;postgres&#39;</span><span class="p">)):</span>
                <span class="n">pobject_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">url</span><span class="o">.</span><span class="n">database</span> <span class="o">=</span> <span class="n">pstr_database_name</span>
                <span class="n">temp_engine</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="n">pobject_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">str_schema</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">bln_is_table_exists</span> <span class="o">=</span> <span class="n">temp_engine</span><span class="o">.</span><span class="n">dialect</span><span class="o">.</span><span class="n">has_table</span><span class="p">(</span><span class="n">temp_engine</span><span class="p">,</span> <span class="n">pstr_table_name</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">bln_is_table_exists</span> <span class="o">=</span> <span class="n">temp_engine</span><span class="o">.</span><span class="n">dialect</span><span class="o">.</span><span class="n">has_table</span><span class="p">(</span><span class="n">temp_engine</span><span class="p">,</span> <span class="n">pstr_table_name</span><span class="p">,</span>
                                                                        <span class="n">schema</span><span class="o">=</span><span class="n">str_schema</span><span class="p">)</span>

            <span class="k">elif</span> <span class="nb">any</span><span class="p">(</span><span class="n">s</span> <span class="ow">in</span> <span class="nb">repr</span><span class="p">(</span><span class="n">pobject_connection</span><span class="o">.</span><span class="n">dialect</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;oracle&#39;</span><span class="p">)):</span>
                <span class="n">bln_is_table_exists</span> <span class="o">=</span> <span class="n">pobject_connection</span><span class="o">.</span><span class="n">dialect</span><span class="o">.</span><span class="n">has_table</span><span class="p">(</span><span class="n">pobject_connection</span><span class="p">,</span> <span class="n">pstr_table_name</span><span class="p">,</span>
                                                                           <span class="n">schema</span><span class="o">=</span><span class="n">pstr_database_name</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">bln_is_table_exists</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="c1">## This section deals with dataframe/resultset/list</span>

    <span class="k">def</span> <span class="nf">cassandra_resultset_to_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prs_cassandra_resultset</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Description:</span>
<span class="sd">            |  This method returns the headers and all the row values in a cassandra-driver resultset.</span>

<span class="sd">        :param prs_cassandra_resultset: This is a cassandra-driver resultset</span>
<span class="sd">        :type prs_cassandra_resultset: Cassandra Resultset Object</span>


<span class="sd">        :return: List</span>

<span class="sd">        .. notes::</span>
<span class="sd">            |  First index of the list will contain the column headers and the rest will have row values.</span>


<span class="sd">        .. warning::</span>
<span class="sd">            |  Only pass cassandra-driver resultset object to this method.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">prs_cassandra_resultset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_resultset</span><span class="p">()</span>

            <span class="n">list_rs_column_names</span> <span class="o">=</span> <span class="n">prs_cassandra_resultset</span><span class="o">.</span><span class="n">column_names</span>
            <span class="n">list_rs_values</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">list_rs_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">list_rs_column_names</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">prs_cassandra_resultset</span><span class="p">:</span>
                <span class="n">list_rs_values</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">val</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">row</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">list_rs_values</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">is_rowcount_zero</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plist_resultlist</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Description:</span>
<span class="sd">            |  This method checks if the row count is zero or not.</span>

<span class="sd">        :param plist_resultlist: This is a List that contains column headers and row values</span>
<span class="sd">        :type plist_resultlist: List</span>


<span class="sd">        :return: Boolean</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">plist_resultlist</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_resultlist</span><span class="p">()</span>

            <span class="n">bln_is_rowcount_zero</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">int_rowcount</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rowcount</span><span class="p">(</span><span class="n">plist_resultlist</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">int_rowcount</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">bln_is_rowcount_zero</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">bln_is_rowcount_zero</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="k">return</span> <span class="n">bln_is_rowcount_zero</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">get_rowcount</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plist_resultlist</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Description:</span>
<span class="sd">            |  This method returns the count of rows in a result list.</span>

<span class="sd">        :param plist_resultlist: This is a List that contains column headers and row values</span>
<span class="sd">        :type plist_resultlist: List</span>


<span class="sd">        :return: Integer</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">plist_resultlist</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_resultlist</span><span class="p">()</span>
            <span class="n">int_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">plist_resultlist</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">int_length</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">get_headers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plist_resultlist</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Description:</span>
<span class="sd">            |  This method returns list of headers in a result list.</span>

<span class="sd">        :param plist_resultlist:</span>
<span class="sd">        :type plist_resultlist: List</span>


<span class="sd">        :return: List</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">plist_resultlist</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_resultlist</span><span class="p">()</span>
            <span class="n">lst_headers</span> <span class="o">=</span> <span class="n">plist_resultlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">lst_headers</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">decode_password</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pkey</span><span class="p">,</span> <span class="n">psecret_key</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">psecret_key</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">),</span> <span class="n">AES</span><span class="o">.</span><span class="n">MODE_ECB</span><span class="p">)</span>
            <span class="n">decoded</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">pkey</span><span class="p">))</span>
            <span class="n">password</span> <span class="o">=</span> <span class="p">(</span><span class="n">decoded</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">password</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">check_value_exists_in_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plist_resultlist</span><span class="p">,</span> <span class="n">pstr_column_header</span><span class="p">,</span> <span class="n">pstr_value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Description:</span>
<span class="sd">            |  This method returns True if a value exists under a column header, otherwise returns False.</span>

<span class="sd">        :param plist_resultlist:</span>
<span class="sd">        :type plist_resultlist: Result List</span>
<span class="sd">        :param pstr_column_header:</span>
<span class="sd">        :type pstr_header: String</span>
<span class="sd">        :param pstr_value:</span>
<span class="sd">        :type pstr_value: String</span>


<span class="sd">        :return: Boolean</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">plist_resultlist</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_resultlist</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">pstr_column_header</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_column_header</span><span class="p">()</span>

            <span class="n">list_coldata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_column_data</span><span class="p">(</span><span class="n">plist_resultlist</span><span class="p">,</span> <span class="n">pstr_column_header</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">pstr_value</span> <span class="ow">in</span> <span class="n">list_coldata</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">check_value_not_exists_in_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plist_resultlist</span><span class="p">,</span> <span class="n">pstr_column_header</span><span class="p">,</span> <span class="n">pstr_value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Description:</span>
<span class="sd">            |  This method returns True if a value does not exists under a column header, otherwise returns False.</span>

<span class="sd">        :param plist_resultlist:</span>
<span class="sd">        :type plist_resultlist: Result List</span>
<span class="sd">        :param pstr_column_header:</span>
<span class="sd">        :type pstr_header: String</span>
<span class="sd">        :param pstr_value:</span>
<span class="sd">        :type pstr_value: String</span>


<span class="sd">        :return: Boolean</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">plist_resultlist</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_resultlist</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">pstr_column_header</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_column_header</span><span class="p">()</span>

            <span class="n">list_coldata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_column_data</span><span class="p">(</span><span class="n">plist_resultlist</span><span class="p">,</span> <span class="n">pstr_column_header</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">pstr_value</span> <span class="ow">in</span> <span class="n">list_coldata</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">get_column_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plist_resultlist</span><span class="p">,</span> <span class="n">pstr_column_header</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Description:</span>
<span class="sd">            |  This method returns all the values in a column header.</span>

<span class="sd">        :param plist_resultlist:</span>
<span class="sd">        :type plist_resultlist: Result List</span>
<span class="sd">        :param pstr_column_header:</span>
<span class="sd">        :type pstr_column_header: String</span>


<span class="sd">        :return: List</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">plist_resultlist</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_resultlist</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">pstr_column_header</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_column_header</span><span class="p">()</span>

            <span class="n">list_resultset_data</span> <span class="o">=</span> <span class="n">plist_resultlist</span>
            <span class="n">int_resultset_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_resultset_data</span><span class="p">)</span>
            <span class="n">pdf_resultset_dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">list_resultset_data</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">int_resultset_length</span><span class="p">],</span>
                                                   <span class="n">columns</span><span class="o">=</span><span class="n">list_resultset_data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">list_coldata</span> <span class="o">=</span> <span class="n">pdf_resultset_dataframe</span><span class="p">[</span><span class="n">pstr_column_header</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="k">return</span> <span class="n">list_coldata</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">compare_resultlists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plist_resultlist_source</span><span class="p">,</span> <span class="n">plist_resultlist_target</span><span class="p">,</span> <span class="n">pstr_compare_mode</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span>
                            <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Description:</span>
<span class="sd">            |  This method lets user compare two result lists and returns the difference in the form of a Dataframe.</span>

<span class="sd">        :param plist_resultlist_source:</span>
<span class="sd">        :type plist_resultlist_source: Result List</span>
<span class="sd">        :param plist_resultlist_target:</span>
<span class="sd">        :type plist_resultlist_target: Result List</span>
<span class="sd">        :param pstr_compare_mode: index/header</span>
<span class="sd">        :type pstr_compare_mode: String</span>
<span class="sd">        :param plist_headers: List of Headers to compare</span>
<span class="sd">        :type plist_headers: kwargs</span>
<span class="sd">        :param plist_headers_source: List of Source Headers to compare</span>
<span class="sd">        :type plist_headers_source: kwargs</span>
<span class="sd">        :param plist_headers_target: List of Source Headers to compare</span>
<span class="sd">        :type plist_headers_target: kwargs</span>
<span class="sd">        :param pint_rowcount: Number of rows to compare</span>
<span class="sd">        :type pint_rowcount: kwargs</span>
<span class="sd">        :param pbool_ignore_datatype:</span>
<span class="sd">        :type pbool_ignore_datatype: kwargs</span>
<span class="sd">        :param pbool_line_to_line: default value is False</span>
<span class="sd">        :type pbool_line_to_line: kwargs</span>
<span class="sd">        :param pbool_get_common: default value is False</span>
<span class="sd">        :type pbool_get_common: kwargs</span>
<span class="sd">        :param pbool_ignore_header_case: default value is False</span>
<span class="sd">        :type pbool_ignore_header_case: kwargs</span>
<span class="sd">        :param pbool_club: default value is False</span>
<span class="sd">        :type pbool_ignore_header_case: kwargs</span>
<span class="sd">        :param pdict_primary_keys: Dictionary in the format of {&#39;source&#39;:[],&#39;target&#39;:[]}</span>
<span class="sd">        :type pbool_ignore_header_case: kwargs</span>


<span class="sd">        :return: When pbool_line_to_line=False, returns two Dataframes, one contains (source - target) and the other contains (target - source)</span>
<span class="sd">                 When pbool_line_to_line=False and pbool_get_common=True, returns three Dataframes, first one is common data, second one contains (source - target) and the other contains (target - source)</span>
<span class="sd">                 When pbool_line_to_line=True, returns one Dataframe containing (source - target)</span>

<span class="sd">        Examples:</span>
<span class="sd">            |  1. Let us imagine we have 2 result sets rs_source=3 headers and rs_target=3 headers then usage would be</span>
<span class="sd">            |  compare_resultsets(rs_source, rs_target) or compare_resultsets(rs_source, rs_target, pstr_compare_mode=&#39;index&#39;)</span>
<span class="sd">            |  This will only work when both result sets have same no. of headers, otherwise an exception will be thrown.</span>
<span class="sd">            |  2. Let us imagine we have 2 result sets with headers as following rs_source=[&#39;id&#39;, &#39;name&#39;, &#39;age&#39;] and (rs_target=[&#39;id&#39;, &#39;name&#39;, &#39;age&#39;] or rs_target=[&#39;age&#39;, &#39;name&#39;, &#39;id&#39;])</span>
<span class="sd">            |  compare_resultsets(rs_source, rs_target, pstr_compare_mode=&#39;header&#39;)</span>
<span class="sd">            |  This will only work when both result sets have same no. of headers, otherwise an exception will be thrown.</span>
<span class="sd">            |  3. Let us imagine we have 2 result sets with headers as following rs_source=[&#39;id&#39;, &#39;name&#39;, &#39;age&#39;, &#39;location&#39;, &#39;country&#39;] and rs_target=[&#39;id&#39;, &#39;name&#39;, &#39;age&#39;]</span>
<span class="sd">            |  compare_resultsets(rs_source, rs_target, pstr_compare_mode=&#39;header&#39;, plist_headers=[&#39;id&#39;, &#39;name&#39;, &#39;age&#39;])</span>
<span class="sd">            |  4. Let us imagine we have 2 result sets with headers as following rs_source=[&#39;id_source&#39;, &#39;name_source&#39;, &#39;age_source&#39;, &#39;location_source&#39;, &#39;country_source&#39;] and rs_target=[&#39;id_target&#39;, &#39;name_target&#39;, &#39;age_target&#39;]</span>
<span class="sd">            |  compare_resultsets(rs_source, rs_target, pstr_compare_mode=&#39;header&#39;, plist_headers_source=[&#39;id_source&#39;, &#39;name_source&#39;, &#39;age_source&#39;], plist_headers_target=[&#39;id_target&#39;, &#39;name_target&#39;, &#39;age_target&#39;])</span>
<span class="sd">            |  In this case, id_source will be compared with id_target and so on.</span>
<span class="sd">            |  Make sure that plist_headers_source and plist_headers_target are used together, otherwise an exception will be thrown.</span>
<span class="sd">            |  Sizes of both the lists plist_headers_source and plist_headers_target must be same.</span>
<span class="sd">            |  5. Let us imagine the requirement is to compare only top few records from both result sets then use the **kwargs parameter pint_rowcount</span>
<span class="sd">            |  compare_resultsets(rs_source, rs_target, pint_rowcount=10)</span>
<span class="sd">            |  6. If user wants to perform row-to-row comparison of same sized(same no. of rows) data, then</span>
<span class="sd">            |  compare_resultlists(resultset1, resultset2, pint_row_count=10, pbool_line_to_line=True, pstr_compare_mode=&#39;header&#39;)</span>
<span class="sd">            |  7. If the user wants to fetch common data in both resultlists along with (source-target and target_source), then</span>
<span class="sd">            |  compare_resultlists(resultset1, resultset2, pstr_compare_mode=&#39;header&#39;, pbool_get_common=True)</span>
<span class="sd">            |  8. If the user wants to get only a single difference for source_target and target_source then the statment would be like</span>
<span class="sd">            |  difference_dataframe = obj.compare_resultlists(resultset1, resultset2,pbool_ignore_datatype=True,pstr_compare_mode=&quot;header&quot;,plist_headers_source=[&#39;TCExecuted&#39;,&#39;TEexecutiontime&#39;],plist_headers_target=[&#39;TCExecutedold&#39;,&#39;TEexecutiontime&#39;],pbool_club=True,pdict_primary_keys=data)</span>



<span class="sd">        .. notes::</span>
<span class="sd">            |  If there is no difference, then None will be returned.</span>
<span class="sd">            |  The source and target row count should be same</span>
<span class="sd">            |  The pbool_club is only applicable if the user performs the comparison with pstr_comparison_mode =&#39;header&#39; and pbool_line_to_line = False</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">plist_headers</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plist_headers&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">plist_headers_source</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plist_headers_source&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">plist_headers_target</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plist_headers_target&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">pint_row_count</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pint_row_count&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">bool_ignore_datatype</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pbool_ignore_datatype&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="n">line_to_line</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pbool_line_to_line&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">pbool_get_common</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pbool_get_common&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">pbool_ignore_header_case</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pbool_ignore_header_case&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">bool_club</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pbool_club&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">dict_primary_keys</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pdict_primary_keys&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">df_difference_dataframe</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">if</span> <span class="n">plist_resultlist_source</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">plist_resultlist_target</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Method compare_resultlists : One or both of the result data is None&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">pint_row_count</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">pint_row_count</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Method compare_resultlists : Given row count should be greater than 0 &#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">line_to_line</span> <span class="o">==</span> <span class="kc">True</span> <span class="ow">and</span> <span class="n">pint_row_count</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">plist_resultlist_source</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">plist_resultlist_target</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                        <span class="s1">&#39;Method compare_resultlists : line to line comparison is accepted only if the length of the source and target is same. If needed you can specify the kwarg that is rowcount&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">pstr_compare_mode</span> <span class="o">==</span> <span class="s1">&#39;index&#39;</span><span class="p">:</span>
                <span class="n">df_dataframe_source</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">plist_resultlist_source</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">plist_resultlist_source</span><span class="p">)])</span>
                <span class="n">df_dataframe_target</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">plist_resultlist_target</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">plist_resultlist_target</span><span class="p">)])</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">plist_resultlist_source</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">plist_resultlist_target</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                        <span class="s1">&#39;The source and target header count is different, please make sure that the count is same&#39;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">line_to_line</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">df_difference_dataframe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_frame_diff</span><span class="p">(</span><span class="n">df_dataframe_source</span><span class="p">,</span> <span class="n">df_dataframe_target</span><span class="p">,</span>
                                                                   <span class="n">pint_rowcount</span><span class="o">=</span><span class="n">pint_row_count</span><span class="p">,</span>
                                                                   <span class="n">pbool_ignore_datatype</span><span class="o">=</span><span class="n">bool_ignore_datatype</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">df_difference_dataframe</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">df_difference_dataframe</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                        <span class="n">df_difference_dataframe</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>

                    <span class="k">return</span> <span class="n">df_difference_dataframe</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">pbool_get_common</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="n">common</span><span class="p">,</span> <span class="n">df_source_differences</span><span class="p">,</span> <span class="n">df_target_differences</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_dataframes_distinct</span><span class="p">(</span>
                            <span class="n">df_dataframe_source</span><span class="p">,</span> <span class="n">df_dataframe_target</span><span class="p">,</span> <span class="n">pint_rowcount</span><span class="o">=</span><span class="n">pint_row_count</span><span class="p">,</span>
                            <span class="n">pbool_get_common</span><span class="o">=</span><span class="n">pbool_get_common</span><span class="p">,</span> <span class="n">pbool_ignore_datatype</span><span class="o">=</span><span class="n">bool_ignore_datatype</span><span class="p">)</span>
                        <span class="k">return</span> <span class="n">common</span><span class="p">,</span> <span class="n">df_source_differences</span><span class="p">,</span> <span class="n">df_target_differences</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">df_source_differences</span><span class="p">,</span> <span class="n">df_target_differences</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_dataframes_distinct</span><span class="p">(</span>
                            <span class="n">df_dataframe_source</span><span class="p">,</span> <span class="n">df_dataframe_target</span><span class="p">,</span> <span class="n">pint_rowcount</span><span class="o">=</span><span class="n">pint_row_count</span><span class="p">,</span>
                            <span class="n">pbool_get_common</span><span class="o">=</span><span class="n">pbool_get_common</span><span class="p">,</span> <span class="n">pbool_ignore_datatype</span><span class="o">=</span><span class="n">bool_ignore_datatype</span><span class="p">)</span>
                        <span class="k">return</span> <span class="n">df_source_differences</span><span class="p">,</span> <span class="n">df_target_differences</span>

            <span class="k">elif</span> <span class="n">pstr_compare_mode</span> <span class="o">==</span> <span class="s1">&#39;header&#39;</span><span class="p">:</span>
                <span class="n">list_source</span> <span class="o">=</span> <span class="n">plist_resultlist_source</span>
                <span class="n">list_target</span> <span class="o">=</span> <span class="n">plist_resultlist_target</span>

                <span class="k">if</span> <span class="n">pbool_ignore_header_case</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">source_headers_temp</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">list_source</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                    <span class="n">target_headers_temp</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">list_target</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                    <span class="k">if</span> <span class="n">plist_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">plist_headers</span> <span class="o">=</span> <span class="p">[</span><span class="n">valc</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">valc</span> <span class="ow">in</span> <span class="n">plist_headers</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">plist_headers_source</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">plist_headers_target</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">plist_headers_source</span> <span class="o">=</span> <span class="p">[</span><span class="n">vals</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">vals</span> <span class="ow">in</span> <span class="n">plist_headers_source</span><span class="p">]</span>
                        <span class="n">plist_headers_target</span> <span class="o">=</span> <span class="p">[</span><span class="n">valt</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">valt</span> <span class="ow">in</span> <span class="n">plist_headers_target</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">source_headers_temp</span> <span class="o">=</span> <span class="n">list_source</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">target_headers_temp</span> <span class="o">=</span> <span class="n">list_target</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                <span class="n">df_dataframe_source</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">list_source</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">list_source</span><span class="p">)],</span> <span class="n">columns</span><span class="o">=</span><span class="n">source_headers_temp</span><span class="p">)</span>
                <span class="n">df_dataframe_target</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">list_target</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">list_target</span><span class="p">)],</span> <span class="n">columns</span><span class="o">=</span><span class="n">target_headers_temp</span><span class="p">)</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">plist_headers_source</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">plist_headers_target</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
                        <span class="n">plist_headers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">plist_resultlist_source</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">plist_resultlist_target</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                            <span class="s1">&#39;The source and target header count is different, please make sure that the count is same&#39;</span><span class="p">)</span>
                    <span class="n">list_source</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
                    <span class="n">list_target</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
                    <span class="n">plist_headers_source</span> <span class="o">=</span> <span class="n">source_headers_temp</span>
                    <span class="n">plist_headers_target</span> <span class="o">=</span> <span class="n">target_headers_temp</span>
                    <span class="k">if</span> <span class="n">plist_headers_source</span> <span class="o">!=</span> <span class="n">plist_headers_target</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;The headers in the source and target results are different&#39;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">line_to_line</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">df_difference_dataframe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_frame_diff</span><span class="p">(</span><span class="n">df_dataframe_source</span><span class="p">,</span> <span class="n">df_dataframe_target</span><span class="p">,</span>
                                                                   <span class="n">plist_headers</span><span class="o">=</span><span class="n">plist_headers</span><span class="p">,</span>
                                                                   <span class="n">plist_headers_source</span><span class="o">=</span><span class="n">plist_headers_source</span><span class="p">,</span>
                                                                   <span class="n">plist_headers_target</span><span class="o">=</span><span class="n">plist_headers_target</span><span class="p">,</span>
                                                                   <span class="n">pint_rowcount</span><span class="o">=</span><span class="n">pint_row_count</span><span class="p">,</span>
                                                                   <span class="n">pbool_ignore_datatype</span><span class="o">=</span><span class="n">bool_ignore_datatype</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">df_difference_dataframe</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">df_difference_dataframe</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                        <span class="n">df_difference_dataframe</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>

                    <span class="k">return</span> <span class="n">df_difference_dataframe</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># added the distinct method call statement</span>
                    <span class="k">if</span> <span class="n">pbool_get_common</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">bool_club</span><span class="p">:</span>
                            <span class="n">df_common_dataframe</span><span class="p">,</span> <span class="n">df_dataframe_formatted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_dataframes_distinct</span><span class="p">(</span>
                                <span class="n">df_dataframe_source</span><span class="p">,</span> <span class="n">df_dataframe_target</span><span class="p">,</span>
                                <span class="n">plist_headers</span><span class="o">=</span><span class="n">plist_headers</span><span class="p">,</span>
                                <span class="n">plist_headers_source</span><span class="o">=</span><span class="n">plist_headers_source</span><span class="p">,</span>
                                <span class="n">plist_headers_target</span><span class="o">=</span><span class="n">plist_headers_target</span><span class="p">,</span>
                                <span class="n">pint_rowcount</span><span class="o">=</span><span class="n">pint_row_count</span><span class="p">,</span> <span class="n">pbool_get_common</span><span class="o">=</span><span class="n">pbool_get_common</span><span class="p">,</span>
                                <span class="n">pbool_ignore_datatype</span><span class="o">=</span><span class="n">bool_ignore_datatype</span><span class="p">,</span> <span class="n">pbool_club</span><span class="o">=</span><span class="n">bool_club</span><span class="p">,</span>
                                <span class="n">pdict_primary_keys</span><span class="o">=</span><span class="n">dict_primary_keys</span><span class="p">)</span>
                            <span class="k">return</span> <span class="n">df_common_dataframe</span><span class="p">,</span> <span class="n">df_dataframe_formatted</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">df_common_dataframe</span><span class="p">,</span> <span class="n">df_source_differences</span><span class="p">,</span> <span class="n">df_target_differences</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_dataframes_distinct</span><span class="p">(</span>
                                <span class="n">df_dataframe_source</span><span class="p">,</span> <span class="n">df_dataframe_target</span><span class="p">,</span>
                                <span class="n">plist_headers</span><span class="o">=</span><span class="n">plist_headers</span><span class="p">,</span>
                                <span class="n">plist_headers_source</span><span class="o">=</span><span class="n">plist_headers_source</span><span class="p">,</span>
                                <span class="n">plist_headers_target</span><span class="o">=</span><span class="n">plist_headers_target</span><span class="p">,</span>
                                <span class="n">pint_rowcount</span><span class="o">=</span><span class="n">pint_row_count</span><span class="p">,</span> <span class="n">pbool_get_common</span><span class="o">=</span><span class="n">pbool_get_common</span><span class="p">,</span>
                                <span class="n">pbool_ignore_datatype</span><span class="o">=</span><span class="n">bool_ignore_datatype</span><span class="p">,</span> <span class="n">pbool_club</span><span class="o">=</span><span class="n">bool_club</span><span class="p">,</span>
                                <span class="n">pdict_primary_keys</span><span class="o">=</span><span class="n">dict_primary_keys</span><span class="p">)</span>
                            <span class="k">return</span> <span class="n">df_common_dataframe</span><span class="p">,</span> <span class="n">df_source_differences</span><span class="p">,</span> <span class="n">df_target_differences</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">bool_club</span><span class="p">:</span>
                            <span class="n">df_differences</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_dataframes_distinct</span><span class="p">(</span><span class="n">df_dataframe_source</span><span class="p">,</span> <span class="n">df_dataframe_target</span><span class="p">,</span>
                                                                              <span class="n">plist_headers</span><span class="o">=</span><span class="n">plist_headers</span><span class="p">,</span>
                                                                              <span class="n">plist_headers_source</span><span class="o">=</span><span class="n">plist_headers_source</span><span class="p">,</span>
                                                                              <span class="n">plist_headers_target</span><span class="o">=</span><span class="n">plist_headers_target</span><span class="p">,</span>
                                                                              <span class="n">pint_rowcount</span><span class="o">=</span><span class="n">pint_row_count</span><span class="p">,</span>
                                                                              <span class="n">pbool_get_common</span><span class="o">=</span><span class="n">pbool_get_common</span><span class="p">,</span>
                                                                              <span class="n">pbool_ignore_datatype</span><span class="o">=</span><span class="n">bool_ignore_datatype</span><span class="p">,</span>
                                                                              <span class="n">pbool_club</span><span class="o">=</span><span class="n">bool_club</span><span class="p">,</span>
                                                                              <span class="n">pdict_primary_keys</span><span class="o">=</span><span class="n">dict_primary_keys</span><span class="p">)</span>
                            <span class="k">return</span> <span class="n">df_differences</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">df_source_differences</span><span class="p">,</span> <span class="n">df_target_differences</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_dataframes_distinct</span><span class="p">(</span>
                                <span class="n">df_dataframe_source</span><span class="p">,</span> <span class="n">df_dataframe_target</span><span class="p">,</span>
                                <span class="n">plist_headers</span><span class="o">=</span><span class="n">plist_headers</span><span class="p">,</span>
                                <span class="n">plist_headers_source</span><span class="o">=</span><span class="n">plist_headers_source</span><span class="p">,</span>
                                <span class="n">plist_headers_target</span><span class="o">=</span><span class="n">plist_headers_target</span><span class="p">,</span>
                                <span class="n">pint_rowcount</span><span class="o">=</span><span class="n">pint_row_count</span><span class="p">,</span> <span class="n">pbool_get_common</span><span class="o">=</span><span class="n">pbool_get_common</span><span class="p">,</span>
                                <span class="n">pbool_ignore_datatype</span><span class="o">=</span><span class="n">bool_ignore_datatype</span><span class="p">,</span> <span class="n">pbool_club</span><span class="o">=</span><span class="n">bool_club</span><span class="p">,</span>
                                <span class="n">pdict_primary_keys</span><span class="o">=</span><span class="n">dict_primary_keys</span><span class="p">)</span>
                            <span class="k">return</span> <span class="n">df_source_differences</span><span class="p">,</span> <span class="n">df_target_differences</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Given compare mode is invalid, please select index or header&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">data_frame_diff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdf_dataframe_source</span><span class="p">,</span> <span class="n">pdf_dataframe_destinition</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Description:</span>
<span class="sd">            |  This method lets user compare two Dataframes and returns the difference in the form of a Dataframe.</span>

<span class="sd">        :param pdf_dataframe_source:</span>
<span class="sd">        :type pdf_dataframe_source: pandas Dataframe</span>
<span class="sd">        :param pdf_dataframe_destinition:</span>
<span class="sd">        :type pdf_dataframe_destinition: pandas Dataframe</span>
<span class="sd">        :param plist_headers:</span>
<span class="sd">        :type plist_headers: kwargs</span>
<span class="sd">        :param plist_headers_source:</span>
<span class="sd">        :type plist_headers_source: kwargs</span>
<span class="sd">        :param plist_headers_target:</span>
<span class="sd">        :type plist_headers_target: kwargs</span>
<span class="sd">        :param pint_rowcount:</span>
<span class="sd">        :type pint_rowcount: kwargs</span>


<span class="sd">        :return: Dataframe</span>

<span class="sd">        .. notes::</span>
<span class="sd">            |  If there is no difference, then None will be returned.</span>

<span class="sd">        .. warning::</span>
<span class="sd">        	|  DO NOT try to call this method directly, this is a helper method for compare_resultlists()</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">list_headers</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plist_headers&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">list_headers_source</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plist_headers_source&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">list_headers_target</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plist_headers_target&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">int_rowcount</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pint_rowcount&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">bool_ignore_datatype</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pbool_ignore_datatype&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">df_stacked_dataframe</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">list_headers</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">list_headers_source</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">list_headers_target</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>

                <span class="k">if</span> <span class="n">bool_ignore_datatype</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">source_types</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pdf_dataframe_source</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
                    <span class="n">target_types</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pdf_dataframe_destinition</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
                    <span class="n">series_common_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__datatype_conversion</span><span class="p">(</span><span class="n">source_types</span><span class="p">,</span> <span class="n">target_types</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">series_common_type</span><span class="p">)):</span>
                        <span class="n">pdf_dataframe_source</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pdf_dataframe_source</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">series_common_type</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                        <span class="n">pdf_dataframe_destinition</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pdf_dataframe_destinition</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">series_common_type</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

                <span class="k">if</span> <span class="n">int_rowcount</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">int_rowcount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">bool_differences</span> <span class="o">=</span> <span class="p">(</span>
                            <span class="n">pdf_dataframe_source</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">int_rowcount</span><span class="p">)</span> <span class="o">!=</span> <span class="n">pdf_dataframe_destinition</span><span class="o">.</span><span class="n">head</span><span class="p">(</span>
                        <span class="n">int_rowcount</span><span class="p">))</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
                    <span class="n">df_stacked_dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
                        <span class="p">[</span><span class="n">pdf_dataframe_source</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">int_rowcount</span><span class="p">)</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="n">bool_differences</span><span class="p">],</span>
                         <span class="n">pdf_dataframe_destinition</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">int_rowcount</span><span class="p">)</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="n">bool_differences</span><span class="p">]],</span>
                        <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">df_stacked_dataframe</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Source_resultset&quot;</span><span class="p">,</span> <span class="s2">&quot;Target_resultset&quot;</span><span class="p">]</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">bool_differences</span> <span class="o">=</span> <span class="p">(</span><span class="n">pdf_dataframe_source</span> <span class="o">!=</span> <span class="n">pdf_dataframe_destinition</span><span class="p">)</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
                    <span class="n">df_stacked_dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pdf_dataframe_source</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="n">bool_differences</span><span class="p">],</span>
                                                      <span class="n">pdf_dataframe_destinition</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="n">bool_differences</span><span class="p">]],</span>
                                                     <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">df_stacked_dataframe</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Source_resultset&quot;</span><span class="p">,</span> <span class="s2">&quot;Target_resultset&quot;</span><span class="p">]</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">list_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">list_headers_source</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">list_headers_target</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>

                <span class="k">if</span> <span class="n">bool_ignore_datatype</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">source_types</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pdf_dataframe_source</span><span class="p">[</span><span class="n">list_headers</span><span class="p">]</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
                    <span class="n">target_types</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pdf_dataframe_destinition</span><span class="p">[</span><span class="n">list_headers</span><span class="p">]</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
                    <span class="n">series_common_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__datatype_conversion</span><span class="p">(</span><span class="n">source_types</span><span class="p">,</span> <span class="n">target_types</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">series_common_type</span><span class="p">)):</span>
                        <span class="n">pdf_dataframe_source</span><span class="p">[</span><span class="n">list_headers</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">pdf_dataframe_source</span><span class="p">[</span><span class="n">list_headers</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span>
                            <span class="n">series_common_type</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                        <span class="n">pdf_dataframe_destinition</span><span class="p">[</span><span class="n">list_headers</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">pdf_dataframe_destinition</span><span class="p">[</span><span class="n">list_headers</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span>
                            <span class="n">series_common_type</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

                <span class="k">if</span> <span class="n">int_rowcount</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">int_rowcount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">bool_differences</span> <span class="o">=</span> <span class="p">(</span><span class="n">pdf_dataframe_source</span><span class="p">[</span><span class="n">list_headers</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">int_rowcount</span><span class="p">)</span> <span class="o">!=</span>
                                        <span class="n">pdf_dataframe_destinition</span><span class="p">[</span>
                                            <span class="n">list_headers</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">int_rowcount</span><span class="p">))</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
                    <span class="n">df_stacked_dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
                        <span class="p">[</span><span class="n">pdf_dataframe_source</span><span class="p">[</span><span class="n">list_headers</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">int_rowcount</span><span class="p">)</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="n">bool_differences</span><span class="p">],</span>
                         <span class="n">pdf_dataframe_destinition</span><span class="p">[</span><span class="n">list_headers</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">int_rowcount</span><span class="p">)</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span>
                             <span class="n">bool_differences</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">df_stacked_dataframe</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Source_resultset&quot;</span><span class="p">,</span> <span class="s2">&quot;Target_resultset&quot;</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">bool_differences</span> <span class="o">=</span> <span class="p">(</span><span class="n">pdf_dataframe_source</span><span class="p">[</span><span class="n">list_headers</span><span class="p">]</span> <span class="o">!=</span> <span class="n">pdf_dataframe_destinition</span><span class="p">[</span>
                        <span class="n">list_headers</span><span class="p">])</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
                    <span class="n">df_stacked_dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
                        <span class="p">[</span><span class="n">pdf_dataframe_source</span><span class="p">[</span><span class="n">list_headers</span><span class="p">]</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="n">bool_differences</span><span class="p">],</span>
                         <span class="n">pdf_dataframe_destinition</span><span class="p">[</span><span class="n">list_headers</span><span class="p">]</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="n">bool_differences</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">df_stacked_dataframe</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Source_resultset&quot;</span><span class="p">,</span> <span class="s2">&quot;Target_resultset&quot;</span><span class="p">]</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">list_headers</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">list_headers_source</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">list_headers_target</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>

                <span class="k">if</span> <span class="n">bool_ignore_datatype</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">source_types</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pdf_dataframe_source</span><span class="p">[</span><span class="n">list_headers_source</span><span class="p">]</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
                    <span class="n">target_types</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pdf_dataframe_destinition</span><span class="p">[</span><span class="n">list_headers_target</span><span class="p">]</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
                    <span class="n">series_common_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__datatype_conversion</span><span class="p">(</span><span class="n">source_types</span><span class="p">,</span> <span class="n">target_types</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">series_common_type</span><span class="p">)):</span>
                        <span class="n">pdf_dataframe_source</span><span class="p">[</span><span class="n">list_headers_source</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">pdf_dataframe_source</span><span class="p">[</span>
                            <span class="n">list_headers_source</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">series_common_type</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                        <span class="n">pdf_dataframe_destinition</span><span class="p">[</span><span class="n">list_headers_target</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">pdf_dataframe_destinition</span><span class="p">[</span>
                            <span class="n">list_headers_target</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">series_common_type</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

                <span class="k">if</span> <span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">list_headers_source</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
                        <span class="nb">len</span><span class="p">(</span><span class="n">list_headers_source</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_headers_target</span><span class="p">))):</span>
                    <span class="k">if</span> <span class="n">int_rowcount</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">int_rowcount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">list_difference</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="n">list_diff_headers</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_headers_source</span><span class="p">)):</span>
                            <span class="n">temp_diff</span> <span class="o">=</span> <span class="n">pdf_dataframe_source</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">int_rowcount</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                                <span class="n">list_headers_source</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">!=</span> <span class="n">pdf_dataframe_destinition</span><span class="o">.</span><span class="n">head</span><span class="p">(</span>
                                <span class="n">int_rowcount</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                                <span class="n">list_headers_target</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                            <span class="n">list_difference</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                <span class="n">pdf_dataframe_source</span><span class="p">[</span><span class="n">list_headers_source</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">int_rowcount</span><span class="p">)[</span>
                                    <span class="n">temp_diff</span><span class="p">])</span>
                            <span class="n">list_difference</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                <span class="n">pdf_dataframe_destinition</span><span class="p">[</span><span class="n">list_headers_target</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">int_rowcount</span><span class="p">)[</span>
                                    <span class="n">temp_diff</span><span class="p">])</span>
                            <span class="n">list_diff_headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;source_resultset/&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">list_headers_source</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                            <span class="n">list_diff_headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;target_resultset/&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">list_headers_target</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                        <span class="c1"># df_stacked_dataframe = pd.DataFrame(list_difference,index= list_diff_headers).transpose()</span>

                        <span class="n">df_stacked_dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">list_difference</span><span class="p">,</span>
                                                            <span class="n">index</span><span class="o">=</span><span class="n">list_diff_headers</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span>
                            <span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">df_stacked_dataframe</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">df_stacked_dataframe</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>

                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">list_difference</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="n">list_diff_headers</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_headers_source</span><span class="p">)):</span>
                            <span class="n">temp_diff</span> <span class="o">=</span> <span class="n">pdf_dataframe_source</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                                <span class="n">list_headers_source</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">!=</span> <span class="n">pdf_dataframe_destinition</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                                <span class="n">list_headers_target</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                            <span class="n">source_series</span> <span class="o">=</span> <span class="n">pdf_dataframe_source</span><span class="p">[</span><span class="n">list_headers_source</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="n">temp_diff</span><span class="p">]</span>
                            <span class="n">target_series</span> <span class="o">=</span> <span class="n">pdf_dataframe_destinition</span><span class="p">[</span><span class="n">list_headers_target</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="n">temp_diff</span><span class="p">]</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="n">source_series</span><span class="o">.</span><span class="n">empty</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">target_series</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                                <span class="n">list_difference</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">source_series</span><span class="p">)</span>
                                <span class="n">list_difference</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">target_series</span><span class="p">)</span>
                                <span class="n">list_diff_headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;source_resultset_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">list_headers_source</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                                <span class="n">list_diff_headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;target_resultset_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">list_headers_target</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                        <span class="c1"># df_stacked_dataframe = pd.DataFrame(list_difference,index= list_diff_headers).transpose()</span>
                        <span class="n">df_stacked_dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">list_difference</span><span class="p">,</span>
                                                            <span class="n">index</span><span class="o">=</span><span class="n">list_diff_headers</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span>
                            <span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">df_stacked_dataframe</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">df_stacked_dataframe</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                            <span class="n">df_stacked_dataframe</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Looks like there is a conflict in the kwargs parameters&#39;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">df_stacked_dataframe</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">resultlist_to_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plist_resultlist</span><span class="p">,</span> <span class="n">pstr_filepath</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Description:</span>
<span class="sd">            |  This method writes Result List to a csv file.</span>

<span class="sd">        :param plist_resultlist:</span>
<span class="sd">        :type plist_resultlist: Result List</span>
<span class="sd">        :param pstr_filepath:</span>
<span class="sd">        :type pstr_filepath: String</span>


<span class="sd">        :return: CSV File</span>

<span class="sd">        .. notes::</span>
<span class="sd">            |  Make sure to pass pstr_filepath with filename and extension as csv.</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">plist_resultlist</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_resultlist</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">pstr_filepath</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_filepath</span><span class="p">()</span>

            <span class="n">list_resultset</span> <span class="o">=</span> <span class="n">plist_resultlist</span>
            <span class="n">df_resultset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">list_resultset</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">list_resultset</span><span class="p">)],</span> <span class="n">columns</span><span class="o">=</span><span class="n">list_resultset</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">df_resultset</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">pstr_filepath</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">dataframe_to_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdf_dataframe</span><span class="p">,</span> <span class="n">pstr_path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Description:</span>
<span class="sd">            |  This method writes Dataframe to a csv file.</span>

<span class="sd">        :param pdf_dataframe:</span>
<span class="sd">        :type pdf_dataframe: Dataframe</span>
<span class="sd">        :param pstr_filepath:</span>
<span class="sd">        :type pstr_filepath: String</span>


<span class="sd">        :return: CSV File</span>

<span class="sd">        .. notes::</span>
<span class="sd">            |  Make sure to pass pstr_filepath with filename and extension as csv.</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pdf_dataframe</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_dataframe</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">pstr_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_filepath</span><span class="p">()</span>
            <span class="n">pdf_dataframe</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">pstr_path</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">list_to_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plist_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Description:</span>
<span class="sd">            |  This method is for converting the list to dataframes</span>
<span class="sd">        :param plist_data:</span>
<span class="sd">        :type plist_data: list</span>
<span class="sd">        :return:  Dataframe</span>

<span class="sd">        .. warning::</span>
<span class="sd">        	|  The list which we should pass must be the output of the execute_statement with list as return data</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">plist_data</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">plist_data</span><span class="p">)],</span> <span class="n">columns</span><span class="o">=</span><span class="n">plist_data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">compare_dataframes_distinct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdf_dataframe_source</span><span class="p">,</span> <span class="n">pdf_dataframe_target</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        .. warning::</span>
<span class="sd">        	|  DO NOT try to call this method directly, this is a helper method for compare_resultlists()</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">list_headers</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plist_headers&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">list_headers_source</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plist_headers_source&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">list_headers_target</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plist_headers_target&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">int_rowcount</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pint_rowcount&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">pstr_compare_mode</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pstr_compare_mode&#39;</span><span class="p">,</span> <span class="s1">&#39;header&#39;</span><span class="p">)</span>
            <span class="n">pbool_get_common</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pbool_get_common&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">bool_ignore_datatype</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pbool_ignore_datatype&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">bool_club</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pbool_club&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">dict_primary_keys</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pdict_primary_keys&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">pstr_compare_mode</span> <span class="o">==</span> <span class="s1">&#39;header&#39;</span><span class="p">:</span>
                <span class="n">list_source_headers</span> <span class="o">=</span> <span class="n">pdf_dataframe_source</span><span class="o">.</span><span class="n">columns</span>

            <span class="k">if</span> <span class="n">int_rowcount</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">df_dataframe_source</span> <span class="o">=</span> <span class="n">pdf_dataframe_source</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">int_rowcount</span><span class="p">)</span>
                <span class="n">df_dataframe_target</span> <span class="o">=</span> <span class="n">pdf_dataframe_target</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">int_rowcount</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">df_dataframe_source</span> <span class="o">=</span> <span class="n">pdf_dataframe_source</span>
                <span class="n">df_dataframe_target</span> <span class="o">=</span> <span class="n">pdf_dataframe_target</span>

            <span class="n">df_filtered_source</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">df_filtered_target</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">df_dup2_source</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">df_dup2_target</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">list_headers</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">list_headers_source</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">list_headers_target</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>

                <span class="k">if</span> <span class="n">bool_ignore_datatype</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">source_types</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_dataframe_source</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
                    <span class="n">target_types</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_dataframe_target</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
                    <span class="n">series_common_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__datatype_conversion</span><span class="p">(</span><span class="n">source_types</span><span class="p">,</span> <span class="n">target_types</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">series_common_type</span><span class="p">)):</span>
                        <span class="n">df_dataframe_source</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_dataframe_source</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">series_common_type</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                        <span class="n">df_dataframe_target</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_dataframe_target</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">series_common_type</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

                <span class="n">df_dup_source</span> <span class="o">=</span> <span class="n">df_dataframe_source</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">df_dup_target</span> <span class="o">=</span> <span class="n">df_dataframe_target</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">df_dup2_source</span> <span class="o">=</span> <span class="n">df_dup_source</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">df_dup2_target</span> <span class="o">=</span> <span class="n">df_dup_target</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">pstr_compare_mode</span> <span class="o">==</span> <span class="s1">&#39;header&#39;</span><span class="p">:</span>
                    <span class="n">df_dup2_source</span><span class="o">.</span><span class="n">set_axis</span><span class="p">(</span><span class="n">list_source_headers</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">df_dup2_target</span><span class="o">.</span><span class="n">set_axis</span><span class="p">(</span><span class="n">list_source_headers</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">list_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">list_headers_source</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">list_headers_target</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>

                <span class="k">if</span> <span class="n">bool_ignore_datatype</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">source_types</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_dataframe_source</span><span class="p">[</span><span class="n">list_headers</span><span class="p">]</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
                    <span class="n">target_types</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_dataframe_target</span><span class="p">[</span><span class="n">list_headers</span><span class="p">]</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
                    <span class="n">series_common_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__datatype_conversion</span><span class="p">(</span><span class="n">source_types</span><span class="p">,</span> <span class="n">target_types</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">series_common_type</span><span class="p">)):</span>
                        <span class="n">df_dataframe_source</span><span class="p">[</span><span class="n">list_headers</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">df_dataframe_source</span><span class="p">[</span><span class="n">list_headers</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span>
                            <span class="n">series_common_type</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                        <span class="n">df_dataframe_target</span><span class="p">[</span><span class="n">list_headers</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">df_dataframe_target</span><span class="p">[</span><span class="n">list_headers</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span>
                            <span class="n">series_common_type</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

                <span class="n">df_dup_source</span> <span class="o">=</span> <span class="n">df_dataframe_source</span><span class="p">[</span><span class="n">list_headers</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">df_dup_target</span> <span class="o">=</span> <span class="n">df_dataframe_target</span><span class="p">[</span><span class="n">list_headers</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">df_dup2_source</span> <span class="o">=</span> <span class="n">df_dup_source</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">df_dup2_target</span> <span class="o">=</span> <span class="n">df_dup_target</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">list_headers</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">list_headers_source</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">list_headers_target</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">bool_ignore_datatype</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">source_types</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_dataframe_source</span><span class="p">[</span><span class="n">list_headers_source</span><span class="p">]</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
                    <span class="n">target_types</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_dataframe_target</span><span class="p">[</span><span class="n">list_headers_target</span><span class="p">]</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
                    <span class="n">series_common_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__datatype_conversion</span><span class="p">(</span><span class="n">source_types</span><span class="p">,</span> <span class="n">target_types</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">series_common_type</span><span class="p">)):</span>
                        <span class="n">df_dataframe_source</span><span class="p">[</span><span class="n">list_headers_source</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">df_dataframe_source</span><span class="p">[</span>
                            <span class="n">list_headers_source</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">series_common_type</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                        <span class="n">df_dataframe_target</span><span class="p">[</span><span class="n">list_headers_target</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">df_dataframe_target</span><span class="p">[</span>
                            <span class="n">list_headers_target</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">series_common_type</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

                <span class="k">if</span> <span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">list_headers_source</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_headers_source</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_headers_target</span><span class="p">))):</span>
                    <span class="n">df_dup_source</span> <span class="o">=</span> <span class="n">df_dataframe_source</span><span class="p">[</span><span class="n">list_headers_source</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                    <span class="n">df_dup_target</span> <span class="o">=</span> <span class="n">df_dataframe_target</span><span class="p">[</span><span class="n">list_headers_target</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                    <span class="n">df_dup2_source</span> <span class="o">=</span> <span class="n">df_dup_source</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                    <span class="n">df_dup2_target</span> <span class="o">=</span> <span class="n">df_dup_target</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                    <span class="n">df_dup2_source</span><span class="o">.</span><span class="n">set_axis</span><span class="p">(</span><span class="n">list_headers_source</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">df_dup2_target</span><span class="o">.</span><span class="n">set_axis</span><span class="p">(</span><span class="n">list_headers_source</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;The count of source header and target header list is not equal&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Looks like there is a conflict in the given kwargs parameters, please check them&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">df_dup2_source</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">df_dup2_target</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">df_dup2_source</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">df_dup2_target</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">diffs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_dup2_source</span><span class="p">,</span> <span class="n">df_dup2_target</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">df_filtered_source_temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">diffs</span><span class="p">,</span> <span class="n">df_dup2_source</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">df_filtered_source</span> <span class="o">=</span> <span class="n">df_filtered_source_temp</span><span class="p">[</span><span class="n">df_filtered_source_temp</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()]</span>
                <span class="n">df_filtered_target_temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">diffs</span><span class="p">,</span> <span class="n">df_dup2_target</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">df_filtered_target</span> <span class="o">=</span> <span class="n">df_filtered_target_temp</span><span class="p">[</span><span class="n">df_filtered_target_temp</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()]</span>
                <span class="k">if</span> <span class="n">pstr_compare_mode</span> <span class="o">==</span> <span class="s1">&#39;header&#39;</span> <span class="ow">and</span> <span class="n">list_headers_source</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">list_headers_target</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">df_filtered_target</span><span class="o">.</span><span class="n">set_axis</span><span class="p">(</span><span class="n">list_headers_target</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">bool_club</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">dict_primary_keys</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;When bool_club specified , please specify the headers also&quot;</span><span class="p">)</span>
                    <span class="n">df_clubbed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__difference_formatter</span><span class="p">(</span><span class="n">df_filtered_source</span><span class="p">,</span> <span class="n">df_filtered_target</span><span class="p">,</span>
                                                             <span class="n">plist_source_headers</span><span class="o">=</span><span class="n">list_headers_source</span><span class="p">,</span>
                                                             <span class="n">plist_target_headers</span><span class="o">=</span><span class="n">list_headers_target</span><span class="p">,</span>
                                                             <span class="n">pdict_primary_keys</span><span class="o">=</span><span class="n">dict_primary_keys</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">pbool_get_common</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">diffs</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                        <span class="n">df_common</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">diffs</span><span class="p">,</span> <span class="n">df_dup2_source</span><span class="p">,</span> <span class="n">df_dup2_target</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span>
                            <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">df_common</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">diffs</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_dup2_source</span><span class="p">,</span> <span class="n">df_dup2_target</span><span class="p">])</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span>
                            <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)])</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">bool_club</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">df_common</span><span class="p">,</span> <span class="n">df_clubbed</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">df_common</span><span class="p">,</span> <span class="n">df_filtered_source</span><span class="p">,</span> <span class="n">df_filtered_target</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">bool_club</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">df_clubbed</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">df_filtered_source</span><span class="p">,</span> <span class="n">df_filtered_target</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__datatype_conversion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_types</span><span class="p">,</span> <span class="n">target_types</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">common_type</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">source_types</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">source_types</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;f&#39;</span> <span class="ow">or</span> <span class="n">target_types</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span>
                    <span class="n">common_type</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">common_type</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">common_type</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">check_data_in_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plist_resultlist</span><span class="p">,</span> <span class="n">pdata_value</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Description:</span>
<span class="sd">            |  This method verifies if the value is present in the resultlist or not.</span>
<span class="sd">            |  It supports</span>
<span class="sd">            |      1. Check if value is available in a particular column</span>
<span class="sd">            |      2. Check if the value is present in multiple columns</span>
<span class="sd">            |      3. Check if the value is present in the resultlist irrespective of column name, just check if it exist or not</span>
<span class="sd">            |</span>


<span class="sd">        :param plist_resultlist:</span>
<span class="sd">        :type plist_resultlist: Result List</span>
<span class="sd">        :param pdata_column_header:</span>
<span class="sd">        :type pdata_column_header: Can be Int/String/Float/Datetime</span>


<span class="sd">        :return: bool/list of difference</span>
<span class="sd">        .. note::</span>
<span class="sd">            	|  Donot use this method directly into your code, please use the verify and assert method of assertion-datbase class</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>

            <span class="n">bool_ignore_case</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pbool_ignore_case&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">list_headers</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plist_headers&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">int_count</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pint_count&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">list_resultset_data</span> <span class="o">=</span> <span class="n">plist_resultlist</span>
            <span class="n">int_resultset_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_resultset_data</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">list_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_headers</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">df_resultset_dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">list_resultset_data</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">int_resultset_length</span><span class="p">],</span>
                                                          <span class="n">columns</span><span class="o">=</span><span class="n">list_resultset_data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">columns</span> <span class="o">=</span> <span class="n">list_headers</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The headers list should not be empty&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">df_resultset_dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">list_resultset_data</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">int_resultset_length</span><span class="p">])</span>
                <span class="n">columns</span> <span class="o">=</span> <span class="n">df_resultset_dataframe</span><span class="o">.</span><span class="n">columns</span>

            <span class="k">if</span> <span class="n">int_count</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">list_headers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">cols</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span>
                            <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">pdata_value</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">]):</span>
                                <span class="k">return</span> <span class="kc">True</span>
                        <span class="k">if</span> <span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;i&#39;</span><span class="p">:</span>
                            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">pdata_value</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">]):</span>
                                <span class="k">return</span> <span class="kc">True</span>
                        <span class="k">if</span> <span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span>
                            <span class="n">list_temp_col_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">])]</span>
                            <span class="k">if</span> <span class="n">bool_ignore_case</span><span class="p">:</span>
                                <span class="n">list_col_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">list_temp_col_data</span><span class="p">]</span>
                                <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">pdata_value</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span> <span class="ow">in</span> <span class="n">list_col_data</span><span class="p">:</span>
                                    <span class="k">return</span> <span class="kc">True</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">pdata_value</span><span class="p">)</span> <span class="ow">in</span> <span class="n">list_temp_col_data</span><span class="p">:</span>
                                    <span class="k">return</span> <span class="kc">True</span>
                        <span class="k">if</span> <span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;M&#39;</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">pdata_value</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">]):</span>
                                <span class="k">return</span> <span class="kc">True</span>
                    <span class="k">return</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">dict_individual_check</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="n">list_unmatched_headers</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="k">for</span> <span class="n">cols</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
                        <span class="n">int_fetch_count</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="k">if</span> <span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span>
                            <span class="n">int_fetch_count</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">(</span>
                                <span class="nb">float</span><span class="p">(</span><span class="n">pdata_value</span><span class="p">))</span> <span class="o">+</span> <span class="n">int_fetch_count</span>
                        <span class="k">if</span> <span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;i&#39;</span><span class="p">:</span>
                            <span class="n">int_fetch_count</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">(</span>
                                <span class="nb">int</span><span class="p">(</span><span class="n">pdata_value</span><span class="p">))</span> <span class="o">+</span> <span class="n">int_fetch_count</span>
                        <span class="k">if</span> <span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span>
                            <span class="n">list_temp_col_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">])]</span>
                            <span class="k">if</span> <span class="n">bool_ignore_case</span><span class="p">:</span>
                                <span class="n">list_col_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">list_temp_col_data</span><span class="p">]</span>
                                <span class="n">int_fetch_count</span> <span class="o">=</span> <span class="n">list_col_data</span><span class="o">.</span><span class="n">count</span><span class="p">(</span>
                                    <span class="nb">str</span><span class="p">(</span><span class="n">pdata_value</span><span class="p">))</span> <span class="o">+</span> <span class="n">int_fetch_count</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">int_fetch_count</span> <span class="o">=</span> <span class="n">list_temp_col_data</span><span class="o">.</span><span class="n">count</span><span class="p">(</span>
                                    <span class="nb">str</span><span class="p">(</span><span class="n">pdata_value</span><span class="p">))</span> <span class="o">+</span> <span class="n">int_fetch_count</span>
                        <span class="k">if</span> <span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;M&#39;</span><span class="p">:</span>
                            <span class="n">int_fetch_count</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">(</span>
                                <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">pdata_value</span><span class="p">))</span> <span class="o">+</span> <span class="n">int_fetch_count</span>
                        <span class="c1"># dict_individual_check[cols] = int_fetch_count</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">int_fetch_count</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">list_unmatched_headers</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">int_fetch_count</span>

                    <span class="k">return</span> <span class="n">list_unmatched_headers</span>

            <span class="c1"># code logic for count based comparison</span>
            <span class="k">elif</span> <span class="n">int_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">list_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="c1"># dict_individual_check = {}</span>
                    <span class="n">list_unmatched_headers</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="k">for</span> <span class="n">cols</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
                        <span class="n">int_fetch_count</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="k">if</span> <span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span>
                            <span class="n">int_fetch_count</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">(</span>
                                <span class="nb">float</span><span class="p">(</span><span class="n">pdata_value</span><span class="p">))</span> <span class="o">+</span> <span class="n">int_fetch_count</span>
                        <span class="k">if</span> <span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;i&#39;</span><span class="p">:</span>
                            <span class="n">int_fetch_count</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">(</span>
                                <span class="nb">int</span><span class="p">(</span><span class="n">pdata_value</span><span class="p">))</span> <span class="o">+</span> <span class="n">int_fetch_count</span>
                        <span class="k">if</span> <span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span>
                            <span class="n">list_temp_col_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">])]</span>
                            <span class="k">if</span> <span class="n">bool_ignore_case</span><span class="p">:</span>
                                <span class="n">list_col_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">list_temp_col_data</span><span class="p">]</span>
                                <span class="n">int_fetch_count</span> <span class="o">=</span> <span class="n">list_col_data</span><span class="o">.</span><span class="n">count</span><span class="p">(</span>
                                    <span class="nb">str</span><span class="p">(</span><span class="n">pdata_value</span><span class="p">))</span> <span class="o">+</span> <span class="n">int_fetch_count</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">int_fetch_count</span> <span class="o">=</span> <span class="n">list_temp_col_data</span><span class="o">.</span><span class="n">count</span><span class="p">(</span>
                                    <span class="nb">str</span><span class="p">(</span><span class="n">pdata_value</span><span class="p">))</span> <span class="o">+</span> <span class="n">int_fetch_count</span>
                        <span class="k">if</span> <span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;M&#39;</span><span class="p">:</span>
                            <span class="n">int_fetch_count</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">(</span>
                                <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">pdata_value</span><span class="p">))</span> <span class="o">+</span> <span class="n">int_fetch_count</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">int_fetch_count</span> <span class="o">==</span> <span class="n">int_count</span><span class="p">:</span>
                            <span class="n">list_unmatched_headers</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">int_fetch_count</span>

                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_unmatched_headers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">return</span> <span class="kc">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">list_unmatched_headers</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">int_fetch_count</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">for</span> <span class="n">cols</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span>
                            <span class="n">int_fetch_count</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">(</span>
                                <span class="nb">float</span><span class="p">(</span><span class="n">pdata_value</span><span class="p">))</span> <span class="o">+</span> <span class="n">int_fetch_count</span>
                        <span class="k">if</span> <span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;i&#39;</span><span class="p">:</span>
                            <span class="n">int_fetch_count</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">(</span>
                                <span class="nb">int</span><span class="p">(</span><span class="n">pdata_value</span><span class="p">))</span> <span class="o">+</span> <span class="n">int_fetch_count</span>
                        <span class="k">if</span> <span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span>
                            <span class="n">list_temp_col_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">])]</span>
                            <span class="k">if</span> <span class="n">bool_ignore_case</span><span class="p">:</span>
                                <span class="n">list_col_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">list_temp_col_data</span><span class="p">]</span>
                                <span class="n">int_fetch_count</span> <span class="o">=</span> <span class="n">list_col_data</span><span class="o">.</span><span class="n">count</span><span class="p">(</span>
                                    <span class="nb">str</span><span class="p">(</span><span class="n">pdata_value</span><span class="p">))</span> <span class="o">+</span> <span class="n">int_fetch_count</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">int_fetch_count</span> <span class="o">=</span> <span class="n">list_temp_col_data</span><span class="o">.</span><span class="n">count</span><span class="p">(</span>
                                    <span class="nb">str</span><span class="p">(</span><span class="n">pdata_value</span><span class="p">))</span> <span class="o">+</span> <span class="n">int_fetch_count</span>

                        <span class="k">if</span> <span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;M&#39;</span><span class="p">:</span>
                            <span class="n">int_fetch_count</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">(</span>
                                <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">pdata_value</span><span class="p">))</span> <span class="o">+</span> <span class="n">int_fetch_count</span>

                    <span class="k">if</span> <span class="n">int_fetch_count</span> <span class="o">==</span> <span class="n">int_count</span><span class="p">:</span>
                        <span class="k">return</span> <span class="kc">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">return</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;the pint_count if specified must have positive value&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">e</span>

    <span class="k">def</span> <span class="nf">check_headers_in_resultlist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plist_resultlist</span><span class="p">,</span> <span class="n">plist_headers</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Description:</span>
<span class="sd">            |   This method is for verifying whether the headers are available in the resultlist or not</span>
<span class="sd">            |   The resultlist that will be passed in this method should be the one that is returned by the execute_statement method</span>
<span class="sd">        :param plist_resultlist: resultlist generated by execute_statement</span>
<span class="sd">        :param plist_headers:  list of headers to check if available or not</span>
<span class="sd">        :return: invalid match list</span>

<span class="sd">        .. note::</span>
<span class="sd">            |  Donot use this method directly into your code, please use the verify and assert method of assertion-datbase class</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">bool_ignore_case</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pbool_ignore_case&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">list_source_headers</span> <span class="o">=</span> <span class="n">plist_resultlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">list_headers</span> <span class="o">=</span> <span class="n">plist_headers</span>
            <span class="n">list_diff</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">bool_ignore_case</span><span class="p">:</span>
                <span class="n">list_source_headers</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">list_source_headers</span><span class="p">]</span>
                <span class="n">list_headers</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">list_headers</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_source_headers</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_headers</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The list_source_headers contains more headers than the resultlist one&quot;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">list_headers</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">val</span> <span class="ow">in</span> <span class="n">list_source_headers</span><span class="p">):</span>
                    <span class="n">list_diff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">list_diff</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">e</span>

    <span class="k">def</span> <span class="nf">spark_execute_statement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pobject_Sparkclient</span><span class="p">,</span> <span class="n">p_query</span><span class="p">,</span> <span class="n">pbool_default_spark_command</span><span class="p">,</span> <span class="n">pstr_name</span><span class="p">,</span>
                                <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Description:</span>
<span class="sd">            |  This method allows user to execute a HIVE database query statement using spark-sql.</span>

<span class="sd">        :param pobject_Sparkclient:</span>
<span class="sd">        :type pobject_Sparkclient: Spark-Sql Database Connection Object</span>
<span class="sd">        :param p_query:</span>
<span class="sd">        :type p_query: String</span>
<span class="sd">        :param pstr_return_type: list/resultset</span>
<span class="sd">        :type pstr_return_type: String</span>
<span class="sd">        :param pint_driver_memory: driver memory</span>
<span class="sd">        :type pint_driver_memory: int</span>
<span class="sd">        :param pint_executors: number of executors</span>
<span class="sd">        :type pint_executors: int</span>
<span class="sd">        :param pint_cores: number of cores</span>
<span class="sd">        :type pint_cores: int</span>
<span class="sd">        :param pint_executor_memory: executor memory</span>
<span class="sd">        :type pint_executor_memory: int</span>
<span class="sd">        :param pstr_other_param: accepts other parameters like --conf spark.yarn.am.nodeLabelExpression=xlarge --conf spark.dynamicAllocation.enabled=false</span>
<span class="sd">        :type pstr_other_param: string</span>
<span class="sd">        :param pbool_default_spark_command: if the value is True it none of the above parameters need to be passed in the method</span>
<span class="sd">        :type pbool_default_spark_command: boolean</span>
<span class="sd">        :param pstr_name: QA name</span>
<span class="sd">        :type pstr_name: string</span>

<span class="sd">        :return: List or ResultSet or Boolean</span>

<span class="sd">        .. notes::</span>
<span class="sd">            |  This method returns a list or a resultset based on the parameter pstr_return_type. &#39;select&#39; statements will returns List/Resultset and other type of statements will return Boolean.</span>


<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">int_driver_memory</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pint_driver_memory&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">int_executors</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pint_executors&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">int_cores</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pint_cores&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">int_executor_memory</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pint_executor_memory&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">str_other_param</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pstr_other_param&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">pobject_Sparkclient</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Object is None&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">p_query</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The query is None&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">pstr_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The spark config name is None&quot;</span><span class="p">)</span>

            <span class="n">pobject_Sparkclient</span><span class="o">.</span><span class="n">invoke_shell</span><span class="p">()</span>
            <span class="n">str_sparkAppConfig</span> <span class="o">=</span> <span class="s1">&#39;spark-sql&#39;</span>
            <span class="k">if</span> <span class="n">pbool_default_spark_command</span><span class="p">:</span>
                <span class="n">str_sparkAppConfig</span> <span class="o">=</span> <span class="n">str_sparkAppConfig</span> <span class="o">+</span> <span class="s1">&#39; --name &#39;</span> <span class="o">+</span> <span class="n">pstr_name</span> <span class="o">+</span> <span class="s1">&#39; -S -e &#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">str_sparkAppConfig</span> <span class="o">=</span> <span class="n">str_sparkAppConfig</span> <span class="o">+</span> <span class="s1">&#39; --master yarn &#39;</span>
                <span class="k">if</span> <span class="n">int_driver_memory</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">str_sparkAppConfig</span> <span class="o">=</span> <span class="n">str_sparkAppConfig</span> <span class="o">+</span> <span class="s1">&#39; --driver-memory &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">int_driver_memory</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;g&#39;</span>
                <span class="k">if</span> <span class="n">int_executors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">str_sparkAppConfig</span> <span class="o">=</span> <span class="n">str_sparkAppConfig</span> <span class="o">+</span> <span class="s1">&#39; --num-executors &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">int_executors</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">int_cores</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">str_sparkAppConfig</span> <span class="o">=</span> <span class="n">str_sparkAppConfig</span> <span class="o">+</span> <span class="s1">&#39; --executor-cores=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">int_cores</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">int_executor_memory</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">str_sparkAppConfig</span> <span class="o">=</span> <span class="n">str_sparkAppConfig</span> <span class="o">+</span> <span class="s1">&#39; --executor-memory &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">int_executor_memory</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;g&#39;</span>
                <span class="k">if</span> <span class="n">str_other_param</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">str_sparkAppConfig</span> <span class="o">=</span> <span class="n">str_sparkAppConfig</span> <span class="o">+</span> <span class="n">str_other_param</span>
                <span class="k">if</span> <span class="n">pstr_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">str_sparkAppConfig</span> <span class="o">=</span> <span class="n">str_sparkAppConfig</span> <span class="o">+</span> <span class="s1">&#39; --name &#39;</span> <span class="o">+</span> <span class="n">pstr_name</span> <span class="o">+</span> <span class="s1">&#39; -S -e &#39;</span>

            <span class="n">stdin</span><span class="p">,</span> <span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span> <span class="o">=</span> <span class="n">pobject_Sparkclient</span><span class="o">.</span><span class="n">exec_command</span><span class="p">(</span><span class="n">str_sparkAppConfig</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\&quot;</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">p_query</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\&quot;</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">str_errResult</span> <span class="o">=</span> <span class="n">stderr</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">str_errResult</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;Error in query&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">str_errResult</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="n">hive_SSH</span><span class="o">.</span><span class="n">SSHException</span><span class="p">(</span><span class="s2">&quot;Execute command Error:&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">str_errResult</span><span class="p">))</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
            <span class="n">rs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe_to_resultset</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">pstr_return_type</span> <span class="o">==</span> <span class="s1">&#39;list&#39;</span><span class="p">:</span>
                <span class="n">rs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resultset_to_list</span><span class="p">(</span><span class="n">rs</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">rs</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__difference_formatter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df_source_target</span><span class="p">,</span> <span class="n">df_target_source</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Description:</span>
<span class="sd">            | This method is for more focused difference between two dataframes</span>
<span class="sd">        :param diff1:</span>
<span class="sd">        :param diff2:</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">list_source_headers</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;plist_source_headers&quot;</span><span class="p">)</span>
            <span class="n">list_target_headers</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;plist_target_headers&quot;</span><span class="p">)</span>
            <span class="n">dict_primary_keys</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pdict_primary_keys&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">list_source_headers</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">list_target_headers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;case of no special headers given&quot;</span><span class="p">)</span>
            <span class="n">list_source_primary_keys</span> <span class="o">=</span> <span class="n">dict_primary_keys</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;source&#39;</span><span class="p">)</span>
            <span class="n">list_target_primary_keys</span> <span class="o">=</span> <span class="n">dict_primary_keys</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;target&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_source_primary_keys</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_target_primary_keys</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The number of primary keys for Source and Target are not same&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_source_primary_keys</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Only one primary key is allowed&quot;</span><span class="p">)</span>

            <span class="c1"># Arranging the list according to the primary key</span>
            <span class="k">for</span> <span class="n">source_val</span> <span class="ow">in</span> <span class="n">list_source_primary_keys</span><span class="p">:</span>
                <span class="n">list_source_headers</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">source_val</span><span class="p">)</span>
            <span class="n">list_sorted_source_headers</span> <span class="o">=</span> <span class="n">list_source_primary_keys</span> <span class="o">+</span> <span class="n">list_source_headers</span>

            <span class="k">for</span> <span class="n">target_val</span> <span class="ow">in</span> <span class="n">list_target_primary_keys</span><span class="p">:</span>
                <span class="n">list_target_headers</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">target_val</span><span class="p">)</span>
            <span class="n">list_sorted_target_headers</span> <span class="o">=</span> <span class="n">list_target_primary_keys</span> <span class="o">+</span> <span class="n">list_target_headers</span>

            <span class="n">source_row_count</span><span class="p">,</span> <span class="n">source_column_count</span> <span class="o">=</span> <span class="n">df_source_target</span><span class="o">.</span><span class="n">shape</span>
            <span class="n">target_row_count</span><span class="p">,</span> <span class="n">source_column_count</span> <span class="o">=</span> <span class="n">df_target_source</span><span class="o">.</span><span class="n">shape</span>

            <span class="n">df_source_target</span> <span class="o">=</span> <span class="n">df_source_target</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s1">&#39;source_&#39;</span><span class="p">)</span>
            <span class="n">df_target_source</span> <span class="o">=</span> <span class="n">df_target_source</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s1">&#39;target_&#39;</span><span class="p">)</span>

            <span class="n">temp_list_full</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">list_full</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_sorted_target_headers</span><span class="p">)):</span>
                <span class="n">list_full</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;source_&quot;</span> <span class="o">+</span> <span class="n">list_sorted_source_headers</span><span class="p">[</span><span class="n">count</span><span class="p">])</span>
                <span class="n">list_full</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;target_&quot;</span> <span class="o">+</span> <span class="n">list_sorted_target_headers</span><span class="p">[</span><span class="n">count</span><span class="p">])</span>

            <span class="c1"># dataframe_final = pd.DataFrame(columns=list_full)</span>
            <span class="n">whole_data_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">sr_count</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">source_row_count</span><span class="p">):</span>
                <span class="n">temp_value</span> <span class="o">=</span> <span class="n">df_source_target</span><span class="p">[</span><span class="s2">&quot;source_&quot;</span> <span class="o">+</span> <span class="n">list_source_primary_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">sr_count</span><span class="p">]</span>
                <span class="n">temp_source_series</span> <span class="o">=</span> <span class="n">df_source_target</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">sr_count</span><span class="p">]</span>
                <span class="n">temp_target_series</span> <span class="o">=</span> <span class="n">df_target_source</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
                    <span class="n">df_target_source</span><span class="p">[</span><span class="s2">&quot;target_&quot;</span> <span class="o">+</span> <span class="n">list_target_primary_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">==</span> <span class="n">temp_value</span><span class="p">]</span>
                <span class="n">df_target_source</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span>
                    <span class="n">df_target_source</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_target_source</span><span class="p">[</span><span class="s2">&quot;target_&quot;</span> <span class="o">+</span> <span class="n">list_target_primary_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">==</span> <span class="n">temp_value</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                    <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">temp_data</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">header_val</span> <span class="ow">in</span> <span class="n">list_full</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">header_val</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;target_&quot;</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">temp_target_series</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                            <span class="n">temp_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">temp_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_target_series</span><span class="p">[</span><span class="n">header_val</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># fix here</span>
                        <span class="n">temp_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_source_series</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">header_val</span><span class="p">))</span>
                <span class="n">whole_data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_data</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">sr_count</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">target_row_count</span><span class="p">):</span>
                <span class="c1"># temp_value = df_target_source[&quot;target_&quot;+list_target_primary_keys[0]][sr_count]</span>
                <span class="n">temp_data</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">list_full</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">val</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;source_&quot;</span><span class="p">):</span>
                        <span class="n">temp_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">temp_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_target_source</span><span class="p">[</span><span class="n">val</span><span class="p">][</span><span class="n">sr_count</span><span class="p">])</span>
                <span class="n">whole_data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_data</span><span class="p">)</span>

            <span class="n">dataframe_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">whole_data_list</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">list_full</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">dataframe_final</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">check_db_exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pobject_connection</span><span class="p">,</span> <span class="n">pstr_database_name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Description:</span>
<span class="sd">            |  This method is used to verify the existence of DB in particular DB Server</span>

<span class="sd">        :param pobject_connection: This parameter contains the connection object provided by the user</span>
<span class="sd">        :type pobject_connection: Object</span>
<span class="sd">        :param pstr_database_name: This parameter contains the DB name provided by the user</span>
<span class="sd">        :type pstr_database_name: string</span>

<span class="sd">        :return: bool</span>

<span class="sd">        Examples:</span>
<span class="sd">            | check_db_exists(connection, database_name)</span>
<span class="sd">        .. warning::</span>
<span class="sd">            |  This method currently supports SQL Server, PostgreSQL and Oracle DB Servers.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pobject_connection</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_database_object</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">pstr_database_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_database_name</span><span class="p">()</span>

            <span class="n">bln_is_database_exists</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">pobject_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;postgresql&#39;</span><span class="p">):</span>
                <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobject_connection</span><span class="p">,</span>
                                                      <span class="s2">&quot;SELECT * FROM pg_catalog.pg_database WHERE datname=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_database_name</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                                      <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">rs_resultset</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">bln_is_database_exists</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">bln_is_database_exists</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">pobject_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;mssql&#39;</span><span class="p">):</span>
                <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobject_connection</span><span class="p">,</span>
                                                      <span class="s2">&quot;select * from sys.databases where name=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_database_name</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                                      <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">rs_resultset</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">bln_is_database_exists</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">bln_is_database_exists</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">elif</span> <span class="p">(</span><span class="n">pobject_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;oracle&#39;</span><span class="p">):</span>
                <span class="n">lst_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobject_connection</span><span class="p">,</span>
                                                    <span class="s2">&quot;SELECT owner FROM all_tab_columns where Owner =&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_database_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                                    <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;list&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">lst_result</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">):</span>
                    <span class="n">bln_is_database_exists</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">bln_is_database_exists</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_custom_exception</span><span class="p">(</span>
                    <span class="n">pstr_message</span><span class="o">=</span><span class="s2">&quot;Error -&gt; Provided parameters are not supported&quot;</span><span class="p">,</span>
                    <span class="n">pbool_fail_on_exception</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">bln_is_database_exists</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span>
                <span class="n">pstr_message</span><span class="o">=</span><span class="s2">&quot;Error -&gt; DB not connected properly&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
                <span class="n">pbool_insert_kibana</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">pbool_trim_log</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pbool_log_local_exceptions</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">pbool_fail_on_exception</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">pbool_use_pytest_format</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">verify_column_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pobj_connection</span><span class="p">,</span> <span class="n">pstr_db_name</span><span class="p">,</span> <span class="n">pstr_table_name</span><span class="p">,</span> <span class="n">pstr_col_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Description:</span>
<span class="sd">            |  This method is used to perform different operation on any column like checking its existence, its datatype, its max length, its NULL and</span>
<span class="sd">               Primtary key constraints etc.</span>

<span class="sd">        :param pobj_connection: This parameter contains the connection object provided by the user</span>
<span class="sd">        :type pobj_connection: Object</span>
<span class="sd">        :param pstr_db_name: This parameter contains the database name provided by the user</span>
<span class="sd">        :type pstr_db_name: string</span>
<span class="sd">        :param pstr_table_name: This parameter contains the table name provided by the user</span>
<span class="sd">        :type pstr_table_name: string</span>
<span class="sd">        :param pstr_col_name: This parameter contains the column name provided by the user</span>
<span class="sd">        :type pstr_col_name: string</span>
<span class="sd">        :param bln_col_existence: This flag tells us that the user wants to check the column&#39;s existence</span>
<span class="sd">        :type bln_col_existence: bool</span>
<span class="sd">        :param bln_data_type: This flag tells us that the user wants to get the Data Type of particular column</span>
<span class="sd">        :type bln_data_type: bool</span>
<span class="sd">        :param bln_max_length: This flag tells us that the user wants to get the Maximum length of particular column</span>
<span class="sd">        :type bln_max_length: bool</span>
<span class="sd">        :param bln_is_null: This flag tells us that the user wants to verify the NULL constraint of respective column</span>
<span class="sd">        :type bln_is_null: bool</span>
<span class="sd">        :param bln_is_not_null: This flag tells us that the user wants to verify the Not NULL constraint of respective column</span>
<span class="sd">        :type bln_is_not_null: bool</span>
<span class="sd">        :param bln_is_primary_key: This flag tells us that the user wants to verify the Primary Key constraint of respective column</span>
<span class="sd">        :type bln_is_primary_key: bool</span>
<span class="sd">        :param bln_is_not_primary_key: This flag tells us that the user wants to verify the No Primary Key constraint of respective column</span>
<span class="sd">        :type bln_is_not_primary_key: bool</span>

<span class="sd">        :return: dictionary</span>

<span class="sd">        Examples:</span>
<span class="sd">            | verify_column_metadata(connection,database_name,table_name,column_name,bln_col_existence=True)</span>
<span class="sd">            | verify_column_metadata(connection,database_name,table_name,column_name,pstr_data_type=True)</span>
<span class="sd">            | verify_column_metadata(connection,database_name,table_name,column_name,pstr_max_length=True)</span>
<span class="sd">            | verify_column_metadata(connection,database_name,table_name,column_name,bln_is_null=True)</span>
<span class="sd">            | verify_column_metadata(connection,database_name,table_name,column_name,bln_is_not_null=True)</span>
<span class="sd">            | verify_column_metadata(connection,database_name,table_name,column_name,bln_is_primary_key=True)</span>
<span class="sd">            | verify_column_metadata(connection,database_name,table_name,column_name,bln_is_not_primary_key=True)</span>
<span class="sd">            | verify_column_metadata(connection,database_name,table_name,column_name)</span>

<span class="sd">        .. warning::</span>
<span class="sd">            |  This method currently supports SQL Server, PostgreSQL and Oracle DB Servers.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">dict_result</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">rs_resultset</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">if</span> <span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;mssql&#39;</span><span class="p">,</span> <span class="s1">&#39;oracle&#39;</span><span class="p">,</span> <span class="s1">&#39;postgresql&#39;</span><span class="p">):</span>
                <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_custom_exception</span><span class="p">(</span>
                    <span class="n">pstr_message</span><span class="o">=</span><span class="s2">&quot;Error -&gt; Provided parameters are not supported&quot;</span><span class="p">,</span>
                    <span class="n">pbool_fail_on_exception</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;bln_col_existence&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;oracle&#39;</span><span class="p">):</span>
                    <span class="n">lst_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                        <span class="s2">&quot;SELECT * FROM all_tab_columns WHERE table_name = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND column_name =&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39; and owner=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                                        <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;list&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">lst_result</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">):</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_col_existence&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_col_existence&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;postgresql&#39;</span><span class="p">):</span>
                    <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                          <span class="s2">&quot;SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND COLUMN_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; and table_schema=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                                          <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">rs_resultset</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_col_existence&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_col_existence&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;mssql&#39;</span><span class="p">):</span>
                    <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                          <span class="s2">&quot;use &quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span> <span class="o">+</span> <span class="s2">&quot; SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND COLUMN_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                                          <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">rs_resultset</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_col_existence&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_col_existence&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;pstr_data_type&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;oracle&#39;</span><span class="p">):</span>
                    <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                          <span class="s2">&quot;SELECT data_type FROM all_tab_columns WHERE table_name = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND column_name =&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39; and owner=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                                          <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                    <span class="n">pstr_datatype</span> <span class="o">=</span> <span class="n">rs_resultset</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">pstr_datatype</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;pstr_data_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;pstr_data_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pstr_datatype</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;postgresql&#39;</span><span class="p">):</span>
                    <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                          <span class="s2">&quot;SELECT DATA_TYPE FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND COLUMN_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; and table_schema=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                                          <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                    <span class="n">pstr_datatype</span> <span class="o">=</span> <span class="n">rs_resultset</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">pstr_datatype</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;pstr_data_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;pstr_data_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pstr_datatype</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;mssql&#39;</span><span class="p">):</span>
                    <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                          <span class="s2">&quot;use &quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span> <span class="o">+</span> <span class="s2">&quot; SELECT DATA_TYPE FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND COLUMN_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                                          <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                    <span class="n">pstr_datatype</span> <span class="o">=</span> <span class="n">rs_resultset</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">pstr_datatype</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;pstr_data_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;pstr_data_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pstr_datatype</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;pstr_max_length&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;postgresql&#39;</span><span class="p">):</span>
                    <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                          <span class="s2">&quot;SELECT character_maximum_length FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND COLUMN_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; and table_schema=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                                          <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                    <span class="n">pstr_maxlength</span> <span class="o">=</span> <span class="n">rs_resultset</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">pstr_maxlength</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="kc">None</span><span class="p">):</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;pstr_max_length&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;pstr_max_length&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pstr_maxlength</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;mssql&#39;</span><span class="p">):</span>
                    <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                          <span class="s2">&quot;use &quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span> <span class="o">+</span> <span class="s2">&quot; Select * from sys.columns where name=N&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; and OBJECT_ID = OBJECT_ID(N&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span> <span class="o">+</span> <span class="s2">&quot;&#39;)&quot;</span><span class="p">,</span>
                                                          <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                    <span class="n">pstr_maxlength</span> <span class="o">=</span> <span class="n">rs_resultset</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">pstr_maxlength</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="kc">None</span><span class="p">):</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;pstr_max_length&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;pstr_max_length&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pstr_maxlength</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">5</span><span class="p">])</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;oracle&#39;</span><span class="p">):</span>
                    <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                          <span class="s2">&quot;SELECT data_length FROM all_tab_columns WHERE table_name = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND column_name =&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39; and owner=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                                          <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                    <span class="n">pstr_maxlength</span> <span class="o">=</span> <span class="n">rs_resultset</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">pstr_maxlength</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="kc">None</span><span class="p">):</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;pstr_max_length&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;pstr_max_length&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pstr_maxlength</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;bln_is_null&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;oracle&#39;</span><span class="p">):</span>
                    <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                          <span class="s2">&quot;SELECT nullable FROM all_tab_columns WHERE table_name = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND column_name =&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39; and owner=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                                          <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                    <span class="n">bln_isnull</span> <span class="o">=</span> <span class="n">rs_resultset</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">bln_isnull</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;N&#39;</span><span class="p">):</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_null&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_null&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;postgresql&#39;</span><span class="p">):</span>
                    <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                          <span class="s2">&quot;SELECT is_nullable FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND COLUMN_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; and table_schema=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                                          <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                    <span class="n">bln_isnull</span> <span class="o">=</span> <span class="n">rs_resultset</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">bln_isnull</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;NO&#39;</span><span class="p">):</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_null&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_null&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;mssql&#39;</span><span class="p">):</span>
                    <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                          <span class="s2">&quot;use &quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span> <span class="o">+</span> <span class="s2">&quot; SELECT is_nullable FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND COLUMN_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                                          <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                    <span class="n">bln_isnull</span> <span class="o">=</span> <span class="n">rs_resultset</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">bln_isnull</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;NO&#39;</span><span class="p">):</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_null&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_null&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;bln_is_not_null&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;oracle&#39;</span><span class="p">):</span>
                    <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                          <span class="s2">&quot;SELECT nullable FROM all_tab_columns WHERE table_name = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND column_name =&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39; and owner=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                                          <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                    <span class="n">bln_isnull</span> <span class="o">=</span> <span class="n">rs_resultset</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">bln_isnull</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;N&#39;</span><span class="p">):</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_not_null&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_not_null&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;postgresql&#39;</span><span class="p">):</span>
                    <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                          <span class="s2">&quot;SELECT is_nullable FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND COLUMN_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; and table_schema=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                                          <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                    <span class="n">bln_isnull</span> <span class="o">=</span> <span class="n">rs_resultset</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">bln_isnull</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;NO&#39;</span><span class="p">):</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_not_null&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_not_null&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;mssql&#39;</span><span class="p">):</span>
                    <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                          <span class="s2">&quot;use &quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span> <span class="o">+</span> <span class="s2">&quot; SELECT is_nullable FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND COLUMN_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                                          <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                    <span class="n">bln_isnull</span> <span class="o">=</span> <span class="n">rs_resultset</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">bln_isnull</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;NO&#39;</span><span class="p">):</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_not_null&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_not_null&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;bln_is_primary_key&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;oracle&#39;</span><span class="p">):</span>
                    <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                          <span class="s2">&quot;SELECT cols.table_name, cols.column_name, cols.position, cons.status, cons.owner FROM all_constraints cons, all_cons_columns cols WHERE cols.table_name =&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39;  and cols.owner=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND cols.column_name =&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND cons.constraint_type = &#39;P&#39; AND cons.constraint_name = cols.constraint_name AND cons.owner = cols.owner ORDER BY cols.table_name, cols.position&quot;</span><span class="p">,</span>
                                                          <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;list&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">rs_resultset</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">):</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_primary_key&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_primary_key&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;postgresql&#39;</span><span class="p">):</span>
                    <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                          <span class="s2">&quot;SELECT K.TABLE_NAME, C.CONSTRAINT_TYPE, K.COLUMN_NAME, K.CONSTRAINT_NAME FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS AS C JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE AS K ON C.TABLE_NAME = K.TABLE_NAME AND C.CONSTRAINT_CATALOG = K.CONSTRAINT_CATALOG AND C.CONSTRAINT_SCHEMA = K.CONSTRAINT_SCHEMA AND C.CONSTRAINT_NAME = K.CONSTRAINT_NAME WHERE C.CONSTRAINT_TYPE = &#39;PRIMARY KEY&#39; And K.Table_Name=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; And K.Column_name=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; and K.table_schema=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; ORDER BY K.TABLE_NAME, C.CONSTRAINT_TYPE, K.CONSTRAINT_NAME&quot;</span><span class="p">,</span>
                                                          <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">rs_resultset</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_primary_key&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_primary_key&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;mssql&#39;</span><span class="p">):</span>
                    <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                          <span class="s2">&quot;use &quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span> <span class="o">+</span> <span class="s2">&quot; SELECT K.TABLE_NAME, C.CONSTRAINT_TYPE, K.COLUMN_NAME, K.CONSTRAINT_NAME FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS AS C JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE AS K ON C.TABLE_NAME = K.TABLE_NAME AND C.CONSTRAINT_CATALOG = K.CONSTRAINT_CATALOG AND C.CONSTRAINT_SCHEMA = K.CONSTRAINT_SCHEMA AND C.CONSTRAINT_NAME = K.CONSTRAINT_NAME WHERE C.CONSTRAINT_TYPE = &#39;PRIMARY KEY&#39; And K.Table_Name=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; And K.Column_name=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; ORDER BY K.TABLE_NAME, C.CONSTRAINT_TYPE, K.CONSTRAINT_NAME&quot;</span><span class="p">,</span>
                                                          <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">rs_resultset</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_primary_key&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_primary_key&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;bln_is_not_primary_key&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;oracle&#39;</span><span class="p">):</span>
                    <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                          <span class="s2">&quot;SELECT cols.table_name, cols.column_name, cols.position, cons.status, cons.owner FROM all_constraints cons, all_cons_columns cols WHERE cols.table_name =&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND cols.column_name =&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND cons.constraint_type = &#39;P&#39; AND cons.constraint_name = cols.constraint_name AND cons.owner = cols.owner ORDER BY cols.table_name, cols.position&quot;</span><span class="p">,</span>
                                                          <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;list&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">rs_resultset</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">):</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_not_primary_key&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_not_primary_key&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;postgresql&#39;</span><span class="p">):</span>
                    <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                          <span class="s2">&quot;SELECT K.TABLE_NAME, C.CONSTRAINT_TYPE, K.COLUMN_NAME, K.CONSTRAINT_NAME FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS AS C JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE AS K ON C.TABLE_NAME = K.TABLE_NAME AND C.CONSTRAINT_CATALOG = K.CONSTRAINT_CATALOG AND C.CONSTRAINT_SCHEMA = K.CONSTRAINT_SCHEMA AND C.CONSTRAINT_NAME = K.CONSTRAINT_NAME WHERE C.CONSTRAINT_TYPE = &#39;PRIMARY KEY&#39; And K.Table_Name=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; And K.Column_name=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; and K.table_schema=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; ORDER BY K.TABLE_NAME, C.CONSTRAINT_TYPE, K.CONSTRAINT_NAME&quot;</span><span class="p">,</span>
                                                          <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">rs_resultset</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_not_primary_key&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_not_primary_key&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;mssql&#39;</span><span class="p">):</span>
                    <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                          <span class="s2">&quot;use &quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span> <span class="o">+</span> <span class="s2">&quot; SELECT K.TABLE_NAME, C.CONSTRAINT_TYPE, K.COLUMN_NAME, K.CONSTRAINT_NAME FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS AS C JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE AS K ON C.TABLE_NAME = K.TABLE_NAME AND C.CONSTRAINT_CATALOG = K.CONSTRAINT_CATALOG AND C.CONSTRAINT_SCHEMA = K.CONSTRAINT_SCHEMA AND C.CONSTRAINT_NAME = K.CONSTRAINT_NAME WHERE C.CONSTRAINT_TYPE = &#39;PRIMARY KEY&#39; And K.Table_Name=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; And K.Column_name=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; ORDER BY K.TABLE_NAME, C.CONSTRAINT_TYPE, K.CONSTRAINT_NAME&quot;</span><span class="p">,</span>
                                                          <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">rs_resultset</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_not_primary_key&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_not_primary_key&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dict_result</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;oracle&#39;</span><span class="p">):</span>
                        <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                              <span class="s2">&quot;SELECT * FROM all_tab_columns WHERE table_name = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND column_name = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39; and owner=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                                              <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                        <span class="k">return</span> <span class="n">rs_resultset</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                              <span class="s2">&quot;SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND COLUMN_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                                              <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">rs_resultset</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

            <span class="k">return</span> <span class="n">dict_result</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span>
                <span class="n">pstr_message</span><span class="o">=</span><span class="s2">&quot;Error -&gt; Column information id not given properly &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
                <span class="n">pbool_insert_kibana</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">pbool_trim_log</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pbool_log_local_exceptions</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">pbool_fail_on_exception</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">pbool_use_pytest_format</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">modify_sql_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pfile_path</span><span class="p">,</span> <span class="n">pdict_data_dictionary</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Description:</span>
<span class="sd">        |  This function edit sql queries residing inside .sql,.txt or .json files at run time</span>
<span class="sd">        |  The user has to save the file at a specific location</span>
<span class="sd">        |  Identify the variables that have to be changed</span>
<span class="sd">        |  Replace the variables with unique identifiers and save the file</span>
<span class="sd">        :param pfile_path: File path of the file that will be edited</span>
<span class="sd">        :type pfile_path: string</span>
<span class="sd">        :param pdict_data_dictionary: Dictionary in the format of {&#39;unique_identifiers1&#39;: &#39;actual_value1&#39;,&#39;unique_identifiers2&#39;: &#39; actual_value2&#39;}</span>
<span class="sd">        :type pdict_data_dictionary: dictionary</span>
<span class="sd">        :param pstr_key: key in case the query is saved in a json file</span>
<span class="sd">        :type pstr_key: kwargs</span>
<span class="sd">        :return: str_query : The query containing the actual value with the unique_Identifiers replaced</span>
<span class="sd">        :type str_query: string</span>
<span class="sd">            Examples:</span>
<span class="sd">        |  1. Let us imagine we have a sql file or a text file containing query</span>
<span class="sd">        |  Values that have to changed ; Replace them by Unique_Idetifiers : pstr_emailaddress , pstr_updoperation</span>
<span class="sd">        |  Actual Values :saurabhpiyush@spglobal.com , 1</span>
<span class="sd">        |  pdict_data_dictionary = { &quot;pstr_emailaddress&quot; : &quot;saurabhpiyush@spglobal.com&quot;,&quot;pstr_updoperation&quot; : &quot;1&quot;}</span>
<span class="sd">        |  Input call : modify_sql_query (pfile_path, pdict_data_dictionary)</span>
<span class="sd">        |  2. Let us imagine we have a sql query in a json format : {&quot;key1&quot; :&quot;query1&quot;,&quot;key2&quot; :&quot;query2&quot;}</span>
<span class="sd">        |  Query that has to be edited : query2</span>
<span class="sd">        |  Key Selected for query2 = key2</span>
<span class="sd">        |  pstr_key = key2</span>
<span class="sd">        |  Input call :  modify_sql_query (pfile_path, pdict_data_dictionary, pstr_key = &#39;key2&#39; )</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pfile_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_filepath</span><span class="p">()</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="n">pfile_path</span><span class="p">)</span><span class="o">.</span><span class="n">st_size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_query</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">pdict_data_dictionary</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Dictionary passed is None. There is nothing to replace&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">pfile_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;.sql&#39;</span><span class="p">,</span> <span class="s1">&#39;.txt&#39;</span><span class="p">)):</span>
                <span class="n">str_query</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">pfile_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                        <span class="n">str_query</span> <span class="o">=</span> <span class="n">str_query</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">line</span>
                <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

            <span class="k">elif</span> <span class="n">pfile_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.json&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pstr_key&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">json_key</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pstr_key&#39;</span><span class="p">))</span>
                    <span class="n">f1</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">pfile_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
                    <span class="n">str_json</span> <span class="o">=</span> <span class="n">f1</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
                    <span class="n">f1</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">pstr_json</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">str_json</span><span class="p">)</span>
                        <span class="n">str_query</span> <span class="o">=</span> <span class="n">pstr_json</span><span class="p">[</span><span class="n">json_key</span><span class="p">]</span>
                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Not a valid json file or invalid key---&gt;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Error--&gt;Key missing from parameters for json file&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Accepted file formats are .sql, .txt &amp; .json&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">pdict_data_dictionary</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">str_query</span><span class="p">:</span>
                    <span class="n">str_query</span> <span class="o">=</span> <span class="n">str_query</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">pdict_data_dictionary</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Unique Identifier--&gt;&#39;</span> <span class="o">+</span> <span class="n">key</span> <span class="o">+</span> <span class="s1">&#39;not found in the query&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">str_query</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span>
                <span class="n">pstr_message</span><span class="o">=</span><span class="s1">&#39;Exception occured in method--&gt; modify_sql_query--&gt;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">pbool_insert_kibana</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">pbool_trim_log</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pbool_log_local_exceptions</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">pbool_fail_on_exception</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">pbool_use_pytest_format</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="cafex_db.database_handler.DatabaseHandler.__difference_formatter" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__difference_formatter</span><span class="p">(</span><span class="n">df_source_target</span><span class="p">,</span> <span class="n">df_target_source</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">



<details class="description" open>
  <summary>Description</summary>
  <p>| This method is for more focused difference between two dataframes</p>
</details>        <p>:param diff1:
:param diff2:
:return:</p>

            <details class="quote">
              <summary>Source code in <code>cafex_db\database_handler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">__difference_formatter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df_source_target</span><span class="p">,</span> <span class="n">df_target_source</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Description:</span>
<span class="sd">        | This method is for more focused difference between two dataframes</span>
<span class="sd">    :param diff1:</span>
<span class="sd">    :param diff2:</span>
<span class="sd">    :return:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">list_source_headers</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;plist_source_headers&quot;</span><span class="p">)</span>
        <span class="n">list_target_headers</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;plist_target_headers&quot;</span><span class="p">)</span>
        <span class="n">dict_primary_keys</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pdict_primary_keys&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">list_source_headers</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">list_target_headers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;case of no special headers given&quot;</span><span class="p">)</span>
        <span class="n">list_source_primary_keys</span> <span class="o">=</span> <span class="n">dict_primary_keys</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;source&#39;</span><span class="p">)</span>
        <span class="n">list_target_primary_keys</span> <span class="o">=</span> <span class="n">dict_primary_keys</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;target&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_source_primary_keys</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_target_primary_keys</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The number of primary keys for Source and Target are not same&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_source_primary_keys</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Only one primary key is allowed&quot;</span><span class="p">)</span>

        <span class="c1"># Arranging the list according to the primary key</span>
        <span class="k">for</span> <span class="n">source_val</span> <span class="ow">in</span> <span class="n">list_source_primary_keys</span><span class="p">:</span>
            <span class="n">list_source_headers</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">source_val</span><span class="p">)</span>
        <span class="n">list_sorted_source_headers</span> <span class="o">=</span> <span class="n">list_source_primary_keys</span> <span class="o">+</span> <span class="n">list_source_headers</span>

        <span class="k">for</span> <span class="n">target_val</span> <span class="ow">in</span> <span class="n">list_target_primary_keys</span><span class="p">:</span>
            <span class="n">list_target_headers</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">target_val</span><span class="p">)</span>
        <span class="n">list_sorted_target_headers</span> <span class="o">=</span> <span class="n">list_target_primary_keys</span> <span class="o">+</span> <span class="n">list_target_headers</span>

        <span class="n">source_row_count</span><span class="p">,</span> <span class="n">source_column_count</span> <span class="o">=</span> <span class="n">df_source_target</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">target_row_count</span><span class="p">,</span> <span class="n">source_column_count</span> <span class="o">=</span> <span class="n">df_target_source</span><span class="o">.</span><span class="n">shape</span>

        <span class="n">df_source_target</span> <span class="o">=</span> <span class="n">df_source_target</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s1">&#39;source_&#39;</span><span class="p">)</span>
        <span class="n">df_target_source</span> <span class="o">=</span> <span class="n">df_target_source</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s1">&#39;target_&#39;</span><span class="p">)</span>

        <span class="n">temp_list_full</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">list_full</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_sorted_target_headers</span><span class="p">)):</span>
            <span class="n">list_full</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;source_&quot;</span> <span class="o">+</span> <span class="n">list_sorted_source_headers</span><span class="p">[</span><span class="n">count</span><span class="p">])</span>
            <span class="n">list_full</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;target_&quot;</span> <span class="o">+</span> <span class="n">list_sorted_target_headers</span><span class="p">[</span><span class="n">count</span><span class="p">])</span>

        <span class="c1"># dataframe_final = pd.DataFrame(columns=list_full)</span>
        <span class="n">whole_data_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">sr_count</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">source_row_count</span><span class="p">):</span>
            <span class="n">temp_value</span> <span class="o">=</span> <span class="n">df_source_target</span><span class="p">[</span><span class="s2">&quot;source_&quot;</span> <span class="o">+</span> <span class="n">list_source_primary_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">sr_count</span><span class="p">]</span>
            <span class="n">temp_source_series</span> <span class="o">=</span> <span class="n">df_source_target</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">sr_count</span><span class="p">]</span>
            <span class="n">temp_target_series</span> <span class="o">=</span> <span class="n">df_target_source</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
                <span class="n">df_target_source</span><span class="p">[</span><span class="s2">&quot;target_&quot;</span> <span class="o">+</span> <span class="n">list_target_primary_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">==</span> <span class="n">temp_value</span><span class="p">]</span>
            <span class="n">df_target_source</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span>
                <span class="n">df_target_source</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_target_source</span><span class="p">[</span><span class="s2">&quot;target_&quot;</span> <span class="o">+</span> <span class="n">list_target_primary_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">==</span> <span class="n">temp_value</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">temp_data</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">header_val</span> <span class="ow">in</span> <span class="n">list_full</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">header_val</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;target_&quot;</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">temp_target_series</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                        <span class="n">temp_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">temp_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_target_series</span><span class="p">[</span><span class="n">header_val</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># fix here</span>
                    <span class="n">temp_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_source_series</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">header_val</span><span class="p">))</span>
            <span class="n">whole_data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_data</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">sr_count</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">target_row_count</span><span class="p">):</span>
            <span class="c1"># temp_value = df_target_source[&quot;target_&quot;+list_target_primary_keys[0]][sr_count]</span>
            <span class="n">temp_data</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">list_full</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">val</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;source_&quot;</span><span class="p">):</span>
                    <span class="n">temp_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">temp_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_target_source</span><span class="p">[</span><span class="n">val</span><span class="p">][</span><span class="n">sr_count</span><span class="p">])</span>
            <span class="n">whole_data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_data</span><span class="p">)</span>

        <span class="n">dataframe_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">whole_data_list</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">list_full</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dataframe_final</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cafex_db.database_handler.DatabaseHandler.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Initializes the class and creates a DBSecurity instance.</p>

            <details class="quote">
              <summary>Source code in <code>cafex_db\database_handler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">      Initializes the class and creates a DBSecurity instance.</span>
<span class="sd">      &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_decrytor</span> <span class="o">=</span> <span class="n">DBSecurity</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cafex_db.database_handler.DatabaseHandler.cassandra" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">cassandra</span><span class="p">(</span><span class="n">pstr_server_name</span><span class="p">,</span> <span class="n">pstr_database_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">



<details class="description" open>
  <summary>Description</summary>
  <p>|  This method deals with creating a connection to cassandra database</p>
</details>        <p>:return: Database Connection Object</p>
<p>.. notes::
        |  For input parameters, refer to the method description of create_db_connection</p>

            <details class="quote">
              <summary>Source code in <code>cafex_db\database_handler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">cassandra</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pstr_server_name</span><span class="p">,</span> <span class="n">pstr_database_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Description:</span>
<span class="sd">        |  This method deals with creating a connection to cassandra database</span>

<span class="sd">    :return: Database Connection Object</span>

<span class="sd">    .. notes::</span>
<span class="sd">    	|  For input parameters, refer to the method description of create_db_connection</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">cassandra_connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_decrytor</span><span class="o">.</span><span class="n">cassandra</span><span class="p">(</span><span class="n">pstr_server_name</span><span class="p">,</span> <span class="n">pstr_database_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cassandra_connection</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cafex_db.database_handler.DatabaseHandler.cassandra_resultset_to_list" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">cassandra_resultset_to_list</span><span class="p">(</span><span class="n">prs_cassandra_resultset</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">



<details class="description" open>
  <summary>Description</summary>
  <p>|  This method returns the headers and all the row values in a cassandra-driver resultset.</p>
</details>        <p>:param prs_cassandra_resultset: This is a cassandra-driver resultset
:type prs_cassandra_resultset: Cassandra Resultset Object</p>
<p>:return: List</p>
<p>.. notes::
    |  First index of the list will contain the column headers and the rest will have row values.</p>
<p>.. warning::
    |  Only pass cassandra-driver resultset object to this method.</p>

            <details class="quote">
              <summary>Source code in <code>cafex_db\database_handler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">cassandra_resultset_to_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prs_cassandra_resultset</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Description:</span>
<span class="sd">        |  This method returns the headers and all the row values in a cassandra-driver resultset.</span>

<span class="sd">    :param prs_cassandra_resultset: This is a cassandra-driver resultset</span>
<span class="sd">    :type prs_cassandra_resultset: Cassandra Resultset Object</span>


<span class="sd">    :return: List</span>

<span class="sd">    .. notes::</span>
<span class="sd">        |  First index of the list will contain the column headers and the rest will have row values.</span>


<span class="sd">    .. warning::</span>
<span class="sd">        |  Only pass cassandra-driver resultset object to this method.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">prs_cassandra_resultset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_resultset</span><span class="p">()</span>

        <span class="n">list_rs_column_names</span> <span class="o">=</span> <span class="n">prs_cassandra_resultset</span><span class="o">.</span><span class="n">column_names</span>
        <span class="n">list_rs_values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">list_rs_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">list_rs_column_names</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">prs_cassandra_resultset</span><span class="p">:</span>
            <span class="n">list_rs_values</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">val</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">row</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">list_rs_values</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cafex_db.database_handler.DatabaseHandler.check_data_in_column" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_data_in_column</span><span class="p">(</span><span class="n">plist_resultlist</span><span class="p">,</span> <span class="n">pdata_value</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">



<details class="description" open>
  <summary>Description</summary>
  <p>|  This method verifies if the value is present in the resultlist or not.
|  It supports
|      1. Check if value is available in a particular column
|      2. Check if the value is present in multiple columns
|      3. Check if the value is present in the resultlist irrespective of column name, just check if it exist or not
|</p>
</details>        <p>:param plist_resultlist:
:type plist_resultlist: Result List
:param pdata_column_header:
:type pdata_column_header: Can be Int/String/Float/Datetime</p>
<p>:return: bool/list of difference
.. note::
        |  Donot use this method directly into your code, please use the verify and assert method of assertion-datbase class</p>

            <details class="quote">
              <summary>Source code in <code>cafex_db\database_handler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_data_in_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plist_resultlist</span><span class="p">,</span> <span class="n">pdata_value</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Description:</span>
<span class="sd">        |  This method verifies if the value is present in the resultlist or not.</span>
<span class="sd">        |  It supports</span>
<span class="sd">        |      1. Check if value is available in a particular column</span>
<span class="sd">        |      2. Check if the value is present in multiple columns</span>
<span class="sd">        |      3. Check if the value is present in the resultlist irrespective of column name, just check if it exist or not</span>
<span class="sd">        |</span>


<span class="sd">    :param plist_resultlist:</span>
<span class="sd">    :type plist_resultlist: Result List</span>
<span class="sd">    :param pdata_column_header:</span>
<span class="sd">    :type pdata_column_header: Can be Int/String/Float/Datetime</span>


<span class="sd">    :return: bool/list of difference</span>
<span class="sd">    .. note::</span>
<span class="sd">        	|  Donot use this method directly into your code, please use the verify and assert method of assertion-datbase class</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>

        <span class="n">bool_ignore_case</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pbool_ignore_case&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">list_headers</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plist_headers&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">int_count</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pint_count&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">list_resultset_data</span> <span class="o">=</span> <span class="n">plist_resultlist</span>
        <span class="n">int_resultset_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_resultset_data</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">list_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_headers</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">df_resultset_dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">list_resultset_data</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">int_resultset_length</span><span class="p">],</span>
                                                      <span class="n">columns</span><span class="o">=</span><span class="n">list_resultset_data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">columns</span> <span class="o">=</span> <span class="n">list_headers</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The headers list should not be empty&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df_resultset_dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">list_resultset_data</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">int_resultset_length</span><span class="p">])</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="n">df_resultset_dataframe</span><span class="o">.</span><span class="n">columns</span>

        <span class="k">if</span> <span class="n">int_count</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">list_headers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">cols</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">pdata_value</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">]):</span>
                            <span class="k">return</span> <span class="kc">True</span>
                    <span class="k">if</span> <span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;i&#39;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">pdata_value</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">]):</span>
                            <span class="k">return</span> <span class="kc">True</span>
                    <span class="k">if</span> <span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span>
                        <span class="n">list_temp_col_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">])]</span>
                        <span class="k">if</span> <span class="n">bool_ignore_case</span><span class="p">:</span>
                            <span class="n">list_col_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">list_temp_col_data</span><span class="p">]</span>
                            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">pdata_value</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span> <span class="ow">in</span> <span class="n">list_col_data</span><span class="p">:</span>
                                <span class="k">return</span> <span class="kc">True</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">pdata_value</span><span class="p">)</span> <span class="ow">in</span> <span class="n">list_temp_col_data</span><span class="p">:</span>
                                <span class="k">return</span> <span class="kc">True</span>
                    <span class="k">if</span> <span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;M&#39;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">pdata_value</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">]):</span>
                            <span class="k">return</span> <span class="kc">True</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dict_individual_check</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">list_unmatched_headers</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">cols</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
                    <span class="n">int_fetch_count</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">if</span> <span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span>
                        <span class="n">int_fetch_count</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">(</span>
                            <span class="nb">float</span><span class="p">(</span><span class="n">pdata_value</span><span class="p">))</span> <span class="o">+</span> <span class="n">int_fetch_count</span>
                    <span class="k">if</span> <span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;i&#39;</span><span class="p">:</span>
                        <span class="n">int_fetch_count</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">(</span>
                            <span class="nb">int</span><span class="p">(</span><span class="n">pdata_value</span><span class="p">))</span> <span class="o">+</span> <span class="n">int_fetch_count</span>
                    <span class="k">if</span> <span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span>
                        <span class="n">list_temp_col_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">])]</span>
                        <span class="k">if</span> <span class="n">bool_ignore_case</span><span class="p">:</span>
                            <span class="n">list_col_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">list_temp_col_data</span><span class="p">]</span>
                            <span class="n">int_fetch_count</span> <span class="o">=</span> <span class="n">list_col_data</span><span class="o">.</span><span class="n">count</span><span class="p">(</span>
                                <span class="nb">str</span><span class="p">(</span><span class="n">pdata_value</span><span class="p">))</span> <span class="o">+</span> <span class="n">int_fetch_count</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">int_fetch_count</span> <span class="o">=</span> <span class="n">list_temp_col_data</span><span class="o">.</span><span class="n">count</span><span class="p">(</span>
                                <span class="nb">str</span><span class="p">(</span><span class="n">pdata_value</span><span class="p">))</span> <span class="o">+</span> <span class="n">int_fetch_count</span>
                    <span class="k">if</span> <span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;M&#39;</span><span class="p">:</span>
                        <span class="n">int_fetch_count</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">(</span>
                            <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">pdata_value</span><span class="p">))</span> <span class="o">+</span> <span class="n">int_fetch_count</span>
                    <span class="c1"># dict_individual_check[cols] = int_fetch_count</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">int_fetch_count</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">list_unmatched_headers</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">int_fetch_count</span>

                <span class="k">return</span> <span class="n">list_unmatched_headers</span>

        <span class="c1"># code logic for count based comparison</span>
        <span class="k">elif</span> <span class="n">int_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">list_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># dict_individual_check = {}</span>
                <span class="n">list_unmatched_headers</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">cols</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
                    <span class="n">int_fetch_count</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">if</span> <span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span>
                        <span class="n">int_fetch_count</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">(</span>
                            <span class="nb">float</span><span class="p">(</span><span class="n">pdata_value</span><span class="p">))</span> <span class="o">+</span> <span class="n">int_fetch_count</span>
                    <span class="k">if</span> <span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;i&#39;</span><span class="p">:</span>
                        <span class="n">int_fetch_count</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">(</span>
                            <span class="nb">int</span><span class="p">(</span><span class="n">pdata_value</span><span class="p">))</span> <span class="o">+</span> <span class="n">int_fetch_count</span>
                    <span class="k">if</span> <span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span>
                        <span class="n">list_temp_col_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">])]</span>
                        <span class="k">if</span> <span class="n">bool_ignore_case</span><span class="p">:</span>
                            <span class="n">list_col_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">list_temp_col_data</span><span class="p">]</span>
                            <span class="n">int_fetch_count</span> <span class="o">=</span> <span class="n">list_col_data</span><span class="o">.</span><span class="n">count</span><span class="p">(</span>
                                <span class="nb">str</span><span class="p">(</span><span class="n">pdata_value</span><span class="p">))</span> <span class="o">+</span> <span class="n">int_fetch_count</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">int_fetch_count</span> <span class="o">=</span> <span class="n">list_temp_col_data</span><span class="o">.</span><span class="n">count</span><span class="p">(</span>
                                <span class="nb">str</span><span class="p">(</span><span class="n">pdata_value</span><span class="p">))</span> <span class="o">+</span> <span class="n">int_fetch_count</span>
                    <span class="k">if</span> <span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;M&#39;</span><span class="p">:</span>
                        <span class="n">int_fetch_count</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">(</span>
                            <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">pdata_value</span><span class="p">))</span> <span class="o">+</span> <span class="n">int_fetch_count</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">int_fetch_count</span> <span class="o">==</span> <span class="n">int_count</span><span class="p">:</span>
                        <span class="n">list_unmatched_headers</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">int_fetch_count</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_unmatched_headers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">list_unmatched_headers</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">int_fetch_count</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">cols</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span>
                        <span class="n">int_fetch_count</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">(</span>
                            <span class="nb">float</span><span class="p">(</span><span class="n">pdata_value</span><span class="p">))</span> <span class="o">+</span> <span class="n">int_fetch_count</span>
                    <span class="k">if</span> <span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;i&#39;</span><span class="p">:</span>
                        <span class="n">int_fetch_count</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">(</span>
                            <span class="nb">int</span><span class="p">(</span><span class="n">pdata_value</span><span class="p">))</span> <span class="o">+</span> <span class="n">int_fetch_count</span>
                    <span class="k">if</span> <span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span>
                        <span class="n">list_temp_col_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">])]</span>
                        <span class="k">if</span> <span class="n">bool_ignore_case</span><span class="p">:</span>
                            <span class="n">list_col_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">list_temp_col_data</span><span class="p">]</span>
                            <span class="n">int_fetch_count</span> <span class="o">=</span> <span class="n">list_col_data</span><span class="o">.</span><span class="n">count</span><span class="p">(</span>
                                <span class="nb">str</span><span class="p">(</span><span class="n">pdata_value</span><span class="p">))</span> <span class="o">+</span> <span class="n">int_fetch_count</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">int_fetch_count</span> <span class="o">=</span> <span class="n">list_temp_col_data</span><span class="o">.</span><span class="n">count</span><span class="p">(</span>
                                <span class="nb">str</span><span class="p">(</span><span class="n">pdata_value</span><span class="p">))</span> <span class="o">+</span> <span class="n">int_fetch_count</span>

                    <span class="k">if</span> <span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;M&#39;</span><span class="p">:</span>
                        <span class="n">int_fetch_count</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_resultset_dataframe</span><span class="p">[</span><span class="n">cols</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">(</span>
                            <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">pdata_value</span><span class="p">))</span> <span class="o">+</span> <span class="n">int_fetch_count</span>

                <span class="k">if</span> <span class="n">int_fetch_count</span> <span class="o">==</span> <span class="n">int_count</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;the pint_count if specified must have positive value&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cafex_db.database_handler.DatabaseHandler.check_db_exists" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_db_exists</span><span class="p">(</span><span class="n">pobject_connection</span><span class="p">,</span> <span class="n">pstr_database_name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">



<details class="description" open>
  <summary>Description</summary>
  <p>|  This method is used to verify the existence of DB in particular DB Server</p>
</details>        <p>:param pobject_connection: This parameter contains the connection object provided by the user
:type pobject_connection: Object
:param pstr_database_name: This parameter contains the DB name provided by the user
:type pstr_database_name: string</p>
<p>:return: bool</p>


<p><span class="doc-section-title">Examples:</span></p>
    <p>| check_db_exists(connection, database_name)</p>
        <p>.. warning::
    |  This method currently supports SQL Server, PostgreSQL and Oracle DB Servers.</p>

            <details class="quote">
              <summary>Source code in <code>cafex_db\database_handler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_db_exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pobject_connection</span><span class="p">,</span> <span class="n">pstr_database_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Description:</span>
<span class="sd">        |  This method is used to verify the existence of DB in particular DB Server</span>

<span class="sd">    :param pobject_connection: This parameter contains the connection object provided by the user</span>
<span class="sd">    :type pobject_connection: Object</span>
<span class="sd">    :param pstr_database_name: This parameter contains the DB name provided by the user</span>
<span class="sd">    :type pstr_database_name: string</span>

<span class="sd">    :return: bool</span>

<span class="sd">    Examples:</span>
<span class="sd">        | check_db_exists(connection, database_name)</span>
<span class="sd">    .. warning::</span>
<span class="sd">        |  This method currently supports SQL Server, PostgreSQL and Oracle DB Servers.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">pobject_connection</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_database_object</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">pstr_database_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_database_name</span><span class="p">()</span>

        <span class="n">bln_is_database_exists</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">pobject_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;postgresql&#39;</span><span class="p">):</span>
            <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobject_connection</span><span class="p">,</span>
                                                  <span class="s2">&quot;SELECT * FROM pg_catalog.pg_database WHERE datname=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_database_name</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                                  <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">rs_resultset</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">bln_is_database_exists</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">bln_is_database_exists</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">elif</span> <span class="p">(</span><span class="n">pobject_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;mssql&#39;</span><span class="p">):</span>
            <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobject_connection</span><span class="p">,</span>
                                                  <span class="s2">&quot;select * from sys.databases where name=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_database_name</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                                  <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">rs_resultset</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">bln_is_database_exists</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">bln_is_database_exists</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">elif</span> <span class="p">(</span><span class="n">pobject_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;oracle&#39;</span><span class="p">):</span>
            <span class="n">lst_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobject_connection</span><span class="p">,</span>
                                                <span class="s2">&quot;SELECT owner FROM all_tab_columns where Owner =&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_database_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                                <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;list&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">lst_result</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">):</span>
                <span class="n">bln_is_database_exists</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">bln_is_database_exists</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_custom_exception</span><span class="p">(</span>
                <span class="n">pstr_message</span><span class="o">=</span><span class="s2">&quot;Error -&gt; Provided parameters are not supported&quot;</span><span class="p">,</span>
                <span class="n">pbool_fail_on_exception</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">bln_is_database_exists</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span>
            <span class="n">pstr_message</span><span class="o">=</span><span class="s2">&quot;Error -&gt; DB not connected properly&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
            <span class="n">pbool_insert_kibana</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">pbool_trim_log</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pbool_log_local_exceptions</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">pbool_fail_on_exception</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">pbool_use_pytest_format</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cafex_db.database_handler.DatabaseHandler.check_headers_in_resultlist" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_headers_in_resultlist</span><span class="p">(</span><span class="n">plist_resultlist</span><span class="p">,</span> <span class="n">plist_headers</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">



<details class="description" open>
  <summary>Description</summary>
  <p>|   This method is for verifying whether the headers are available in the resultlist or not
|   The resultlist that will be passed in this method should be the one that is returned by the execute_statement method</p>
</details>        <p>:param plist_resultlist: resultlist generated by execute_statement
:param plist_headers:  list of headers to check if available or not
:return: invalid match list</p>
<p>.. note::
    |  Donot use this method directly into your code, please use the verify and assert method of assertion-datbase class</p>

            <details class="quote">
              <summary>Source code in <code>cafex_db\database_handler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_headers_in_resultlist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plist_resultlist</span><span class="p">,</span> <span class="n">plist_headers</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Description:</span>
<span class="sd">        |   This method is for verifying whether the headers are available in the resultlist or not</span>
<span class="sd">        |   The resultlist that will be passed in this method should be the one that is returned by the execute_statement method</span>
<span class="sd">    :param plist_resultlist: resultlist generated by execute_statement</span>
<span class="sd">    :param plist_headers:  list of headers to check if available or not</span>
<span class="sd">    :return: invalid match list</span>

<span class="sd">    .. note::</span>
<span class="sd">        |  Donot use this method directly into your code, please use the verify and assert method of assertion-datbase class</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">bool_ignore_case</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pbool_ignore_case&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">list_source_headers</span> <span class="o">=</span> <span class="n">plist_resultlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">list_headers</span> <span class="o">=</span> <span class="n">plist_headers</span>
        <span class="n">list_diff</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">bool_ignore_case</span><span class="p">:</span>
            <span class="n">list_source_headers</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">list_source_headers</span><span class="p">]</span>
            <span class="n">list_headers</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">list_headers</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_source_headers</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_headers</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The list_source_headers contains more headers than the resultlist one&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">list_headers</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">val</span> <span class="ow">in</span> <span class="n">list_source_headers</span><span class="p">):</span>
                <span class="n">list_diff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">list_diff</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">e</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cafex_db.database_handler.DatabaseHandler.check_table_exists" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_table_exists</span><span class="p">(</span><span class="n">pobject_connection</span><span class="p">,</span> <span class="n">pstr_database_name</span><span class="p">,</span> <span class="n">pstr_table_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">



<details class="description" open>
  <summary>Description</summary>
  <p>|  This method check if a table exists in a database.</p>
</details>        <p>:param pobject_connection:
:type pobject_connection: Database Connection Object
:param pstr_database_name:
:type pstr_database_name: String
:param pstr_table_name:
:type pstr_table_name: String</p>
<p>:return: Boolean</p>
<p>.. warning::
    |  The method does not support HIVE right now.</p>

            <details class="quote">
              <summary>Source code in <code>cafex_db\database_handler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_table_exists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pobject_connection</span><span class="p">,</span> <span class="n">pstr_database_name</span><span class="p">,</span> <span class="n">pstr_table_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Description:</span>
<span class="sd">        |  This method check if a table exists in a database.</span>

<span class="sd">    :param pobject_connection:</span>
<span class="sd">    :type pobject_connection: Database Connection Object</span>
<span class="sd">    :param pstr_database_name:</span>
<span class="sd">    :type pstr_database_name: String</span>
<span class="sd">    :param pstr_table_name:</span>
<span class="sd">    :type pstr_table_name: String</span>


<span class="sd">    :return: Boolean</span>

<span class="sd">    .. warning::</span>
<span class="sd">        |  The method does not support HIVE right now.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">pobject_connection</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_database_object</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">pstr_database_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_database_name</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">pstr_table_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_table_name</span><span class="p">()</span>

        <span class="n">str_schema</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pstr_schema&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">bln_is_table_exists</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="s1">&#39;cassandra&#39;</span> <span class="ow">in</span> <span class="nb">repr</span><span class="p">(</span><span class="n">pobject_connection</span><span class="p">):</span>
            <span class="n">temp_engine</span> <span class="o">=</span> <span class="n">pobject_connection</span><span class="o">.</span><span class="n">cluster</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">pstr_database_name</span><span class="p">)</span>
            <span class="n">rs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">temp_engine</span><span class="p">,</span>
                                        <span class="s2">&quot;SELECT table_name FROM system_schema.tables WHERE keyspace_name=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_database_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; and table_name=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span> <span class="o">+</span> <span class="s2">&quot;&#39;;&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">bln_is_table_exists</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">bln_is_table_exists</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">elif</span> <span class="nb">any</span><span class="p">(</span><span class="n">s</span> <span class="ow">in</span> <span class="nb">repr</span><span class="p">(</span><span class="n">pobject_connection</span><span class="o">.</span><span class="n">dialect</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;mssql&#39;</span><span class="p">,</span> <span class="s1">&#39;postgres&#39;</span><span class="p">)):</span>
            <span class="n">pobject_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">url</span><span class="o">.</span><span class="n">database</span> <span class="o">=</span> <span class="n">pstr_database_name</span>
            <span class="n">temp_engine</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="n">pobject_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">str_schema</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">bln_is_table_exists</span> <span class="o">=</span> <span class="n">temp_engine</span><span class="o">.</span><span class="n">dialect</span><span class="o">.</span><span class="n">has_table</span><span class="p">(</span><span class="n">temp_engine</span><span class="p">,</span> <span class="n">pstr_table_name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">bln_is_table_exists</span> <span class="o">=</span> <span class="n">temp_engine</span><span class="o">.</span><span class="n">dialect</span><span class="o">.</span><span class="n">has_table</span><span class="p">(</span><span class="n">temp_engine</span><span class="p">,</span> <span class="n">pstr_table_name</span><span class="p">,</span>
                                                                    <span class="n">schema</span><span class="o">=</span><span class="n">str_schema</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">any</span><span class="p">(</span><span class="n">s</span> <span class="ow">in</span> <span class="nb">repr</span><span class="p">(</span><span class="n">pobject_connection</span><span class="o">.</span><span class="n">dialect</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;oracle&#39;</span><span class="p">)):</span>
            <span class="n">bln_is_table_exists</span> <span class="o">=</span> <span class="n">pobject_connection</span><span class="o">.</span><span class="n">dialect</span><span class="o">.</span><span class="n">has_table</span><span class="p">(</span><span class="n">pobject_connection</span><span class="p">,</span> <span class="n">pstr_table_name</span><span class="p">,</span>
                                                                       <span class="n">schema</span><span class="o">=</span><span class="n">pstr_database_name</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">bln_is_table_exists</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cafex_db.database_handler.DatabaseHandler.check_value_exists_in_column" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_value_exists_in_column</span><span class="p">(</span><span class="n">plist_resultlist</span><span class="p">,</span> <span class="n">pstr_column_header</span><span class="p">,</span> <span class="n">pstr_value</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">



<details class="description" open>
  <summary>Description</summary>
  <p>|  This method returns True if a value exists under a column header, otherwise returns False.</p>
</details>        <p>:param plist_resultlist:
:type plist_resultlist: Result List
:param pstr_column_header:
:type pstr_header: String
:param pstr_value:
:type pstr_value: String</p>
<p>:return: Boolean</p>

            <details class="quote">
              <summary>Source code in <code>cafex_db\database_handler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_value_exists_in_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plist_resultlist</span><span class="p">,</span> <span class="n">pstr_column_header</span><span class="p">,</span> <span class="n">pstr_value</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Description:</span>
<span class="sd">        |  This method returns True if a value exists under a column header, otherwise returns False.</span>

<span class="sd">    :param plist_resultlist:</span>
<span class="sd">    :type plist_resultlist: Result List</span>
<span class="sd">    :param pstr_column_header:</span>
<span class="sd">    :type pstr_header: String</span>
<span class="sd">    :param pstr_value:</span>
<span class="sd">    :type pstr_value: String</span>


<span class="sd">    :return: Boolean</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">plist_resultlist</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_resultlist</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">pstr_column_header</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_column_header</span><span class="p">()</span>

        <span class="n">list_coldata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_column_data</span><span class="p">(</span><span class="n">plist_resultlist</span><span class="p">,</span> <span class="n">pstr_column_header</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pstr_value</span> <span class="ow">in</span> <span class="n">list_coldata</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cafex_db.database_handler.DatabaseHandler.check_value_not_exists_in_column" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_value_not_exists_in_column</span><span class="p">(</span><span class="n">plist_resultlist</span><span class="p">,</span> <span class="n">pstr_column_header</span><span class="p">,</span> <span class="n">pstr_value</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">



<details class="description" open>
  <summary>Description</summary>
  <p>|  This method returns True if a value does not exists under a column header, otherwise returns False.</p>
</details>        <p>:param plist_resultlist:
:type plist_resultlist: Result List
:param pstr_column_header:
:type pstr_header: String
:param pstr_value:
:type pstr_value: String</p>
<p>:return: Boolean</p>

            <details class="quote">
              <summary>Source code in <code>cafex_db\database_handler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_value_not_exists_in_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plist_resultlist</span><span class="p">,</span> <span class="n">pstr_column_header</span><span class="p">,</span> <span class="n">pstr_value</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Description:</span>
<span class="sd">        |  This method returns True if a value does not exists under a column header, otherwise returns False.</span>

<span class="sd">    :param plist_resultlist:</span>
<span class="sd">    :type plist_resultlist: Result List</span>
<span class="sd">    :param pstr_column_header:</span>
<span class="sd">    :type pstr_header: String</span>
<span class="sd">    :param pstr_value:</span>
<span class="sd">    :type pstr_value: String</span>


<span class="sd">    :return: Boolean</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">plist_resultlist</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_resultlist</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">pstr_column_header</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_column_header</span><span class="p">()</span>

        <span class="n">list_coldata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_column_data</span><span class="p">(</span><span class="n">plist_resultlist</span><span class="p">,</span> <span class="n">pstr_column_header</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pstr_value</span> <span class="ow">in</span> <span class="n">list_coldata</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cafex_db.database_handler.DatabaseHandler.close" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">close</span><span class="p">(</span><span class="n">pobject_connection</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">



<details class="description" open>
  <summary>Description</summary>
  <p>|  This method closes the database connection.</p>
</details>        <p>:param pobject_connection:
:type pobject_connection: Database Connection Object</p>

            <details class="quote">
              <summary>Source code in <code>cafex_db\database_handler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pobject_connection</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Description:</span>
<span class="sd">    	|  This method closes the database connection.</span>

<span class="sd">    :param pobject_connection:</span>
<span class="sd">    :type pobject_connection: Database Connection Object</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">pobject_connection</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_database_object</span><span class="p">()</span>

        <span class="k">if</span> <span class="s1">&#39;cassandra&#39;</span> <span class="ow">in</span> <span class="nb">repr</span><span class="p">(</span><span class="n">pobject_connection</span><span class="p">):</span>
            <span class="n">pobject_connection</span><span class="o">.</span><span class="n">cluster</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
        <span class="k">elif</span> <span class="s1">&#39;paramiko&#39;</span> <span class="ow">in</span> <span class="nb">repr</span><span class="p">(</span><span class="n">pobject_connection</span><span class="p">):</span>
            <span class="n">pobject_connection</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">any</span><span class="p">(</span><span class="n">s</span> <span class="ow">in</span> <span class="nb">repr</span><span class="p">(</span><span class="n">pobject_connection</span><span class="o">.</span><span class="n">dialect</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;mssql&#39;</span><span class="p">,</span> <span class="s1">&#39;postgres&#39;</span><span class="p">,</span> <span class="s1">&#39;oracle&#39;</span><span class="p">)):</span>
            <span class="n">pobject_connection</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;The connection &quot;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">pobject_connection</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;is closed&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cafex_db.database_handler.DatabaseHandler.compare_dataframes_distinct" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compare_dataframes_distinct</span><span class="p">(</span><span class="n">pdf_dataframe_source</span><span class="p">,</span> <span class="n">pdf_dataframe_target</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>.. warning::
        |  DO NOT try to call this method directly, this is a helper method for compare_resultlists()</p>

            <details class="quote">
              <summary>Source code in <code>cafex_db\database_handler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compare_dataframes_distinct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdf_dataframe_source</span><span class="p">,</span> <span class="n">pdf_dataframe_target</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    .. warning::</span>
<span class="sd">    	|  DO NOT try to call this method directly, this is a helper method for compare_resultlists()</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">list_headers</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plist_headers&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">list_headers_source</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plist_headers_source&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">list_headers_target</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plist_headers_target&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">int_rowcount</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pint_rowcount&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">pstr_compare_mode</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pstr_compare_mode&#39;</span><span class="p">,</span> <span class="s1">&#39;header&#39;</span><span class="p">)</span>
        <span class="n">pbool_get_common</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pbool_get_common&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">bool_ignore_datatype</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pbool_ignore_datatype&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">bool_club</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pbool_club&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">dict_primary_keys</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pdict_primary_keys&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pstr_compare_mode</span> <span class="o">==</span> <span class="s1">&#39;header&#39;</span><span class="p">:</span>
            <span class="n">list_source_headers</span> <span class="o">=</span> <span class="n">pdf_dataframe_source</span><span class="o">.</span><span class="n">columns</span>

        <span class="k">if</span> <span class="n">int_rowcount</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">df_dataframe_source</span> <span class="o">=</span> <span class="n">pdf_dataframe_source</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">int_rowcount</span><span class="p">)</span>
            <span class="n">df_dataframe_target</span> <span class="o">=</span> <span class="n">pdf_dataframe_target</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">int_rowcount</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df_dataframe_source</span> <span class="o">=</span> <span class="n">pdf_dataframe_source</span>
            <span class="n">df_dataframe_target</span> <span class="o">=</span> <span class="n">pdf_dataframe_target</span>

        <span class="n">df_filtered_source</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">df_filtered_target</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">df_dup2_source</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">df_dup2_target</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">list_headers</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">list_headers_source</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">list_headers_target</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">bool_ignore_datatype</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">source_types</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_dataframe_source</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
                <span class="n">target_types</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_dataframe_target</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
                <span class="n">series_common_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__datatype_conversion</span><span class="p">(</span><span class="n">source_types</span><span class="p">,</span> <span class="n">target_types</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">series_common_type</span><span class="p">)):</span>
                    <span class="n">df_dataframe_source</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_dataframe_source</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">series_common_type</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="n">df_dataframe_target</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_dataframe_target</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">series_common_type</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

            <span class="n">df_dup_source</span> <span class="o">=</span> <span class="n">df_dataframe_source</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">df_dup_target</span> <span class="o">=</span> <span class="n">df_dataframe_target</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">df_dup2_source</span> <span class="o">=</span> <span class="n">df_dup_source</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">df_dup2_target</span> <span class="o">=</span> <span class="n">df_dup_target</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">pstr_compare_mode</span> <span class="o">==</span> <span class="s1">&#39;header&#39;</span><span class="p">:</span>
                <span class="n">df_dup2_source</span><span class="o">.</span><span class="n">set_axis</span><span class="p">(</span><span class="n">list_source_headers</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">df_dup2_target</span><span class="o">.</span><span class="n">set_axis</span><span class="p">(</span><span class="n">list_source_headers</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">elif</span> <span class="p">(</span><span class="n">list_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">list_headers_source</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">list_headers_target</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">bool_ignore_datatype</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">source_types</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_dataframe_source</span><span class="p">[</span><span class="n">list_headers</span><span class="p">]</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
                <span class="n">target_types</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_dataframe_target</span><span class="p">[</span><span class="n">list_headers</span><span class="p">]</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
                <span class="n">series_common_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__datatype_conversion</span><span class="p">(</span><span class="n">source_types</span><span class="p">,</span> <span class="n">target_types</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">series_common_type</span><span class="p">)):</span>
                    <span class="n">df_dataframe_source</span><span class="p">[</span><span class="n">list_headers</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">df_dataframe_source</span><span class="p">[</span><span class="n">list_headers</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span>
                        <span class="n">series_common_type</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="n">df_dataframe_target</span><span class="p">[</span><span class="n">list_headers</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">df_dataframe_target</span><span class="p">[</span><span class="n">list_headers</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span>
                        <span class="n">series_common_type</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

            <span class="n">df_dup_source</span> <span class="o">=</span> <span class="n">df_dataframe_source</span><span class="p">[</span><span class="n">list_headers</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">df_dup_target</span> <span class="o">=</span> <span class="n">df_dataframe_target</span><span class="p">[</span><span class="n">list_headers</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">df_dup2_source</span> <span class="o">=</span> <span class="n">df_dup_source</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">df_dup2_target</span> <span class="o">=</span> <span class="n">df_dup_target</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">elif</span> <span class="p">(</span><span class="n">list_headers</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">list_headers_source</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">list_headers_target</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">bool_ignore_datatype</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">source_types</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_dataframe_source</span><span class="p">[</span><span class="n">list_headers_source</span><span class="p">]</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
                <span class="n">target_types</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_dataframe_target</span><span class="p">[</span><span class="n">list_headers_target</span><span class="p">]</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
                <span class="n">series_common_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__datatype_conversion</span><span class="p">(</span><span class="n">source_types</span><span class="p">,</span> <span class="n">target_types</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">series_common_type</span><span class="p">)):</span>
                    <span class="n">df_dataframe_source</span><span class="p">[</span><span class="n">list_headers_source</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">df_dataframe_source</span><span class="p">[</span>
                        <span class="n">list_headers_source</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">series_common_type</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="n">df_dataframe_target</span><span class="p">[</span><span class="n">list_headers_target</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">df_dataframe_target</span><span class="p">[</span>
                        <span class="n">list_headers_target</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">series_common_type</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

            <span class="k">if</span> <span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">list_headers_source</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_headers_source</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_headers_target</span><span class="p">))):</span>
                <span class="n">df_dup_source</span> <span class="o">=</span> <span class="n">df_dataframe_source</span><span class="p">[</span><span class="n">list_headers_source</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">df_dup_target</span> <span class="o">=</span> <span class="n">df_dataframe_target</span><span class="p">[</span><span class="n">list_headers_target</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">df_dup2_source</span> <span class="o">=</span> <span class="n">df_dup_source</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">df_dup2_target</span> <span class="o">=</span> <span class="n">df_dup_target</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">df_dup2_source</span><span class="o">.</span><span class="n">set_axis</span><span class="p">(</span><span class="n">list_headers_source</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">df_dup2_target</span><span class="o">.</span><span class="n">set_axis</span><span class="p">(</span><span class="n">list_headers_source</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;The count of source header and target header list is not equal&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Looks like there is a conflict in the given kwargs parameters, please check them&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">df_dup2_source</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">df_dup2_target</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">df_dup2_source</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">df_dup2_target</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">diffs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_dup2_source</span><span class="p">,</span> <span class="n">df_dup2_target</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">df_filtered_source_temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">diffs</span><span class="p">,</span> <span class="n">df_dup2_source</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">df_filtered_source</span> <span class="o">=</span> <span class="n">df_filtered_source_temp</span><span class="p">[</span><span class="n">df_filtered_source_temp</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()]</span>
            <span class="n">df_filtered_target_temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">diffs</span><span class="p">,</span> <span class="n">df_dup2_target</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">df_filtered_target</span> <span class="o">=</span> <span class="n">df_filtered_target_temp</span><span class="p">[</span><span class="n">df_filtered_target_temp</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()]</span>
            <span class="k">if</span> <span class="n">pstr_compare_mode</span> <span class="o">==</span> <span class="s1">&#39;header&#39;</span> <span class="ow">and</span> <span class="n">list_headers_source</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">list_headers_target</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">df_filtered_target</span><span class="o">.</span><span class="n">set_axis</span><span class="p">(</span><span class="n">list_headers_target</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">bool_club</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">dict_primary_keys</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;When bool_club specified , please specify the headers also&quot;</span><span class="p">)</span>
                <span class="n">df_clubbed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__difference_formatter</span><span class="p">(</span><span class="n">df_filtered_source</span><span class="p">,</span> <span class="n">df_filtered_target</span><span class="p">,</span>
                                                         <span class="n">plist_source_headers</span><span class="o">=</span><span class="n">list_headers_source</span><span class="p">,</span>
                                                         <span class="n">plist_target_headers</span><span class="o">=</span><span class="n">list_headers_target</span><span class="p">,</span>
                                                         <span class="n">pdict_primary_keys</span><span class="o">=</span><span class="n">dict_primary_keys</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">pbool_get_common</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">diffs</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                    <span class="n">df_common</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">diffs</span><span class="p">,</span> <span class="n">df_dup2_source</span><span class="p">,</span> <span class="n">df_dup2_target</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span>
                        <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">df_common</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">diffs</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_dup2_source</span><span class="p">,</span> <span class="n">df_dup2_target</span><span class="p">])</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span>
                        <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)])</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">bool_club</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">df_common</span><span class="p">,</span> <span class="n">df_clubbed</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">df_common</span><span class="p">,</span> <span class="n">df_filtered_source</span><span class="p">,</span> <span class="n">df_filtered_target</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">bool_club</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">df_clubbed</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">df_filtered_source</span><span class="p">,</span> <span class="n">df_filtered_target</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cafex_db.database_handler.DatabaseHandler.compare_resultlists" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compare_resultlists</span><span class="p">(</span><span class="n">plist_resultlist_source</span><span class="p">,</span> <span class="n">plist_resultlist_target</span><span class="p">,</span> <span class="n">pstr_compare_mode</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">



<details class="description" open>
  <summary>Description</summary>
  <p>|  This method lets user compare two result lists and returns the difference in the form of a Dataframe.</p>
</details>        <p>:param plist_resultlist_source:
:type plist_resultlist_source: Result List
:param plist_resultlist_target:
:type plist_resultlist_target: Result List
:param pstr_compare_mode: index/header
:type pstr_compare_mode: String
:param plist_headers: List of Headers to compare
:type plist_headers: kwargs
:param plist_headers_source: List of Source Headers to compare
:type plist_headers_source: kwargs
:param plist_headers_target: List of Source Headers to compare
:type plist_headers_target: kwargs
:param pint_rowcount: Number of rows to compare
:type pint_rowcount: kwargs
:param pbool_ignore_datatype:
:type pbool_ignore_datatype: kwargs
:param pbool_line_to_line: default value is False
:type pbool_line_to_line: kwargs
:param pbool_get_common: default value is False
:type pbool_get_common: kwargs
:param pbool_ignore_header_case: default value is False
:type pbool_ignore_header_case: kwargs
:param pbool_club: default value is False
:type pbool_ignore_header_case: kwargs
:param pdict_primary_keys: Dictionary in the format of {'source':[],'target':[]}
:type pbool_ignore_header_case: kwargs</p>
<p>:return: When pbool_line_to_line=False, returns two Dataframes, one contains (source - target) and the other contains (target - source)
         When pbool_line_to_line=False and pbool_get_common=True, returns three Dataframes, first one is common data, second one contains (source - target) and the other contains (target - source)
         When pbool_line_to_line=True, returns one Dataframe containing (source - target)</p>


<p><span class="doc-section-title">Examples:</span></p>
    <p>|  1. Let us imagine we have 2 result sets rs_source=3 headers and rs_target=3 headers then usage would be
|  compare_resultsets(rs_source, rs_target) or compare_resultsets(rs_source, rs_target, pstr_compare_mode='index')
|  This will only work when both result sets have same no. of headers, otherwise an exception will be thrown.
|  2. Let us imagine we have 2 result sets with headers as following rs_source=['id', 'name', 'age'] and (rs_target=['id', 'name', 'age'] or rs_target=['age', 'name', 'id'])
|  compare_resultsets(rs_source, rs_target, pstr_compare_mode='header')
|  This will only work when both result sets have same no. of headers, otherwise an exception will be thrown.
|  3. Let us imagine we have 2 result sets with headers as following rs_source=['id', 'name', 'age', 'location', 'country'] and rs_target=['id', 'name', 'age']
|  compare_resultsets(rs_source, rs_target, pstr_compare_mode='header', plist_headers=['id', 'name', 'age'])
|  4. Let us imagine we have 2 result sets with headers as following rs_source=['id_source', 'name_source', 'age_source', 'location_source', 'country_source'] and rs_target=['id_target', 'name_target', 'age_target']
|  compare_resultsets(rs_source, rs_target, pstr_compare_mode='header', plist_headers_source=['id_source', 'name_source', 'age_source'], plist_headers_target=['id_target', 'name_target', 'age_target'])
|  In this case, id_source will be compared with id_target and so on.
|  Make sure that plist_headers_source and plist_headers_target are used together, otherwise an exception will be thrown.
|  Sizes of both the lists plist_headers_source and plist_headers_target must be same.
|  5. Let us imagine the requirement is to compare only top few records from both result sets then use the **kwargs parameter pint_rowcount
|  compare_resultsets(rs_source, rs_target, pint_rowcount=10)
|  6. If user wants to perform row-to-row comparison of same sized(same no. of rows) data, then
|  compare_resultlists(resultset1, resultset2, pint_row_count=10, pbool_line_to_line=True, pstr_compare_mode='header')
|  7. If the user wants to fetch common data in both resultlists along with (source-target and target_source), then
|  compare_resultlists(resultset1, resultset2, pstr_compare_mode='header', pbool_get_common=True)
|  8. If the user wants to get only a single difference for source_target and target_source then the statment would be like
|  difference_dataframe = obj.compare_resultlists(resultset1, resultset2,pbool_ignore_datatype=True,pstr_compare_mode="header",plist_headers_source=['TCExecuted','TEexecutiontime'],plist_headers_target=['TCExecutedold','TEexecutiontime'],pbool_club=True,pdict_primary_keys=data)</p>
        <p>.. notes::
    |  If there is no difference, then None will be returned.
    |  The source and target row count should be same
    |  The pbool_club is only applicable if the user performs the comparison with pstr_comparison_mode ='header' and pbool_line_to_line = False</p>

            <details class="quote">
              <summary>Source code in <code>cafex_db\database_handler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compare_resultlists</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plist_resultlist_source</span><span class="p">,</span> <span class="n">plist_resultlist_target</span><span class="p">,</span> <span class="n">pstr_compare_mode</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span>
                        <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Description:</span>
<span class="sd">        |  This method lets user compare two result lists and returns the difference in the form of a Dataframe.</span>

<span class="sd">    :param plist_resultlist_source:</span>
<span class="sd">    :type plist_resultlist_source: Result List</span>
<span class="sd">    :param plist_resultlist_target:</span>
<span class="sd">    :type plist_resultlist_target: Result List</span>
<span class="sd">    :param pstr_compare_mode: index/header</span>
<span class="sd">    :type pstr_compare_mode: String</span>
<span class="sd">    :param plist_headers: List of Headers to compare</span>
<span class="sd">    :type plist_headers: kwargs</span>
<span class="sd">    :param plist_headers_source: List of Source Headers to compare</span>
<span class="sd">    :type plist_headers_source: kwargs</span>
<span class="sd">    :param plist_headers_target: List of Source Headers to compare</span>
<span class="sd">    :type plist_headers_target: kwargs</span>
<span class="sd">    :param pint_rowcount: Number of rows to compare</span>
<span class="sd">    :type pint_rowcount: kwargs</span>
<span class="sd">    :param pbool_ignore_datatype:</span>
<span class="sd">    :type pbool_ignore_datatype: kwargs</span>
<span class="sd">    :param pbool_line_to_line: default value is False</span>
<span class="sd">    :type pbool_line_to_line: kwargs</span>
<span class="sd">    :param pbool_get_common: default value is False</span>
<span class="sd">    :type pbool_get_common: kwargs</span>
<span class="sd">    :param pbool_ignore_header_case: default value is False</span>
<span class="sd">    :type pbool_ignore_header_case: kwargs</span>
<span class="sd">    :param pbool_club: default value is False</span>
<span class="sd">    :type pbool_ignore_header_case: kwargs</span>
<span class="sd">    :param pdict_primary_keys: Dictionary in the format of {&#39;source&#39;:[],&#39;target&#39;:[]}</span>
<span class="sd">    :type pbool_ignore_header_case: kwargs</span>


<span class="sd">    :return: When pbool_line_to_line=False, returns two Dataframes, one contains (source - target) and the other contains (target - source)</span>
<span class="sd">             When pbool_line_to_line=False and pbool_get_common=True, returns three Dataframes, first one is common data, second one contains (source - target) and the other contains (target - source)</span>
<span class="sd">             When pbool_line_to_line=True, returns one Dataframe containing (source - target)</span>

<span class="sd">    Examples:</span>
<span class="sd">        |  1. Let us imagine we have 2 result sets rs_source=3 headers and rs_target=3 headers then usage would be</span>
<span class="sd">        |  compare_resultsets(rs_source, rs_target) or compare_resultsets(rs_source, rs_target, pstr_compare_mode=&#39;index&#39;)</span>
<span class="sd">        |  This will only work when both result sets have same no. of headers, otherwise an exception will be thrown.</span>
<span class="sd">        |  2. Let us imagine we have 2 result sets with headers as following rs_source=[&#39;id&#39;, &#39;name&#39;, &#39;age&#39;] and (rs_target=[&#39;id&#39;, &#39;name&#39;, &#39;age&#39;] or rs_target=[&#39;age&#39;, &#39;name&#39;, &#39;id&#39;])</span>
<span class="sd">        |  compare_resultsets(rs_source, rs_target, pstr_compare_mode=&#39;header&#39;)</span>
<span class="sd">        |  This will only work when both result sets have same no. of headers, otherwise an exception will be thrown.</span>
<span class="sd">        |  3. Let us imagine we have 2 result sets with headers as following rs_source=[&#39;id&#39;, &#39;name&#39;, &#39;age&#39;, &#39;location&#39;, &#39;country&#39;] and rs_target=[&#39;id&#39;, &#39;name&#39;, &#39;age&#39;]</span>
<span class="sd">        |  compare_resultsets(rs_source, rs_target, pstr_compare_mode=&#39;header&#39;, plist_headers=[&#39;id&#39;, &#39;name&#39;, &#39;age&#39;])</span>
<span class="sd">        |  4. Let us imagine we have 2 result sets with headers as following rs_source=[&#39;id_source&#39;, &#39;name_source&#39;, &#39;age_source&#39;, &#39;location_source&#39;, &#39;country_source&#39;] and rs_target=[&#39;id_target&#39;, &#39;name_target&#39;, &#39;age_target&#39;]</span>
<span class="sd">        |  compare_resultsets(rs_source, rs_target, pstr_compare_mode=&#39;header&#39;, plist_headers_source=[&#39;id_source&#39;, &#39;name_source&#39;, &#39;age_source&#39;], plist_headers_target=[&#39;id_target&#39;, &#39;name_target&#39;, &#39;age_target&#39;])</span>
<span class="sd">        |  In this case, id_source will be compared with id_target and so on.</span>
<span class="sd">        |  Make sure that plist_headers_source and plist_headers_target are used together, otherwise an exception will be thrown.</span>
<span class="sd">        |  Sizes of both the lists plist_headers_source and plist_headers_target must be same.</span>
<span class="sd">        |  5. Let us imagine the requirement is to compare only top few records from both result sets then use the **kwargs parameter pint_rowcount</span>
<span class="sd">        |  compare_resultsets(rs_source, rs_target, pint_rowcount=10)</span>
<span class="sd">        |  6. If user wants to perform row-to-row comparison of same sized(same no. of rows) data, then</span>
<span class="sd">        |  compare_resultlists(resultset1, resultset2, pint_row_count=10, pbool_line_to_line=True, pstr_compare_mode=&#39;header&#39;)</span>
<span class="sd">        |  7. If the user wants to fetch common data in both resultlists along with (source-target and target_source), then</span>
<span class="sd">        |  compare_resultlists(resultset1, resultset2, pstr_compare_mode=&#39;header&#39;, pbool_get_common=True)</span>
<span class="sd">        |  8. If the user wants to get only a single difference for source_target and target_source then the statment would be like</span>
<span class="sd">        |  difference_dataframe = obj.compare_resultlists(resultset1, resultset2,pbool_ignore_datatype=True,pstr_compare_mode=&quot;header&quot;,plist_headers_source=[&#39;TCExecuted&#39;,&#39;TEexecutiontime&#39;],plist_headers_target=[&#39;TCExecutedold&#39;,&#39;TEexecutiontime&#39;],pbool_club=True,pdict_primary_keys=data)</span>



<span class="sd">    .. notes::</span>
<span class="sd">        |  If there is no difference, then None will be returned.</span>
<span class="sd">        |  The source and target row count should be same</span>
<span class="sd">        |  The pbool_club is only applicable if the user performs the comparison with pstr_comparison_mode =&#39;header&#39; and pbool_line_to_line = False</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">plist_headers</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plist_headers&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">plist_headers_source</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plist_headers_source&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">plist_headers_target</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plist_headers_target&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">pint_row_count</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pint_row_count&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">bool_ignore_datatype</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pbool_ignore_datatype&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">line_to_line</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pbool_line_to_line&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">pbool_get_common</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pbool_get_common&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">pbool_ignore_header_case</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pbool_ignore_header_case&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">bool_club</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pbool_club&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">dict_primary_keys</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pdict_primary_keys&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">df_difference_dataframe</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">plist_resultlist_source</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">plist_resultlist_target</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Method compare_resultlists : One or both of the result data is None&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">pint_row_count</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">pint_row_count</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Method compare_resultlists : Given row count should be greater than 0 &#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">line_to_line</span> <span class="o">==</span> <span class="kc">True</span> <span class="ow">and</span> <span class="n">pint_row_count</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">plist_resultlist_source</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">plist_resultlist_target</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                    <span class="s1">&#39;Method compare_resultlists : line to line comparison is accepted only if the length of the source and target is same. If needed you can specify the kwarg that is rowcount&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">pstr_compare_mode</span> <span class="o">==</span> <span class="s1">&#39;index&#39;</span><span class="p">:</span>
            <span class="n">df_dataframe_source</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">plist_resultlist_source</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">plist_resultlist_source</span><span class="p">)])</span>
            <span class="n">df_dataframe_target</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">plist_resultlist_target</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">plist_resultlist_target</span><span class="p">)])</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">plist_resultlist_source</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">plist_resultlist_target</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                    <span class="s1">&#39;The source and target header count is different, please make sure that the count is same&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">line_to_line</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">df_difference_dataframe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_frame_diff</span><span class="p">(</span><span class="n">df_dataframe_source</span><span class="p">,</span> <span class="n">df_dataframe_target</span><span class="p">,</span>
                                                               <span class="n">pint_rowcount</span><span class="o">=</span><span class="n">pint_row_count</span><span class="p">,</span>
                                                               <span class="n">pbool_ignore_datatype</span><span class="o">=</span><span class="n">bool_ignore_datatype</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">df_difference_dataframe</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">df_difference_dataframe</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                    <span class="n">df_difference_dataframe</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>

                <span class="k">return</span> <span class="n">df_difference_dataframe</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">pbool_get_common</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">common</span><span class="p">,</span> <span class="n">df_source_differences</span><span class="p">,</span> <span class="n">df_target_differences</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_dataframes_distinct</span><span class="p">(</span>
                        <span class="n">df_dataframe_source</span><span class="p">,</span> <span class="n">df_dataframe_target</span><span class="p">,</span> <span class="n">pint_rowcount</span><span class="o">=</span><span class="n">pint_row_count</span><span class="p">,</span>
                        <span class="n">pbool_get_common</span><span class="o">=</span><span class="n">pbool_get_common</span><span class="p">,</span> <span class="n">pbool_ignore_datatype</span><span class="o">=</span><span class="n">bool_ignore_datatype</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">common</span><span class="p">,</span> <span class="n">df_source_differences</span><span class="p">,</span> <span class="n">df_target_differences</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">df_source_differences</span><span class="p">,</span> <span class="n">df_target_differences</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_dataframes_distinct</span><span class="p">(</span>
                        <span class="n">df_dataframe_source</span><span class="p">,</span> <span class="n">df_dataframe_target</span><span class="p">,</span> <span class="n">pint_rowcount</span><span class="o">=</span><span class="n">pint_row_count</span><span class="p">,</span>
                        <span class="n">pbool_get_common</span><span class="o">=</span><span class="n">pbool_get_common</span><span class="p">,</span> <span class="n">pbool_ignore_datatype</span><span class="o">=</span><span class="n">bool_ignore_datatype</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">df_source_differences</span><span class="p">,</span> <span class="n">df_target_differences</span>

        <span class="k">elif</span> <span class="n">pstr_compare_mode</span> <span class="o">==</span> <span class="s1">&#39;header&#39;</span><span class="p">:</span>
            <span class="n">list_source</span> <span class="o">=</span> <span class="n">plist_resultlist_source</span>
            <span class="n">list_target</span> <span class="o">=</span> <span class="n">plist_resultlist_target</span>

            <span class="k">if</span> <span class="n">pbool_ignore_header_case</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">source_headers_temp</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">list_source</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="n">target_headers_temp</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">list_target</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="k">if</span> <span class="n">plist_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">plist_headers</span> <span class="o">=</span> <span class="p">[</span><span class="n">valc</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">valc</span> <span class="ow">in</span> <span class="n">plist_headers</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">plist_headers_source</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">plist_headers_target</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">plist_headers_source</span> <span class="o">=</span> <span class="p">[</span><span class="n">vals</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">vals</span> <span class="ow">in</span> <span class="n">plist_headers_source</span><span class="p">]</span>
                    <span class="n">plist_headers_target</span> <span class="o">=</span> <span class="p">[</span><span class="n">valt</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">valt</span> <span class="ow">in</span> <span class="n">plist_headers_target</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">source_headers_temp</span> <span class="o">=</span> <span class="n">list_source</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">target_headers_temp</span> <span class="o">=</span> <span class="n">list_target</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="n">df_dataframe_source</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">list_source</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">list_source</span><span class="p">)],</span> <span class="n">columns</span><span class="o">=</span><span class="n">source_headers_temp</span><span class="p">)</span>
            <span class="n">df_dataframe_target</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">list_target</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">list_target</span><span class="p">)],</span> <span class="n">columns</span><span class="o">=</span><span class="n">target_headers_temp</span><span class="p">)</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">plist_headers_source</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">plist_headers_target</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
                    <span class="n">plist_headers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">plist_resultlist_source</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">plist_resultlist_target</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                        <span class="s1">&#39;The source and target header count is different, please make sure that the count is same&#39;</span><span class="p">)</span>
                <span class="n">list_source</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
                <span class="n">list_target</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
                <span class="n">plist_headers_source</span> <span class="o">=</span> <span class="n">source_headers_temp</span>
                <span class="n">plist_headers_target</span> <span class="o">=</span> <span class="n">target_headers_temp</span>
                <span class="k">if</span> <span class="n">plist_headers_source</span> <span class="o">!=</span> <span class="n">plist_headers_target</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;The headers in the source and target results are different&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">line_to_line</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">df_difference_dataframe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_frame_diff</span><span class="p">(</span><span class="n">df_dataframe_source</span><span class="p">,</span> <span class="n">df_dataframe_target</span><span class="p">,</span>
                                                               <span class="n">plist_headers</span><span class="o">=</span><span class="n">plist_headers</span><span class="p">,</span>
                                                               <span class="n">plist_headers_source</span><span class="o">=</span><span class="n">plist_headers_source</span><span class="p">,</span>
                                                               <span class="n">plist_headers_target</span><span class="o">=</span><span class="n">plist_headers_target</span><span class="p">,</span>
                                                               <span class="n">pint_rowcount</span><span class="o">=</span><span class="n">pint_row_count</span><span class="p">,</span>
                                                               <span class="n">pbool_ignore_datatype</span><span class="o">=</span><span class="n">bool_ignore_datatype</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">df_difference_dataframe</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">df_difference_dataframe</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                    <span class="n">df_difference_dataframe</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>

                <span class="k">return</span> <span class="n">df_difference_dataframe</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># added the distinct method call statement</span>
                <span class="k">if</span> <span class="n">pbool_get_common</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">bool_club</span><span class="p">:</span>
                        <span class="n">df_common_dataframe</span><span class="p">,</span> <span class="n">df_dataframe_formatted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_dataframes_distinct</span><span class="p">(</span>
                            <span class="n">df_dataframe_source</span><span class="p">,</span> <span class="n">df_dataframe_target</span><span class="p">,</span>
                            <span class="n">plist_headers</span><span class="o">=</span><span class="n">plist_headers</span><span class="p">,</span>
                            <span class="n">plist_headers_source</span><span class="o">=</span><span class="n">plist_headers_source</span><span class="p">,</span>
                            <span class="n">plist_headers_target</span><span class="o">=</span><span class="n">plist_headers_target</span><span class="p">,</span>
                            <span class="n">pint_rowcount</span><span class="o">=</span><span class="n">pint_row_count</span><span class="p">,</span> <span class="n">pbool_get_common</span><span class="o">=</span><span class="n">pbool_get_common</span><span class="p">,</span>
                            <span class="n">pbool_ignore_datatype</span><span class="o">=</span><span class="n">bool_ignore_datatype</span><span class="p">,</span> <span class="n">pbool_club</span><span class="o">=</span><span class="n">bool_club</span><span class="p">,</span>
                            <span class="n">pdict_primary_keys</span><span class="o">=</span><span class="n">dict_primary_keys</span><span class="p">)</span>
                        <span class="k">return</span> <span class="n">df_common_dataframe</span><span class="p">,</span> <span class="n">df_dataframe_formatted</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">df_common_dataframe</span><span class="p">,</span> <span class="n">df_source_differences</span><span class="p">,</span> <span class="n">df_target_differences</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_dataframes_distinct</span><span class="p">(</span>
                            <span class="n">df_dataframe_source</span><span class="p">,</span> <span class="n">df_dataframe_target</span><span class="p">,</span>
                            <span class="n">plist_headers</span><span class="o">=</span><span class="n">plist_headers</span><span class="p">,</span>
                            <span class="n">plist_headers_source</span><span class="o">=</span><span class="n">plist_headers_source</span><span class="p">,</span>
                            <span class="n">plist_headers_target</span><span class="o">=</span><span class="n">plist_headers_target</span><span class="p">,</span>
                            <span class="n">pint_rowcount</span><span class="o">=</span><span class="n">pint_row_count</span><span class="p">,</span> <span class="n">pbool_get_common</span><span class="o">=</span><span class="n">pbool_get_common</span><span class="p">,</span>
                            <span class="n">pbool_ignore_datatype</span><span class="o">=</span><span class="n">bool_ignore_datatype</span><span class="p">,</span> <span class="n">pbool_club</span><span class="o">=</span><span class="n">bool_club</span><span class="p">,</span>
                            <span class="n">pdict_primary_keys</span><span class="o">=</span><span class="n">dict_primary_keys</span><span class="p">)</span>
                        <span class="k">return</span> <span class="n">df_common_dataframe</span><span class="p">,</span> <span class="n">df_source_differences</span><span class="p">,</span> <span class="n">df_target_differences</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">bool_club</span><span class="p">:</span>
                        <span class="n">df_differences</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_dataframes_distinct</span><span class="p">(</span><span class="n">df_dataframe_source</span><span class="p">,</span> <span class="n">df_dataframe_target</span><span class="p">,</span>
                                                                          <span class="n">plist_headers</span><span class="o">=</span><span class="n">plist_headers</span><span class="p">,</span>
                                                                          <span class="n">plist_headers_source</span><span class="o">=</span><span class="n">plist_headers_source</span><span class="p">,</span>
                                                                          <span class="n">plist_headers_target</span><span class="o">=</span><span class="n">plist_headers_target</span><span class="p">,</span>
                                                                          <span class="n">pint_rowcount</span><span class="o">=</span><span class="n">pint_row_count</span><span class="p">,</span>
                                                                          <span class="n">pbool_get_common</span><span class="o">=</span><span class="n">pbool_get_common</span><span class="p">,</span>
                                                                          <span class="n">pbool_ignore_datatype</span><span class="o">=</span><span class="n">bool_ignore_datatype</span><span class="p">,</span>
                                                                          <span class="n">pbool_club</span><span class="o">=</span><span class="n">bool_club</span><span class="p">,</span>
                                                                          <span class="n">pdict_primary_keys</span><span class="o">=</span><span class="n">dict_primary_keys</span><span class="p">)</span>
                        <span class="k">return</span> <span class="n">df_differences</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">df_source_differences</span><span class="p">,</span> <span class="n">df_target_differences</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compare_dataframes_distinct</span><span class="p">(</span>
                            <span class="n">df_dataframe_source</span><span class="p">,</span> <span class="n">df_dataframe_target</span><span class="p">,</span>
                            <span class="n">plist_headers</span><span class="o">=</span><span class="n">plist_headers</span><span class="p">,</span>
                            <span class="n">plist_headers_source</span><span class="o">=</span><span class="n">plist_headers_source</span><span class="p">,</span>
                            <span class="n">plist_headers_target</span><span class="o">=</span><span class="n">plist_headers_target</span><span class="p">,</span>
                            <span class="n">pint_rowcount</span><span class="o">=</span><span class="n">pint_row_count</span><span class="p">,</span> <span class="n">pbool_get_common</span><span class="o">=</span><span class="n">pbool_get_common</span><span class="p">,</span>
                            <span class="n">pbool_ignore_datatype</span><span class="o">=</span><span class="n">bool_ignore_datatype</span><span class="p">,</span> <span class="n">pbool_club</span><span class="o">=</span><span class="n">bool_club</span><span class="p">,</span>
                            <span class="n">pdict_primary_keys</span><span class="o">=</span><span class="n">dict_primary_keys</span><span class="p">)</span>
                        <span class="k">return</span> <span class="n">df_source_differences</span><span class="p">,</span> <span class="n">df_target_differences</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Given compare mode is invalid, please select index or header&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cafex_db.database_handler.DatabaseHandler.create_db_connection" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_db_connection</span><span class="p">(</span><span class="n">pstr_database_type</span><span class="p">,</span> <span class="n">pstr_server_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">



<details class="description" open>
  <summary>Description</summary>
  <p>|This method creates a DB connection</p>
</details>        <p>:param pstr_database_type: This parameter can accept only mssql/mysql/oracle/hive/postgres/cassandra/spark/ec2_hive
:type pstr_database_type: String
:param pstr_server_name: server name
:type pstr_server_name: String
:param pstr_database_name: database name
:type pstr_database_name: kwargs
:param pstr_username: username
:type pstr_username: kwargs
:param pstr_password: password
:type pstr_password: kwargs
:param pint_port_number: port
:type pint_port_number: kwargs
:param pbool_ispasswordencoded: True/False
:type pbool_ispasswordencoded: kwargs
:param ppem_file: SSH key file path
:type ppem_file: kwargs
:param psecret_key: secret key
:type psecret_key: kwargs
:param pstr_sid: SID
:type pstr_sid: kwargs
:param pstr_service_name: Service Name
:type pstr_service_name: kwargs
:param pstr_encoding: encoding format
:type pstr_encoding: kwargs
:param pint_control_timeout: Query control parameter for cassandra and mssql connections
:type pint_control_timeout: kwargs</p>
<p>:return: Database Connection Object</p>


<p><span class="doc-section-title">Examples:</span></p>
    <p>|  1. create_db_connection('mssql', 'database server name', pstr_database_name='database name')
|  2. create_db_connection('mssql', 'database server name', pstr_database_name='database name', pstr_username='username', pstr_password='Welcome@123', bool_ispasswordencode=True)
|  3. create_db_connection('mssql', 'database server name', pstr_database_name='database name', pstr_username='username', pstr_password='Welcome%40123', bool_ispasswordencode=False, pint_control_timeout=int_in_second)
|  4. create_db_connection('oracle', 'host', pstr_database_name='database name', pstr_username='username', pstr_password='password', pint_port_number=port, pstr_service_name='service_name')
|  5. create_db_connection('oracle', 'host', pstr_database_name='database name', pstr_username='username', pstr_password='password', pint_port_number=port, pstr_sid='sid')
|  6. create_db_connection('hive', 'database server name', pstr_database_name='database name', pstr_username='username', pstr_password='password')
|  7. create_db_connection('hive', 'database server name', pstr_username='username', ppem_file='SSH Key file path')
|  8. create_db_connection('postgres', 'database server name', pint_port_number=port, pstr_database_name='database server name', pstr_username='username', pstr_password='password')
|  9. create_db_connection('cassandra', 'database server name', pstr_database_name='database name', pstr_username='username', pstr_password='password')</p>
        <p>.. notes::
    |  Encoding format option is available only for oracle connection for now.
    |  mssql method expects password in url encoded format, here urllib.parse.quote_plus() is encoding the passwords with special characters &amp; non-ASCII text.
    |  pbool_ispasswordencoded is set to False by default for mssql db connection method:mssql.
    |  If user chooses to pass password as, for ex:Welcome%40123 instead of Welcome@123(original one, un-encoded format), pbool_ispasswordencoded should be set to False.
    |  If pbool_ispasswordencoded is True, then given uncoded password will be encoded to be parsed correctly to the connection string.
    |  If user chooses to pass password as it is ie., in un-encoded format for ex:Welcome@123 then, pbool_ispasswordencoded should be set to True.</p>
<p>.. warning::
    |  Old reference - Oracle instant client is a must be available on the host for oracle connection. Refer to the documentation at https://cx-oracle.readthedocs.io/en/latest/installation.html#installing-cx-oracle-on-windows to understand the setup process.
        |  Latest reference - Oracle instant client is a must be available on the host for oracle connection. Refer to the documentation at https://cx-oracle.readthedocs.io/en/latest/user_guide/installation.html#installing-cx-oracle-on-windows to understand the setup process.
    |  pint_control_timeout - This parameter is only for cassandra which states the timeout for scheme quering for nodes.This can be inform of float as well</p>

            <details class="quote">
              <summary>Source code in <code>cafex_db\database_handler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_db_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pstr_database_type</span><span class="p">,</span> <span class="n">pstr_server_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Description:</span>
<span class="sd">        |This method creates a DB connection</span>

<span class="sd">    :param pstr_database_type: This parameter can accept only mssql/mysql/oracle/hive/postgres/cassandra/spark/ec2_hive</span>
<span class="sd">    :type pstr_database_type: String</span>
<span class="sd">    :param pstr_server_name: server name</span>
<span class="sd">    :type pstr_server_name: String</span>
<span class="sd">    :param pstr_database_name: database name</span>
<span class="sd">    :type pstr_database_name: kwargs</span>
<span class="sd">    :param pstr_username: username</span>
<span class="sd">    :type pstr_username: kwargs</span>
<span class="sd">    :param pstr_password: password</span>
<span class="sd">    :type pstr_password: kwargs</span>
<span class="sd">    :param pint_port_number: port</span>
<span class="sd">    :type pint_port_number: kwargs</span>
<span class="sd">    :param pbool_ispasswordencoded: True/False</span>
<span class="sd">    :type pbool_ispasswordencoded: kwargs</span>
<span class="sd">    :param ppem_file: SSH key file path</span>
<span class="sd">    :type ppem_file: kwargs</span>
<span class="sd">    :param psecret_key: secret key</span>
<span class="sd">    :type psecret_key: kwargs</span>
<span class="sd">    :param pstr_sid: SID</span>
<span class="sd">    :type pstr_sid: kwargs</span>
<span class="sd">    :param pstr_service_name: Service Name</span>
<span class="sd">    :type pstr_service_name: kwargs</span>
<span class="sd">    :param pstr_encoding: encoding format</span>
<span class="sd">    :type pstr_encoding: kwargs</span>
<span class="sd">    :param pint_control_timeout: Query control parameter for cassandra and mssql connections</span>
<span class="sd">    :type pint_control_timeout: kwargs</span>


<span class="sd">    :return: Database Connection Object</span>

<span class="sd">    Examples:</span>
<span class="sd">        |  1. create_db_connection(&#39;mssql&#39;, &#39;database server name&#39;, pstr_database_name=&#39;database name&#39;)</span>
<span class="sd">        |  2. create_db_connection(&#39;mssql&#39;, &#39;database server name&#39;, pstr_database_name=&#39;database name&#39;, pstr_username=&#39;username&#39;, pstr_password=&#39;Welcome@123&#39;, bool_ispasswordencode=True)</span>
<span class="sd">        |  3. create_db_connection(&#39;mssql&#39;, &#39;database server name&#39;, pstr_database_name=&#39;database name&#39;, pstr_username=&#39;username&#39;, pstr_password=&#39;Welcome%40123&#39;, bool_ispasswordencode=False, pint_control_timeout=int_in_second)</span>
<span class="sd">        |  4. create_db_connection(&#39;oracle&#39;, &#39;host&#39;, pstr_database_name=&#39;database name&#39;, pstr_username=&#39;username&#39;, pstr_password=&#39;password&#39;, pint_port_number=port, pstr_service_name=&#39;service_name&#39;)</span>
<span class="sd">        |  5. create_db_connection(&#39;oracle&#39;, &#39;host&#39;, pstr_database_name=&#39;database name&#39;, pstr_username=&#39;username&#39;, pstr_password=&#39;password&#39;, pint_port_number=port, pstr_sid=&#39;sid&#39;)</span>
<span class="sd">        |  6. create_db_connection(&#39;hive&#39;, &#39;database server name&#39;, pstr_database_name=&#39;database name&#39;, pstr_username=&#39;username&#39;, pstr_password=&#39;password&#39;)</span>
<span class="sd">        |  7. create_db_connection(&#39;hive&#39;, &#39;database server name&#39;, pstr_username=&#39;username&#39;, ppem_file=&#39;SSH Key file path&#39;)</span>
<span class="sd">        |  8. create_db_connection(&#39;postgres&#39;, &#39;database server name&#39;, pint_port_number=port, pstr_database_name=&#39;database server name&#39;, pstr_username=&#39;username&#39;, pstr_password=&#39;password&#39;)</span>
<span class="sd">        |  9. create_db_connection(&#39;cassandra&#39;, &#39;database server name&#39;, pstr_database_name=&#39;database name&#39;, pstr_username=&#39;username&#39;, pstr_password=&#39;password&#39;)</span>

<span class="sd">    .. notes::</span>
<span class="sd">        |  Encoding format option is available only for oracle connection for now.</span>
<span class="sd">        |  mssql method expects password in url encoded format, here urllib.parse.quote_plus() is encoding the passwords with special characters &amp; non-ASCII text.</span>
<span class="sd">        |  pbool_ispasswordencoded is set to False by default for mssql db connection method:mssql.</span>
<span class="sd">        |  If user chooses to pass password as, for ex:Welcome%40123 instead of Welcome@123(original one, un-encoded format), pbool_ispasswordencoded should be set to False.</span>
<span class="sd">        |  If pbool_ispasswordencoded is True, then given uncoded password will be encoded to be parsed correctly to the connection string.</span>
<span class="sd">        |  If user chooses to pass password as it is ie., in un-encoded format for ex:Welcome@123 then, pbool_ispasswordencoded should be set to True.</span>

<span class="sd">    .. warning::</span>
<span class="sd">        |  Old reference - Oracle instant client is a must be available on the host for oracle connection. Refer to the documentation at https://cx-oracle.readthedocs.io/en/latest/installation.html#installing-cx-oracle-on-windows to understand the setup process.</span>
<span class="sd">    	|  Latest reference - Oracle instant client is a must be available on the host for oracle connection. Refer to the documentation at https://cx-oracle.readthedocs.io/en/latest/user_guide/installation.html#installing-cx-oracle-on-windows to understand the setup process.</span>
<span class="sd">        |  pint_control_timeout - This parameter is only for cassandra which states the timeout for scheme quering for nodes.This can be inform of float as well</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">pstr_database_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pstr_database_name&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">pstr_username</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pstr_username&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">pstr_password</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pstr_password&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">pint_port_number</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pint_port_number&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">pbool_ispasswordencoded</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pbool_ispasswordencoded&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">ppem_file</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ppem_file&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">psecret_key</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;psecret_key&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">pstr_sid</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pstr_sid&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">pstr_service_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pstr_service_name&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">pstr_encoding</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pstr_encoding&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">int_control_timeout</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pint_control_timeout&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">int_query_timeout</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pint_control_timeout&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">db_connection</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">pstr_database_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_database_type</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">pstr_server_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_server_name</span><span class="p">()</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">pstr_database_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;mssql&quot;</span><span class="p">,</span> <span class="s2">&quot;mysql&quot;</span><span class="p">,</span> <span class="s2">&quot;oracle&quot;</span><span class="p">,</span> <span class="s2">&quot;postgres&quot;</span><span class="p">,</span> <span class="s2">&quot;cassandra&quot;</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">pstr_username</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">pstr_password</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_password</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">pbool_ispasswordencoded</span> <span class="ow">and</span> <span class="n">psecret_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pstr_database_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;mssql&#39;</span><span class="p">,</span> <span class="s1">&#39;mysql&#39;</span><span class="p">,</span> <span class="s1">&#39;oracle&#39;</span><span class="p">,</span> <span class="s1">&#39;postgres&#39;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_secret_key</span><span class="p">()</span>

        <span class="c1"># Actual database connections start from here</span>
        <span class="c1"># Check for MS SQL</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">pstr_database_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;mssql&quot;</span><span class="p">]):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">pstr_database_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_database_name</span><span class="p">()</span>

            <span class="n">db_connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mssql</span><span class="p">(</span><span class="n">pstr_server_name</span><span class="p">,</span> <span class="n">pstr_database_name</span><span class="p">,</span> <span class="n">pint_port_number</span><span class="o">=</span><span class="n">pint_port_number</span><span class="p">,</span>
                                       <span class="n">pstr_username</span><span class="o">=</span><span class="n">pstr_username</span><span class="p">,</span> <span class="n">pstr_password</span><span class="o">=</span><span class="n">pstr_password</span><span class="p">,</span>
                                       <span class="n">bool_ispasswordencode</span><span class="o">=</span><span class="n">pbool_ispasswordencoded</span><span class="p">,</span>
                                       <span class="n">pint_control_timeout</span><span class="o">=</span><span class="n">int_query_timeout</span><span class="p">)</span>

        <span class="c1"># Check for MySQL</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">pstr_database_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;mysql&quot;</span><span class="p">]):</span>
            <span class="n">db_connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mysql</span><span class="p">(</span><span class="n">pstr_server_name</span><span class="p">,</span> <span class="n">pstr_database_name</span><span class="p">,</span> <span class="n">pint_port_number</span><span class="o">=</span><span class="n">pint_port_number</span><span class="p">,</span>
                                       <span class="n">pstr_username</span><span class="o">=</span><span class="n">pstr_username</span><span class="p">,</span> <span class="n">pstr_password</span><span class="o">=</span><span class="n">pstr_password</span><span class="p">,</span>
                                       <span class="n">bool_ispasswordencode</span><span class="o">=</span><span class="n">pbool_ispasswordencoded</span><span class="p">)</span>

        <span class="c1"># Check for Oracle</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">pstr_database_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;oracle&quot;</span><span class="p">]):</span>

            <span class="k">if</span> <span class="n">pstr_sid</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">pstr_service_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_service_name</span><span class="p">()</span>

            <span class="n">db_connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">oracle</span><span class="p">(</span><span class="n">pstr_server_name</span><span class="p">,</span> <span class="n">pstr_username</span><span class="o">=</span><span class="n">pstr_username</span><span class="p">,</span> <span class="n">pstr_password</span><span class="o">=</span><span class="n">pstr_password</span><span class="p">,</span>
                                        <span class="n">pint_port_number</span><span class="o">=</span><span class="n">pint_port_number</span><span class="p">,</span> <span class="n">pstr_sid</span><span class="o">=</span><span class="n">pstr_sid</span><span class="p">,</span>
                                        <span class="n">pstr_service_name</span><span class="o">=</span><span class="n">pstr_service_name</span><span class="p">,</span> <span class="n">pstr_encoding</span><span class="o">=</span><span class="n">pstr_encoding</span><span class="p">,</span>
                                        <span class="n">bool_ispasswordencode</span><span class="o">=</span><span class="n">pbool_ispasswordencoded</span><span class="p">)</span>

        <span class="c1"># check for Hive</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">pstr_database_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;hive&quot;</span><span class="p">,</span> <span class="s2">&quot;spark&quot;</span><span class="p">,</span> <span class="s2">&quot;ec2_hive&quot;</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">pstr_password</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ppem_file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span>
                    <span class="s2">&quot;For hive/Spark/ec2_hive, Password and ppem file cannot be null&quot;</span><span class="p">)</span>

            <span class="n">db_connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hiveconnection</span><span class="p">(</span><span class="n">pstr_server_name</span><span class="p">,</span> <span class="n">pstr_username</span><span class="o">=</span><span class="n">pstr_username</span><span class="p">,</span>
                                                <span class="n">pstr_password</span><span class="o">=</span><span class="n">pstr_password</span><span class="p">,</span> <span class="n">ppem_file</span><span class="o">=</span><span class="n">ppem_file</span><span class="p">,</span>
                                                <span class="n">bool_ispasswordencode</span><span class="o">=</span><span class="n">pbool_ispasswordencoded</span><span class="p">,</span>
                                                <span class="n">psecret_key</span><span class="o">=</span><span class="n">psecret_key</span><span class="p">,</span> <span class="n">pint_port_number</span><span class="o">=</span><span class="n">pint_port_number</span><span class="p">)</span>

        <span class="c1"># Check for postgres</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">pstr_database_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;postgres&quot;</span><span class="p">]):</span>
            <span class="n">db_connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">postgres</span><span class="p">(</span><span class="n">pstr_server_name</span><span class="p">,</span> <span class="n">pstr_database_name</span><span class="p">,</span> <span class="n">pstr_username</span><span class="o">=</span><span class="n">pstr_username</span><span class="p">,</span>
                                          <span class="n">pstr_password</span><span class="o">=</span><span class="n">pstr_password</span><span class="p">,</span> <span class="n">pint_port_number</span><span class="o">=</span><span class="n">pint_port_number</span><span class="p">,</span>
                                          <span class="n">bool_ispasswordencode</span><span class="o">=</span><span class="n">pbool_ispasswordencoded</span><span class="p">)</span>

        <span class="c1"># Check for cassandra</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">pstr_database_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;cassandra&quot;</span><span class="p">]):</span>
            <span class="n">db_connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cassandra</span><span class="p">(</span><span class="n">pstr_server_name</span><span class="p">,</span> <span class="n">pstr_database_name</span><span class="p">,</span> <span class="n">pstr_username</span><span class="o">=</span><span class="n">pstr_username</span><span class="p">,</span>
                                           <span class="n">pstr_password</span><span class="o">=</span><span class="n">pstr_password</span><span class="p">,</span> <span class="n">pint_port_number</span><span class="o">=</span><span class="n">pint_port_number</span><span class="p">,</span>
                                           <span class="n">pint_control_timeout</span><span class="o">=</span><span class="n">int_control_timeout</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_invalid_database_type</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">db_connection</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cafex_db.database_handler.DatabaseHandler.data_frame_diff" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">data_frame_diff</span><span class="p">(</span><span class="n">pdf_dataframe_source</span><span class="p">,</span> <span class="n">pdf_dataframe_destinition</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">



<details class="description" open>
  <summary>Description</summary>
  <p>|  This method lets user compare two Dataframes and returns the difference in the form of a Dataframe.</p>
</details>        <p>:param pdf_dataframe_source:
:type pdf_dataframe_source: pandas Dataframe
:param pdf_dataframe_destinition:
:type pdf_dataframe_destinition: pandas Dataframe
:param plist_headers:
:type plist_headers: kwargs
:param plist_headers_source:
:type plist_headers_source: kwargs
:param plist_headers_target:
:type plist_headers_target: kwargs
:param pint_rowcount:
:type pint_rowcount: kwargs</p>
<p>:return: Dataframe</p>
<p>.. notes::
    |  If there is no difference, then None will be returned.</p>
<p>.. warning::
        |  DO NOT try to call this method directly, this is a helper method for compare_resultlists()</p>

            <details class="quote">
              <summary>Source code in <code>cafex_db\database_handler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">data_frame_diff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdf_dataframe_source</span><span class="p">,</span> <span class="n">pdf_dataframe_destinition</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Description:</span>
<span class="sd">        |  This method lets user compare two Dataframes and returns the difference in the form of a Dataframe.</span>

<span class="sd">    :param pdf_dataframe_source:</span>
<span class="sd">    :type pdf_dataframe_source: pandas Dataframe</span>
<span class="sd">    :param pdf_dataframe_destinition:</span>
<span class="sd">    :type pdf_dataframe_destinition: pandas Dataframe</span>
<span class="sd">    :param plist_headers:</span>
<span class="sd">    :type plist_headers: kwargs</span>
<span class="sd">    :param plist_headers_source:</span>
<span class="sd">    :type plist_headers_source: kwargs</span>
<span class="sd">    :param plist_headers_target:</span>
<span class="sd">    :type plist_headers_target: kwargs</span>
<span class="sd">    :param pint_rowcount:</span>
<span class="sd">    :type pint_rowcount: kwargs</span>


<span class="sd">    :return: Dataframe</span>

<span class="sd">    .. notes::</span>
<span class="sd">        |  If there is no difference, then None will be returned.</span>

<span class="sd">    .. warning::</span>
<span class="sd">    	|  DO NOT try to call this method directly, this is a helper method for compare_resultlists()</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">list_headers</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plist_headers&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">list_headers_source</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plist_headers_source&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">list_headers_target</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;plist_headers_target&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">int_rowcount</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pint_rowcount&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">bool_ignore_datatype</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pbool_ignore_datatype&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">df_stacked_dataframe</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">list_headers</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">list_headers_source</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">list_headers_target</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">bool_ignore_datatype</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">source_types</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pdf_dataframe_source</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
                <span class="n">target_types</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pdf_dataframe_destinition</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
                <span class="n">series_common_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__datatype_conversion</span><span class="p">(</span><span class="n">source_types</span><span class="p">,</span> <span class="n">target_types</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">series_common_type</span><span class="p">)):</span>
                    <span class="n">pdf_dataframe_source</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pdf_dataframe_source</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">series_common_type</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="n">pdf_dataframe_destinition</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pdf_dataframe_destinition</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">series_common_type</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">int_rowcount</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">int_rowcount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">bool_differences</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="n">pdf_dataframe_source</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">int_rowcount</span><span class="p">)</span> <span class="o">!=</span> <span class="n">pdf_dataframe_destinition</span><span class="o">.</span><span class="n">head</span><span class="p">(</span>
                    <span class="n">int_rowcount</span><span class="p">))</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
                <span class="n">df_stacked_dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">pdf_dataframe_source</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">int_rowcount</span><span class="p">)</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="n">bool_differences</span><span class="p">],</span>
                     <span class="n">pdf_dataframe_destinition</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">int_rowcount</span><span class="p">)</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="n">bool_differences</span><span class="p">]],</span>
                    <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">df_stacked_dataframe</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Source_resultset&quot;</span><span class="p">,</span> <span class="s2">&quot;Target_resultset&quot;</span><span class="p">]</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">bool_differences</span> <span class="o">=</span> <span class="p">(</span><span class="n">pdf_dataframe_source</span> <span class="o">!=</span> <span class="n">pdf_dataframe_destinition</span><span class="p">)</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
                <span class="n">df_stacked_dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pdf_dataframe_source</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="n">bool_differences</span><span class="p">],</span>
                                                  <span class="n">pdf_dataframe_destinition</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="n">bool_differences</span><span class="p">]],</span>
                                                 <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">df_stacked_dataframe</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Source_resultset&quot;</span><span class="p">,</span> <span class="s2">&quot;Target_resultset&quot;</span><span class="p">]</span>

        <span class="k">elif</span> <span class="p">(</span><span class="n">list_headers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">list_headers_source</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">list_headers_target</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">bool_ignore_datatype</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">source_types</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pdf_dataframe_source</span><span class="p">[</span><span class="n">list_headers</span><span class="p">]</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
                <span class="n">target_types</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pdf_dataframe_destinition</span><span class="p">[</span><span class="n">list_headers</span><span class="p">]</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
                <span class="n">series_common_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__datatype_conversion</span><span class="p">(</span><span class="n">source_types</span><span class="p">,</span> <span class="n">target_types</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">series_common_type</span><span class="p">)):</span>
                    <span class="n">pdf_dataframe_source</span><span class="p">[</span><span class="n">list_headers</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">pdf_dataframe_source</span><span class="p">[</span><span class="n">list_headers</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span>
                        <span class="n">series_common_type</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="n">pdf_dataframe_destinition</span><span class="p">[</span><span class="n">list_headers</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">pdf_dataframe_destinition</span><span class="p">[</span><span class="n">list_headers</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span>
                        <span class="n">series_common_type</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">int_rowcount</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">int_rowcount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">bool_differences</span> <span class="o">=</span> <span class="p">(</span><span class="n">pdf_dataframe_source</span><span class="p">[</span><span class="n">list_headers</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">int_rowcount</span><span class="p">)</span> <span class="o">!=</span>
                                    <span class="n">pdf_dataframe_destinition</span><span class="p">[</span>
                                        <span class="n">list_headers</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">int_rowcount</span><span class="p">))</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
                <span class="n">df_stacked_dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">pdf_dataframe_source</span><span class="p">[</span><span class="n">list_headers</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">int_rowcount</span><span class="p">)</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="n">bool_differences</span><span class="p">],</span>
                     <span class="n">pdf_dataframe_destinition</span><span class="p">[</span><span class="n">list_headers</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">int_rowcount</span><span class="p">)</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span>
                         <span class="n">bool_differences</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">df_stacked_dataframe</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Source_resultset&quot;</span><span class="p">,</span> <span class="s2">&quot;Target_resultset&quot;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">bool_differences</span> <span class="o">=</span> <span class="p">(</span><span class="n">pdf_dataframe_source</span><span class="p">[</span><span class="n">list_headers</span><span class="p">]</span> <span class="o">!=</span> <span class="n">pdf_dataframe_destinition</span><span class="p">[</span>
                    <span class="n">list_headers</span><span class="p">])</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
                <span class="n">df_stacked_dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">pdf_dataframe_source</span><span class="p">[</span><span class="n">list_headers</span><span class="p">]</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="n">bool_differences</span><span class="p">],</span>
                     <span class="n">pdf_dataframe_destinition</span><span class="p">[</span><span class="n">list_headers</span><span class="p">]</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="n">bool_differences</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">df_stacked_dataframe</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Source_resultset&quot;</span><span class="p">,</span> <span class="s2">&quot;Target_resultset&quot;</span><span class="p">]</span>

        <span class="k">elif</span> <span class="p">(</span><span class="n">list_headers</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">list_headers_source</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">list_headers_target</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">bool_ignore_datatype</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">source_types</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pdf_dataframe_source</span><span class="p">[</span><span class="n">list_headers_source</span><span class="p">]</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
                <span class="n">target_types</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pdf_dataframe_destinition</span><span class="p">[</span><span class="n">list_headers_target</span><span class="p">]</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
                <span class="n">series_common_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__datatype_conversion</span><span class="p">(</span><span class="n">source_types</span><span class="p">,</span> <span class="n">target_types</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">series_common_type</span><span class="p">)):</span>
                    <span class="n">pdf_dataframe_source</span><span class="p">[</span><span class="n">list_headers_source</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">pdf_dataframe_source</span><span class="p">[</span>
                        <span class="n">list_headers_source</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">series_common_type</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="n">pdf_dataframe_destinition</span><span class="p">[</span><span class="n">list_headers_target</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">pdf_dataframe_destinition</span><span class="p">[</span>
                        <span class="n">list_headers_target</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">series_common_type</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

            <span class="k">if</span> <span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">list_headers_source</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
                    <span class="nb">len</span><span class="p">(</span><span class="n">list_headers_source</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_headers_target</span><span class="p">))):</span>
                <span class="k">if</span> <span class="n">int_rowcount</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">int_rowcount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">list_difference</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">list_diff_headers</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_headers_source</span><span class="p">)):</span>
                        <span class="n">temp_diff</span> <span class="o">=</span> <span class="n">pdf_dataframe_source</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">int_rowcount</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                            <span class="n">list_headers_source</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">!=</span> <span class="n">pdf_dataframe_destinition</span><span class="o">.</span><span class="n">head</span><span class="p">(</span>
                            <span class="n">int_rowcount</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                            <span class="n">list_headers_target</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                        <span class="n">list_difference</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                            <span class="n">pdf_dataframe_source</span><span class="p">[</span><span class="n">list_headers_source</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">int_rowcount</span><span class="p">)[</span>
                                <span class="n">temp_diff</span><span class="p">])</span>
                        <span class="n">list_difference</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                            <span class="n">pdf_dataframe_destinition</span><span class="p">[</span><span class="n">list_headers_target</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">int_rowcount</span><span class="p">)[</span>
                                <span class="n">temp_diff</span><span class="p">])</span>
                        <span class="n">list_diff_headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;source_resultset/&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">list_headers_source</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                        <span class="n">list_diff_headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;target_resultset/&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">list_headers_target</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                    <span class="c1"># df_stacked_dataframe = pd.DataFrame(list_difference,index= list_diff_headers).transpose()</span>

                    <span class="n">df_stacked_dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">list_difference</span><span class="p">,</span>
                                                        <span class="n">index</span><span class="o">=</span><span class="n">list_diff_headers</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span>
                        <span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">df_stacked_dataframe</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">df_stacked_dataframe</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">list_difference</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">list_diff_headers</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_headers_source</span><span class="p">)):</span>
                        <span class="n">temp_diff</span> <span class="o">=</span> <span class="n">pdf_dataframe_source</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                            <span class="n">list_headers_source</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">!=</span> <span class="n">pdf_dataframe_destinition</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                            <span class="n">list_headers_target</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                        <span class="n">source_series</span> <span class="o">=</span> <span class="n">pdf_dataframe_source</span><span class="p">[</span><span class="n">list_headers_source</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="n">temp_diff</span><span class="p">]</span>
                        <span class="n">target_series</span> <span class="o">=</span> <span class="n">pdf_dataframe_destinition</span><span class="p">[</span><span class="n">list_headers_target</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="n">temp_diff</span><span class="p">]</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">source_series</span><span class="o">.</span><span class="n">empty</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">target_series</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                            <span class="n">list_difference</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">source_series</span><span class="p">)</span>
                            <span class="n">list_difference</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">target_series</span><span class="p">)</span>
                            <span class="n">list_diff_headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;source_resultset_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">list_headers_source</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                            <span class="n">list_diff_headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;target_resultset_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">list_headers_target</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                    <span class="c1"># df_stacked_dataframe = pd.DataFrame(list_difference,index= list_diff_headers).transpose()</span>
                    <span class="n">df_stacked_dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">list_difference</span><span class="p">,</span>
                                                        <span class="n">index</span><span class="o">=</span><span class="n">list_diff_headers</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span>
                        <span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">df_stacked_dataframe</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">df_stacked_dataframe</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                        <span class="n">df_stacked_dataframe</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Looks like there is a conflict in the kwargs parameters&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">df_stacked_dataframe</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cafex_db.database_handler.DatabaseHandler.dataframe_to_csv" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dataframe_to_csv</span><span class="p">(</span><span class="n">pdf_dataframe</span><span class="p">,</span> <span class="n">pstr_path</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">



<details class="description" open>
  <summary>Description</summary>
  <p>|  This method writes Dataframe to a csv file.</p>
</details>        <p>:param pdf_dataframe:
:type pdf_dataframe: Dataframe
:param pstr_filepath:
:type pstr_filepath: String</p>
<p>:return: CSV File</p>
<p>.. notes::
    |  Make sure to pass pstr_filepath with filename and extension as csv.</p>

            <details class="quote">
              <summary>Source code in <code>cafex_db\database_handler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">dataframe_to_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdf_dataframe</span><span class="p">,</span> <span class="n">pstr_path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Description:</span>
<span class="sd">        |  This method writes Dataframe to a csv file.</span>

<span class="sd">    :param pdf_dataframe:</span>
<span class="sd">    :type pdf_dataframe: Dataframe</span>
<span class="sd">    :param pstr_filepath:</span>
<span class="sd">    :type pstr_filepath: String</span>


<span class="sd">    :return: CSV File</span>

<span class="sd">    .. notes::</span>
<span class="sd">        |  Make sure to pass pstr_filepath with filename and extension as csv.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">pdf_dataframe</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_dataframe</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">pstr_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_filepath</span><span class="p">()</span>
        <span class="n">pdf_dataframe</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">pstr_path</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cafex_db.database_handler.DatabaseHandler.execute_query_from_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">execute_query_from_file</span><span class="p">(</span><span class="n">pobject_connection</span><span class="p">,</span> <span class="n">pstr_filepath</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">



<details class="description" open>
  <summary>Description</summary>
  <p>|  This method allows user to execute a query available in a file.</p>
</details>        <p>:param pobject_connection:
:type pobject_connection: Database Connection Object
:param pstr_filepath:
:type pstr_filepath: String
:type pstr_return_type: String</p>
<p>:return: ResultSet</p>
<p>.. notes::
    |  This method returns a list or a resultset based on the parameter pstr_return_type. 'select' statements will returns List/Resultset and other type of statements will return Boolean.
    |
    |  This method accepts only text/sql files.</p>

            <details class="quote">
              <summary>Source code in <code>cafex_db\database_handler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">execute_query_from_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pobject_connection</span><span class="p">,</span> <span class="n">pstr_filepath</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Description:</span>
<span class="sd">        |  This method allows user to execute a query available in a file.</span>

<span class="sd">    :param pobject_connection:</span>
<span class="sd">    :type pobject_connection: Database Connection Object</span>
<span class="sd">    :param pstr_filepath:</span>
<span class="sd">    :type pstr_filepath: String</span>
<span class="sd">    :type pstr_return_type: String</span>


<span class="sd">    :return: ResultSet</span>

<span class="sd">    .. notes::</span>
<span class="sd">        |  This method returns a list or a resultset based on the parameter pstr_return_type. &#39;select&#39; statements will returns List/Resultset and other type of statements will return Boolean.</span>
<span class="sd">        |</span>
<span class="sd">        |  This method accepts only text/sql files.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">pstr_filepath</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_filepath</span><span class="p">()</span>

        <span class="n">str_filepath</span> <span class="o">=</span> <span class="n">pstr_filepath</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">pobject_connection</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_database_object</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">str_filepath</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;.sql&#39;</span><span class="p">,</span> <span class="s1">&#39;.txt&#39;</span><span class="p">)):</span>
            <span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">str_filepath</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                    <span class="n">query</span> <span class="o">=</span> <span class="n">query</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">line</span>
            <span class="n">resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobject_connection</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span>
                                               <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>  <span class="c1"># pobject_connection.cursor().execute(query)</span>
            <span class="k">return</span> <span class="n">resultset</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Accepted file formats are .sql and .txt&quot;</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cafex_db.database_handler.DatabaseHandler.execute_statement" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobject_connection</span><span class="p">,</span> <span class="n">psql_query</span><span class="p">,</span> <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;list&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">



<details class="description" open>
  <summary>Description</summary>
  <p>|  This method allows user to execute a database query statement.</p>
</details>        <p>:param pobject_connection:
:type pobject_connection: Database Connection Object
:param psql_query:
:type psql_query: String
:param pstr_return_type: list/resultset
:type pstr_return_type: String</p>
<p>:return: List or ResultSet or Boolean</p>
<p>.. notes::
        |  This method returns a list or a resultset based on the parameter pstr_return_type. 'select' statements will returns List/Resultset and other type of statements will return Boolean.</p>
<p>.. warning::
        |  This method can not be used to execute HIVE statements.</p>

            <details class="quote">
              <summary>Source code in <code>cafex_db\database_handler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span></pre></div></td><td class="code"><div><pre><span></span><code>    <span class="k">def</span> <span class="nf">execute_statement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pobject_connection</span><span class="p">,</span> <span class="n">psql_query</span><span class="p">,</span> <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;list&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Description:</span>
<span class="sd">            |  This method allows user to execute a database query statement.</span>

<span class="sd">        :param pobject_connection:</span>
<span class="sd">        :type pobject_connection: Database Connection Object</span>
<span class="sd">        :param psql_query:</span>
<span class="sd">        :type psql_query: String</span>
<span class="sd">        :param pstr_return_type: list/resultset</span>
<span class="sd">        :type pstr_return_type: String</span>


<span class="sd">        :return: List or ResultSet or Boolean</span>

<span class="sd">        .. notes::</span>
<span class="sd">        	|  This method returns a list or a resultset based on the parameter pstr_return_type. &#39;select&#39; statements will returns List/Resultset and other type of statements will return Boolean.</span>

<span class="sd">        .. warning::</span>
<span class="sd">	        |  This method can not be used to execute HIVE statements.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">pobject_connection</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_database_object</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">psql_query</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_query</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">pstr_return_type</span> <span class="ow">is</span> <span class="s1">&#39;list&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">psql_query</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;select&#39;</span><span class="p">):</span>
                    <span class="n">resultset</span> <span class="o">=</span> <span class="n">pobject_connection</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">psql_query</span><span class="p">)</span>
                    <span class="k">if</span> <span class="s1">&#39;cassandra&#39;</span> <span class="ow">in</span> <span class="nb">repr</span><span class="p">(</span><span class="n">pobject_connection</span><span class="p">):</span>
                        <span class="n">datalist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cassandra_resultset_to_list</span><span class="p">(</span><span class="n">resultset</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">datalist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resultset_to_list</span><span class="p">(</span><span class="n">resultset</span><span class="p">,</span> <span class="n">pbool_include_headers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="n">datalist</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span>
                        <span class="s2">&quot;For pstr_return_type == &#39;list&#39;, only select statements are allowed&quot;</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">pstr_return_type</span> <span class="ow">is</span> <span class="s1">&#39;resultset&#39;</span><span class="p">:</span>

                <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">psql_query</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;select&#39;</span><span class="p">):</span>
                    <span class="n">resultset</span> <span class="o">=</span> <span class="n">pobject_connection</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">psql_query</span><span class="p">)</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="n">resultset</span>
                <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">psql_query</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;insert&#39;</span><span class="p">):</span>
                    <span class="n">resultset</span> <span class="o">=</span> <span class="n">pobject_connection</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">psql_query</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">resultset</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Successully inserted&quot;</span><span class="p">)</span>
                        <span class="n">result</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">psql_query</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;update&#39;</span><span class="p">):</span>
                    <span class="n">resultset</span> <span class="o">=</span> <span class="n">pobject_connection</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">psql_query</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">resultset</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Successully Updated&quot;</span><span class="p">)</span>
                        <span class="n">result</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">psql_query</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;delete&#39;</span><span class="p">):</span>
                    <span class="n">pobject_connection</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">psql_query</span><span class="p">)</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">resultset</span> <span class="o">=</span> <span class="n">pobject_connection</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">psql_query</span><span class="p">)</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="n">resultset</span>

            <span class="k">return</span> <span class="n">result</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cafex_db.database_handler.DatabaseHandler.get_column_data" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_column_data</span><span class="p">(</span><span class="n">plist_resultlist</span><span class="p">,</span> <span class="n">pstr_column_header</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">



<details class="description" open>
  <summary>Description</summary>
  <p>|  This method returns all the values in a column header.</p>
</details>        <p>:param plist_resultlist:
:type plist_resultlist: Result List
:param pstr_column_header:
:type pstr_column_header: String</p>
<p>:return: List</p>

            <details class="quote">
              <summary>Source code in <code>cafex_db\database_handler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_column_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plist_resultlist</span><span class="p">,</span> <span class="n">pstr_column_header</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Description:</span>
<span class="sd">        |  This method returns all the values in a column header.</span>

<span class="sd">    :param plist_resultlist:</span>
<span class="sd">    :type plist_resultlist: Result List</span>
<span class="sd">    :param pstr_column_header:</span>
<span class="sd">    :type pstr_column_header: String</span>


<span class="sd">    :return: List</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">plist_resultlist</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_resultlist</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">pstr_column_header</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_column_header</span><span class="p">()</span>

        <span class="n">list_resultset_data</span> <span class="o">=</span> <span class="n">plist_resultlist</span>
        <span class="n">int_resultset_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_resultset_data</span><span class="p">)</span>
        <span class="n">pdf_resultset_dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">list_resultset_data</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">int_resultset_length</span><span class="p">],</span>
                                               <span class="n">columns</span><span class="o">=</span><span class="n">list_resultset_data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">list_coldata</span> <span class="o">=</span> <span class="n">pdf_resultset_dataframe</span><span class="p">[</span><span class="n">pstr_column_header</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="k">return</span> <span class="n">list_coldata</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cafex_db.database_handler.DatabaseHandler.get_headers" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_headers</span><span class="p">(</span><span class="n">plist_resultlist</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">



<details class="description" open>
  <summary>Description</summary>
  <p>|  This method returns list of headers in a result list.</p>
</details>        <p>:param plist_resultlist:
:type plist_resultlist: List</p>
<p>:return: List</p>

            <details class="quote">
              <summary>Source code in <code>cafex_db\database_handler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_headers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plist_resultlist</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Description:</span>
<span class="sd">        |  This method returns list of headers in a result list.</span>

<span class="sd">    :param plist_resultlist:</span>
<span class="sd">    :type plist_resultlist: List</span>


<span class="sd">    :return: List</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">plist_resultlist</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_resultlist</span><span class="p">()</span>
        <span class="n">lst_headers</span> <span class="o">=</span> <span class="n">plist_resultlist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">lst_headers</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cafex_db.database_handler.DatabaseHandler.get_rowcount" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_rowcount</span><span class="p">(</span><span class="n">plist_resultlist</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">



<details class="description" open>
  <summary>Description</summary>
  <p>|  This method returns the count of rows in a result list.</p>
</details>        <p>:param plist_resultlist: This is a List that contains column headers and row values
:type plist_resultlist: List</p>
<p>:return: Integer</p>

            <details class="quote">
              <summary>Source code in <code>cafex_db\database_handler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_rowcount</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plist_resultlist</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Description:</span>
<span class="sd">        |  This method returns the count of rows in a result list.</span>

<span class="sd">    :param plist_resultlist: This is a List that contains column headers and row values</span>
<span class="sd">    :type plist_resultlist: List</span>


<span class="sd">    :return: Integer</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">plist_resultlist</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_resultlist</span><span class="p">()</span>
        <span class="n">int_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">plist_resultlist</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">int_length</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cafex_db.database_handler.DatabaseHandler.hive_execute_statement" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">hive_execute_statement</span><span class="p">(</span><span class="n">pobject_hiveclient</span><span class="p">,</span> <span class="n">p_query</span><span class="p">,</span> <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">



<details class="description" open>
  <summary>Description</summary>
  <p>|  This method allows user to execute a HIVE database query statement.</p>
</details>        <p>:param pobject_hiveclient:
:type pobject_hiveclient: Hive Database Connection Object
:param p_query:
:type p_query: String
:param pstr_return_type: list/resultset
:type pstr_return_type: String
:param pbool_include_header: default value is False, if set to true will print the headers also
:type pbool_include_header: kwargs:bool
:param pstr_server_connect: If the user needs to connect to a server then he can send the command to this pararmeter
:type pstr_server_connect: kwargs:string</p>
<p>:return: List or ResultSet or Boolean</p>
<p>.. notes::
    |  This method returns a list or a resultset based on the parameter pstr_return_type. 'select' statements will returns List/Resultset and other type of statements will return Boolean.</p>

            <details class="quote">
              <summary>Source code in <code>cafex_db\database_handler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">hive_execute_statement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pobject_hiveclient</span><span class="p">,</span> <span class="n">p_query</span><span class="p">,</span> <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Description:</span>
<span class="sd">        |  This method allows user to execute a HIVE database query statement.</span>

<span class="sd">    :param pobject_hiveclient:</span>
<span class="sd">    :type pobject_hiveclient: Hive Database Connection Object</span>
<span class="sd">    :param p_query:</span>
<span class="sd">    :type p_query: String</span>
<span class="sd">    :param pstr_return_type: list/resultset</span>
<span class="sd">    :type pstr_return_type: String</span>
<span class="sd">    :param pbool_include_header: default value is False, if set to true will print the headers also</span>
<span class="sd">    :type pbool_include_header: kwargs:bool</span>
<span class="sd">    :param pstr_server_connect: If the user needs to connect to a server then he can send the command to this pararmeter</span>
<span class="sd">    :type pstr_server_connect: kwargs:string</span>


<span class="sd">    :return: List or ResultSet or Boolean</span>

<span class="sd">    .. notes::</span>
<span class="sd">        |  This method returns a list or a resultset based on the parameter pstr_return_type. &#39;select&#39; statements will returns List/Resultset and other type of statements will return Boolean.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">bool_include_header</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pbool_include_header&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">str_server_connect</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pstr_server_connect&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">pobject_hiveclient</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_hive_object</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">p_query</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_query</span><span class="p">()</span>

        <span class="n">pobject_hiveclient</span><span class="o">.</span><span class="n">invoke_shell</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">str_server_connect</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pobject_hiveclient</span><span class="o">.</span><span class="n">exec_command</span><span class="p">(</span><span class="n">str_server_connect</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bool_include_header</span><span class="p">:</span>
            <span class="n">pobject_hiveclient</span><span class="o">.</span><span class="n">exec_command</span><span class="p">(</span><span class="s1">&#39;set hive.cli.print.header=true;&#39;</span><span class="p">)</span>

        <span class="n">stdin</span><span class="p">,</span> <span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span> <span class="o">=</span> <span class="n">pobject_hiveclient</span><span class="o">.</span><span class="n">exec_command</span><span class="p">(</span><span class="s1">&#39;hive -e </span><span class="se">\&#39;</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">p_query</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">rs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe_to_resultset</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pstr_return_type</span> <span class="o">==</span> <span class="s1">&#39;list&#39;</span><span class="p">:</span>
            <span class="n">rs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resultset_to_list</span><span class="p">(</span><span class="n">rs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rs</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cafex_db.database_handler.DatabaseHandler.hiveconnection" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">hiveconnection</span><span class="p">(</span><span class="n">pstr_server_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">



<details class="description" open>
  <summary>Description</summary>
  <p>|  This method deals with creating a connection to HIVE database using the SSH protocol</p>
</details>        <p>:return: Database Connection Object</p>
<p>.. notes::
        |  For input parameters, refer to the method description of create_db_connection</p>

            <details class="quote">
              <summary>Source code in <code>cafex_db\database_handler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">hiveconnection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pstr_server_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Description:</span>
<span class="sd">        |  This method deals with creating a connection to HIVE database using the SSH protocol</span>

<span class="sd">    :return: Database Connection Object</span>

<span class="sd">    .. notes::</span>
<span class="sd">    	|  For input parameters, refer to the method description of create_db_connection</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">HiveClient</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_decrytor</span><span class="o">.</span><span class="n">hive_connection</span><span class="p">(</span><span class="n">pstr_server_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">HiveClient</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cafex_db.database_handler.DatabaseHandler.is_rowcount_zero" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_rowcount_zero</span><span class="p">(</span><span class="n">plist_resultlist</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">



<details class="description" open>
  <summary>Description</summary>
  <p>|  This method checks if the row count is zero or not.</p>
</details>        <p>:param plist_resultlist: This is a List that contains column headers and row values
:type plist_resultlist: List</p>
<p>:return: Boolean</p>

            <details class="quote">
              <summary>Source code in <code>cafex_db\database_handler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_rowcount_zero</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plist_resultlist</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Description:</span>
<span class="sd">        |  This method checks if the row count is zero or not.</span>

<span class="sd">    :param plist_resultlist: This is a List that contains column headers and row values</span>
<span class="sd">    :type plist_resultlist: List</span>


<span class="sd">    :return: Boolean</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">plist_resultlist</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_resultlist</span><span class="p">()</span>

        <span class="n">bln_is_rowcount_zero</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">int_rowcount</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rowcount</span><span class="p">(</span><span class="n">plist_resultlist</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">int_rowcount</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">bln_is_rowcount_zero</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">bln_is_rowcount_zero</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="n">bln_is_rowcount_zero</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cafex_db.database_handler.DatabaseHandler.list_to_dataframe" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">list_to_dataframe</span><span class="p">(</span><span class="n">plist_data</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">



<details class="description" open>
  <summary>Description</summary>
  <p>|  This method is for converting the list to dataframes</p>
</details>        <p>:param plist_data:
:type plist_data: list
:return:  Dataframe</p>
<p>.. warning::
        |  The list which we should pass must be the output of the execute_statement with list as return data</p>

            <details class="quote">
              <summary>Source code in <code>cafex_db\database_handler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">list_to_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plist_data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Description:</span>
<span class="sd">        |  This method is for converting the list to dataframes</span>
<span class="sd">    :param plist_data:</span>
<span class="sd">    :type plist_data: list</span>
<span class="sd">    :return:  Dataframe</span>

<span class="sd">    .. warning::</span>
<span class="sd">    	|  The list which we should pass must be the output of the execute_statement with list as return data</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">plist_data</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">plist_data</span><span class="p">)],</span> <span class="n">columns</span><span class="o">=</span><span class="n">plist_data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cafex_db.database_handler.DatabaseHandler.modify_sql_query" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">modify_sql_query</span><span class="p">(</span><span class="n">pfile_path</span><span class="p">,</span> <span class="n">pdict_data_dictionary</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Description:
|  This function edit sql queries residing inside .sql,.txt or .json files at run time
|  The user has to save the file at a specific location
|  Identify the variables that have to be changed
|  Replace the variables with unique identifiers and save the file
:param pfile_path: File path of the file that will be edited
:type pfile_path: string
:param pdict_data_dictionary: Dictionary in the format of {'unique_identifiers1': 'actual_value1','unique_identifiers2': ' actual_value2'}
:type pdict_data_dictionary: dictionary
:param pstr_key: key in case the query is saved in a json file
:type pstr_key: kwargs
:return: str_query : The query containing the actual value with the unique_Identifiers replaced
:type str_query: string
    Examples:
|  1. Let us imagine we have a sql file or a text file containing query
|  Values that have to changed ; Replace them by Unique_Idetifiers : pstr_emailaddress , pstr_updoperation
|  Actual Values :saurabhpiyush@spglobal.com , 1
|  pdict_data_dictionary = { "pstr_emailaddress" : "saurabhpiyush@spglobal.com","pstr_updoperation" : "1"}
|  Input call : modify_sql_query (pfile_path, pdict_data_dictionary)
|  2. Let us imagine we have a sql query in a json format : {"key1" :"query1","key2" :"query2"}
|  Query that has to be edited : query2
|  Key Selected for query2 = key2
|  pstr_key = key2
|  Input call :  modify_sql_query (pfile_path, pdict_data_dictionary, pstr_key = 'key2' )</p>

            <details class="quote">
              <summary>Source code in <code>cafex_db\database_handler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2022</span>
<span class="normal">2023</span>
<span class="normal">2024</span>
<span class="normal">2025</span>
<span class="normal">2026</span>
<span class="normal">2027</span>
<span class="normal">2028</span>
<span class="normal">2029</span>
<span class="normal">2030</span>
<span class="normal">2031</span>
<span class="normal">2032</span>
<span class="normal">2033</span>
<span class="normal">2034</span>
<span class="normal">2035</span>
<span class="normal">2036</span>
<span class="normal">2037</span>
<span class="normal">2038</span>
<span class="normal">2039</span>
<span class="normal">2040</span>
<span class="normal">2041</span>
<span class="normal">2042</span>
<span class="normal">2043</span>
<span class="normal">2044</span>
<span class="normal">2045</span>
<span class="normal">2046</span>
<span class="normal">2047</span>
<span class="normal">2048</span>
<span class="normal">2049</span>
<span class="normal">2050</span>
<span class="normal">2051</span>
<span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span>
<span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span>
<span class="normal">2062</span>
<span class="normal">2063</span>
<span class="normal">2064</span>
<span class="normal">2065</span>
<span class="normal">2066</span>
<span class="normal">2067</span>
<span class="normal">2068</span>
<span class="normal">2069</span>
<span class="normal">2070</span>
<span class="normal">2071</span>
<span class="normal">2072</span>
<span class="normal">2073</span>
<span class="normal">2074</span>
<span class="normal">2075</span>
<span class="normal">2076</span>
<span class="normal">2077</span>
<span class="normal">2078</span>
<span class="normal">2079</span>
<span class="normal">2080</span>
<span class="normal">2081</span>
<span class="normal">2082</span>
<span class="normal">2083</span>
<span class="normal">2084</span>
<span class="normal">2085</span>
<span class="normal">2086</span>
<span class="normal">2087</span>
<span class="normal">2088</span>
<span class="normal">2089</span>
<span class="normal">2090</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">modify_sql_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pfile_path</span><span class="p">,</span> <span class="n">pdict_data_dictionary</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Description:</span>
<span class="sd">    |  This function edit sql queries residing inside .sql,.txt or .json files at run time</span>
<span class="sd">    |  The user has to save the file at a specific location</span>
<span class="sd">    |  Identify the variables that have to be changed</span>
<span class="sd">    |  Replace the variables with unique identifiers and save the file</span>
<span class="sd">    :param pfile_path: File path of the file that will be edited</span>
<span class="sd">    :type pfile_path: string</span>
<span class="sd">    :param pdict_data_dictionary: Dictionary in the format of {&#39;unique_identifiers1&#39;: &#39;actual_value1&#39;,&#39;unique_identifiers2&#39;: &#39; actual_value2&#39;}</span>
<span class="sd">    :type pdict_data_dictionary: dictionary</span>
<span class="sd">    :param pstr_key: key in case the query is saved in a json file</span>
<span class="sd">    :type pstr_key: kwargs</span>
<span class="sd">    :return: str_query : The query containing the actual value with the unique_Identifiers replaced</span>
<span class="sd">    :type str_query: string</span>
<span class="sd">        Examples:</span>
<span class="sd">    |  1. Let us imagine we have a sql file or a text file containing query</span>
<span class="sd">    |  Values that have to changed ; Replace them by Unique_Idetifiers : pstr_emailaddress , pstr_updoperation</span>
<span class="sd">    |  Actual Values :saurabhpiyush@spglobal.com , 1</span>
<span class="sd">    |  pdict_data_dictionary = { &quot;pstr_emailaddress&quot; : &quot;saurabhpiyush@spglobal.com&quot;,&quot;pstr_updoperation&quot; : &quot;1&quot;}</span>
<span class="sd">    |  Input call : modify_sql_query (pfile_path, pdict_data_dictionary)</span>
<span class="sd">    |  2. Let us imagine we have a sql query in a json format : {&quot;key1&quot; :&quot;query1&quot;,&quot;key2&quot; :&quot;query2&quot;}</span>
<span class="sd">    |  Query that has to be edited : query2</span>
<span class="sd">    |  Key Selected for query2 = key2</span>
<span class="sd">    |  pstr_key = key2</span>
<span class="sd">    |  Input call :  modify_sql_query (pfile_path, pdict_data_dictionary, pstr_key = &#39;key2&#39; )</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">pfile_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_filepath</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="n">pfile_path</span><span class="p">)</span><span class="o">.</span><span class="n">st_size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_query</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">pdict_data_dictionary</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Dictionary passed is None. There is nothing to replace&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pfile_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s1">&#39;.sql&#39;</span><span class="p">,</span> <span class="s1">&#39;.txt&#39;</span><span class="p">)):</span>
            <span class="n">str_query</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">pfile_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                    <span class="n">str_query</span> <span class="o">=</span> <span class="n">str_query</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">line</span>
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="k">elif</span> <span class="n">pfile_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.json&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pstr_key&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">json_key</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pstr_key&#39;</span><span class="p">))</span>
                <span class="n">f1</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">pfile_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
                <span class="n">str_json</span> <span class="o">=</span> <span class="n">f1</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
                <span class="n">f1</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">pstr_json</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">str_json</span><span class="p">)</span>
                    <span class="n">str_query</span> <span class="o">=</span> <span class="n">pstr_json</span><span class="p">[</span><span class="n">json_key</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Not a valid json file or invalid key---&gt;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Error--&gt;Key missing from parameters for json file&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Accepted file formats are .sql, .txt &amp; .json&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">pdict_data_dictionary</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">str_query</span><span class="p">:</span>
                <span class="n">str_query</span> <span class="o">=</span> <span class="n">str_query</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">pdict_data_dictionary</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Unique Identifier--&gt;&#39;</span> <span class="o">+</span> <span class="n">key</span> <span class="o">+</span> <span class="s1">&#39;not found in the query&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">str_query</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span>
            <span class="n">pstr_message</span><span class="o">=</span><span class="s1">&#39;Exception occured in method--&gt; modify_sql_query--&gt;&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span> <span class="n">pbool_insert_kibana</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">pbool_trim_log</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pbool_log_local_exceptions</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">pbool_fail_on_exception</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">pbool_use_pytest_format</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cafex_db.database_handler.DatabaseHandler.mssql" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mssql</span><span class="p">(</span><span class="n">pstr_server_name</span><span class="p">,</span> <span class="n">pstr_database_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">



<details class="description" open>
  <summary>Description</summary>
  <p>|  This method deals with creating a connection to mssql database.</p>
</details>        <p>:return: Database Connection Object</p>
<p>.. notes::
        |  For input parameters, refer to the method description of create_db_connection
        |  Autocommit is set to True</p>

            <details class="quote">
              <summary>Source code in <code>cafex_db\database_handler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">mssql</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pstr_server_name</span><span class="p">,</span> <span class="n">pstr_database_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Description:</span>
<span class="sd">        |  This method deals with creating a connection to mssql database.</span>

<span class="sd">    :return: Database Connection Object</span>

<span class="sd">    .. notes::</span>
<span class="sd">    	|  For input parameters, refer to the method description of create_db_connection</span>
<span class="sd">    	|  Autocommit is set to True</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">mssql_connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_decrytor</span><span class="o">.</span><span class="n">mssql</span><span class="p">(</span><span class="n">pstr_server_name</span><span class="p">,</span> <span class="n">pstr_database_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mssql_connection</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cafex_db.database_handler.DatabaseHandler.mysql" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mysql</span><span class="p">(</span><span class="n">pstr_server_name</span><span class="p">,</span> <span class="n">pstr_database_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">



<details class="description" open>
  <summary>Description</summary>
  <p>|  This method deals with creating a connection to mysql database</p>
</details>        <p>:return: Database Connection Object</p>
<p>.. notes::
        |  For input parameters, refer to the method description of create_db_connection</p>

            <details class="quote">
              <summary>Source code in <code>cafex_db\database_handler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">mysql</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pstr_server_name</span><span class="p">,</span> <span class="n">pstr_database_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Description:</span>
<span class="sd">        |  This method deals with creating a connection to mysql database</span>

<span class="sd">    :return: Database Connection Object</span>

<span class="sd">    .. notes::</span>
<span class="sd">    	|  For input parameters, refer to the method description of create_db_connection</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">mysql_connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_decrytor</span><span class="o">.</span><span class="n">mysql</span><span class="p">(</span><span class="n">pstr_server_name</span><span class="p">,</span> <span class="n">pstr_database_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mysql_connection</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cafex_db.database_handler.DatabaseHandler.oracle" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">oracle</span><span class="p">(</span><span class="n">pstr_server_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">



<details class="description" open>
  <summary>Description</summary>
  <p>|  This method deals with creating a connection to Oracle database</p>
</details>        <p>:return: Database Connection Object</p>
<p>.. notes::
        |  For input parameters, refer to the method description of create_db_connection</p>
<p>.. warning::
        |  Oracle instant client is a must be available on the host where this method is called. Refer to the documentation at https://cx-oracle.readthedocs.io/en/latest/installation.html#installing-cx-oracle-on-windows to understand the setup process.
    |  More information different oracle encoding can be seen at https://www.oracle.com/database/technologies/faq-nls-lang.html.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <p>|  mi_data_ingestion.mi_establish_connection(server,pstr_encoding="utf8")</p>

            <details class="quote">
              <summary>Source code in <code>cafex_db\database_handler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span></pre></div></td><td class="code"><div><pre><span></span><code>    <span class="k">def</span> <span class="nf">oracle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pstr_server_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Description:</span>
<span class="sd">            |  This method deals with creating a connection to Oracle database</span>

<span class="sd">        :return: Database Connection Object</span>

<span class="sd">        .. notes::</span>
<span class="sd">        	|  For input parameters, refer to the method description of create_db_connection</span>


<span class="sd">        .. warning::</span>
<span class="sd">        	|  Oracle instant client is a must be available on the host where this method is called. Refer to the documentation at https://cx-oracle.readthedocs.io/en/latest/installation.html#installing-cx-oracle-on-windows to understand the setup process.</span>
<span class="sd">            |  More information different oracle encoding can be seen at https://www.oracle.com/database/technologies/faq-nls-lang.html.</span>

<span class="sd">        Examples:</span>
<span class="sd">	        |  mi_data_ingestion.mi_establish_connection(server,pstr_encoding=&quot;utf8&quot;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">oracle_connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_decrytor</span><span class="o">.</span><span class="n">oracle</span><span class="p">(</span><span class="n">pstr_server_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">oracle_connection</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cafex_db.database_handler.DatabaseHandler.postgres" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">postgres</span><span class="p">(</span><span class="n">pstr_server_name</span><span class="p">,</span> <span class="n">pstr_database_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">



<details class="description" open>
  <summary>Description</summary>
  <p>|  This method deals with creating a connection to postgres database</p>
</details>        <p>:param pint_port_number: port
:type pint_port_number: kwargs
:return: Database Connection Object</p>
<p>.. notes::
        |  For input parameters, refer to the method description of create_db_connection</p>

            <details class="quote">
              <summary>Source code in <code>cafex_db\database_handler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">postgres</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pstr_server_name</span><span class="p">,</span> <span class="n">pstr_database_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Description:</span>
<span class="sd">        |  This method deals with creating a connection to postgres database</span>

<span class="sd">    :param pint_port_number: port</span>
<span class="sd">    :type pint_port_number: kwargs</span>
<span class="sd">    :return: Database Connection Object</span>

<span class="sd">    .. notes::</span>
<span class="sd">    	|  For input parameters, refer to the method description of create_db_connection</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">postgres_connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_decrytor</span><span class="o">.</span><span class="n">postgres</span><span class="p">(</span><span class="n">pstr_server_name</span><span class="p">,</span> <span class="n">pstr_database_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">postgres_connection</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cafex_db.database_handler.DatabaseHandler.resultlist_to_csv" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">resultlist_to_csv</span><span class="p">(</span><span class="n">plist_resultlist</span><span class="p">,</span> <span class="n">pstr_filepath</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">



<details class="description" open>
  <summary>Description</summary>
  <p>|  This method writes Result List to a csv file.</p>
</details>        <p>:param plist_resultlist:
:type plist_resultlist: Result List
:param pstr_filepath:
:type pstr_filepath: String</p>
<p>:return: CSV File</p>
<p>.. notes::
    |  Make sure to pass pstr_filepath with filename and extension as csv.</p>

            <details class="quote">
              <summary>Source code in <code>cafex_db\database_handler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">resultlist_to_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plist_resultlist</span><span class="p">,</span> <span class="n">pstr_filepath</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Description:</span>
<span class="sd">        |  This method writes Result List to a csv file.</span>

<span class="sd">    :param plist_resultlist:</span>
<span class="sd">    :type plist_resultlist: Result List</span>
<span class="sd">    :param pstr_filepath:</span>
<span class="sd">    :type pstr_filepath: String</span>


<span class="sd">    :return: CSV File</span>

<span class="sd">    .. notes::</span>
<span class="sd">        |  Make sure to pass pstr_filepath with filename and extension as csv.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">plist_resultlist</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_resultlist</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">pstr_filepath</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__obj_db_exception</span><span class="o">.</span><span class="n">raise_null_filepath</span><span class="p">()</span>

        <span class="n">list_resultset</span> <span class="o">=</span> <span class="n">plist_resultlist</span>
        <span class="n">df_resultset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">list_resultset</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">list_resultset</span><span class="p">)],</span> <span class="n">columns</span><span class="o">=</span><span class="n">list_resultset</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">df_resultset</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">pstr_filepath</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cafex_db.database_handler.DatabaseHandler.spark_execute_statement" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">spark_execute_statement</span><span class="p">(</span><span class="n">pobject_Sparkclient</span><span class="p">,</span> <span class="n">p_query</span><span class="p">,</span> <span class="n">pbool_default_spark_command</span><span class="p">,</span> <span class="n">pstr_name</span><span class="p">,</span> <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">



<details class="description" open>
  <summary>Description</summary>
  <p>|  This method allows user to execute a HIVE database query statement using spark-sql.</p>
</details>        <p>:param pobject_Sparkclient:
:type pobject_Sparkclient: Spark-Sql Database Connection Object
:param p_query:
:type p_query: String
:param pstr_return_type: list/resultset
:type pstr_return_type: String
:param pint_driver_memory: driver memory
:type pint_driver_memory: int
:param pint_executors: number of executors
:type pint_executors: int
:param pint_cores: number of cores
:type pint_cores: int
:param pint_executor_memory: executor memory
:type pint_executor_memory: int
:param pstr_other_param: accepts other parameters like --conf spark.yarn.am.nodeLabelExpression=xlarge --conf spark.dynamicAllocation.enabled=false
:type pstr_other_param: string
:param pbool_default_spark_command: if the value is True it none of the above parameters need to be passed in the method
:type pbool_default_spark_command: boolean
:param pstr_name: QA name
:type pstr_name: string</p>
<p>:return: List or ResultSet or Boolean</p>
<p>.. notes::
    |  This method returns a list or a resultset based on the parameter pstr_return_type. 'select' statements will returns List/Resultset and other type of statements will return Boolean.</p>

            <details class="quote">
              <summary>Source code in <code>cafex_db\database_handler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">spark_execute_statement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pobject_Sparkclient</span><span class="p">,</span> <span class="n">p_query</span><span class="p">,</span> <span class="n">pbool_default_spark_command</span><span class="p">,</span> <span class="n">pstr_name</span><span class="p">,</span>
                            <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Description:</span>
<span class="sd">        |  This method allows user to execute a HIVE database query statement using spark-sql.</span>

<span class="sd">    :param pobject_Sparkclient:</span>
<span class="sd">    :type pobject_Sparkclient: Spark-Sql Database Connection Object</span>
<span class="sd">    :param p_query:</span>
<span class="sd">    :type p_query: String</span>
<span class="sd">    :param pstr_return_type: list/resultset</span>
<span class="sd">    :type pstr_return_type: String</span>
<span class="sd">    :param pint_driver_memory: driver memory</span>
<span class="sd">    :type pint_driver_memory: int</span>
<span class="sd">    :param pint_executors: number of executors</span>
<span class="sd">    :type pint_executors: int</span>
<span class="sd">    :param pint_cores: number of cores</span>
<span class="sd">    :type pint_cores: int</span>
<span class="sd">    :param pint_executor_memory: executor memory</span>
<span class="sd">    :type pint_executor_memory: int</span>
<span class="sd">    :param pstr_other_param: accepts other parameters like --conf spark.yarn.am.nodeLabelExpression=xlarge --conf spark.dynamicAllocation.enabled=false</span>
<span class="sd">    :type pstr_other_param: string</span>
<span class="sd">    :param pbool_default_spark_command: if the value is True it none of the above parameters need to be passed in the method</span>
<span class="sd">    :type pbool_default_spark_command: boolean</span>
<span class="sd">    :param pstr_name: QA name</span>
<span class="sd">    :type pstr_name: string</span>

<span class="sd">    :return: List or ResultSet or Boolean</span>

<span class="sd">    .. notes::</span>
<span class="sd">        |  This method returns a list or a resultset based on the parameter pstr_return_type. &#39;select&#39; statements will returns List/Resultset and other type of statements will return Boolean.</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">int_driver_memory</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pint_driver_memory&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">int_executors</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pint_executors&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">int_cores</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pint_cores&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">int_executor_memory</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pint_executor_memory&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">str_other_param</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pstr_other_param&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">pobject_Sparkclient</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Object is None&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">p_query</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The query is None&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pstr_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;The spark config name is None&quot;</span><span class="p">)</span>

        <span class="n">pobject_Sparkclient</span><span class="o">.</span><span class="n">invoke_shell</span><span class="p">()</span>
        <span class="n">str_sparkAppConfig</span> <span class="o">=</span> <span class="s1">&#39;spark-sql&#39;</span>
        <span class="k">if</span> <span class="n">pbool_default_spark_command</span><span class="p">:</span>
            <span class="n">str_sparkAppConfig</span> <span class="o">=</span> <span class="n">str_sparkAppConfig</span> <span class="o">+</span> <span class="s1">&#39; --name &#39;</span> <span class="o">+</span> <span class="n">pstr_name</span> <span class="o">+</span> <span class="s1">&#39; -S -e &#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">str_sparkAppConfig</span> <span class="o">=</span> <span class="n">str_sparkAppConfig</span> <span class="o">+</span> <span class="s1">&#39; --master yarn &#39;</span>
            <span class="k">if</span> <span class="n">int_driver_memory</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">str_sparkAppConfig</span> <span class="o">=</span> <span class="n">str_sparkAppConfig</span> <span class="o">+</span> <span class="s1">&#39; --driver-memory &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">int_driver_memory</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;g&#39;</span>
            <span class="k">if</span> <span class="n">int_executors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">str_sparkAppConfig</span> <span class="o">=</span> <span class="n">str_sparkAppConfig</span> <span class="o">+</span> <span class="s1">&#39; --num-executors &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">int_executors</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">int_cores</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">str_sparkAppConfig</span> <span class="o">=</span> <span class="n">str_sparkAppConfig</span> <span class="o">+</span> <span class="s1">&#39; --executor-cores=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">int_cores</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">int_executor_memory</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">str_sparkAppConfig</span> <span class="o">=</span> <span class="n">str_sparkAppConfig</span> <span class="o">+</span> <span class="s1">&#39; --executor-memory &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">int_executor_memory</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;g&#39;</span>
            <span class="k">if</span> <span class="n">str_other_param</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">str_sparkAppConfig</span> <span class="o">=</span> <span class="n">str_sparkAppConfig</span> <span class="o">+</span> <span class="n">str_other_param</span>
            <span class="k">if</span> <span class="n">pstr_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">str_sparkAppConfig</span> <span class="o">=</span> <span class="n">str_sparkAppConfig</span> <span class="o">+</span> <span class="s1">&#39; --name &#39;</span> <span class="o">+</span> <span class="n">pstr_name</span> <span class="o">+</span> <span class="s1">&#39; -S -e &#39;</span>

        <span class="n">stdin</span><span class="p">,</span> <span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span> <span class="o">=</span> <span class="n">pobject_Sparkclient</span><span class="o">.</span><span class="n">exec_command</span><span class="p">(</span><span class="n">str_sparkAppConfig</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\&quot;</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">p_query</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\&quot;</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">str_errResult</span> <span class="o">=</span> <span class="n">stderr</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">str_errResult</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="p">(</span><span class="s1">&#39;Error in query&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">str_errResult</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="n">hive_SSH</span><span class="o">.</span><span class="n">SSHException</span><span class="p">(</span><span class="s2">&quot;Execute command Error:&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">str_errResult</span><span class="p">))</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">rs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataframe_to_resultset</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pstr_return_type</span> <span class="o">==</span> <span class="s1">&#39;list&#39;</span><span class="p">:</span>
            <span class="n">rs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resultset_to_list</span><span class="p">(</span><span class="n">rs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rs</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cafex_db.database_handler.DatabaseHandler.verify_column_metadata" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">verify_column_metadata</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span> <span class="n">pstr_db_name</span><span class="p">,</span> <span class="n">pstr_table_name</span><span class="p">,</span> <span class="n">pstr_col_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">



<details class="description" open>
  <summary>Description</summary>
  <p>|  This method is used to perform different operation on any column like checking its existence, its datatype, its max length, its NULL and
   Primtary key constraints etc.</p>
</details>        <p>:param pobj_connection: This parameter contains the connection object provided by the user
:type pobj_connection: Object
:param pstr_db_name: This parameter contains the database name provided by the user
:type pstr_db_name: string
:param pstr_table_name: This parameter contains the table name provided by the user
:type pstr_table_name: string
:param pstr_col_name: This parameter contains the column name provided by the user
:type pstr_col_name: string
:param bln_col_existence: This flag tells us that the user wants to check the column's existence
:type bln_col_existence: bool
:param bln_data_type: This flag tells us that the user wants to get the Data Type of particular column
:type bln_data_type: bool
:param bln_max_length: This flag tells us that the user wants to get the Maximum length of particular column
:type bln_max_length: bool
:param bln_is_null: This flag tells us that the user wants to verify the NULL constraint of respective column
:type bln_is_null: bool
:param bln_is_not_null: This flag tells us that the user wants to verify the Not NULL constraint of respective column
:type bln_is_not_null: bool
:param bln_is_primary_key: This flag tells us that the user wants to verify the Primary Key constraint of respective column
:type bln_is_primary_key: bool
:param bln_is_not_primary_key: This flag tells us that the user wants to verify the No Primary Key constraint of respective column
:type bln_is_not_primary_key: bool</p>
<p>:return: dictionary</p>


<p><span class="doc-section-title">Examples:</span></p>
    <p>| verify_column_metadata(connection,database_name,table_name,column_name,bln_col_existence=True)
| verify_column_metadata(connection,database_name,table_name,column_name,pstr_data_type=True)
| verify_column_metadata(connection,database_name,table_name,column_name,pstr_max_length=True)
| verify_column_metadata(connection,database_name,table_name,column_name,bln_is_null=True)
| verify_column_metadata(connection,database_name,table_name,column_name,bln_is_not_null=True)
| verify_column_metadata(connection,database_name,table_name,column_name,bln_is_primary_key=True)
| verify_column_metadata(connection,database_name,table_name,column_name,bln_is_not_primary_key=True)
| verify_column_metadata(connection,database_name,table_name,column_name)</p>
        <p>.. warning::
    |  This method currently supports SQL Server, PostgreSQL and Oracle DB Servers.</p>

            <details class="quote">
              <summary>Source code in <code>cafex_db\database_handler.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span>
<span class="normal">1870</span>
<span class="normal">1871</span>
<span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span>
<span class="normal">1879</span>
<span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span>
<span class="normal">1902</span>
<span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span>
<span class="normal">1906</span>
<span class="normal">1907</span>
<span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span>
<span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span>
<span class="normal">1919</span>
<span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span>
<span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span>
<span class="normal">1935</span>
<span class="normal">1936</span>
<span class="normal">1937</span>
<span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span>
<span class="normal">1950</span>
<span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span>
<span class="normal">1958</span>
<span class="normal">1959</span>
<span class="normal">1960</span>
<span class="normal">1961</span>
<span class="normal">1962</span>
<span class="normal">1963</span>
<span class="normal">1964</span>
<span class="normal">1965</span>
<span class="normal">1966</span>
<span class="normal">1967</span>
<span class="normal">1968</span>
<span class="normal">1969</span>
<span class="normal">1970</span>
<span class="normal">1971</span>
<span class="normal">1972</span>
<span class="normal">1973</span>
<span class="normal">1974</span>
<span class="normal">1975</span>
<span class="normal">1976</span>
<span class="normal">1977</span>
<span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span>
<span class="normal">1986</span>
<span class="normal">1987</span>
<span class="normal">1988</span>
<span class="normal">1989</span>
<span class="normal">1990</span>
<span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span>
<span class="normal">1997</span>
<span class="normal">1998</span>
<span class="normal">1999</span>
<span class="normal">2000</span>
<span class="normal">2001</span>
<span class="normal">2002</span>
<span class="normal">2003</span>
<span class="normal">2004</span>
<span class="normal">2005</span>
<span class="normal">2006</span>
<span class="normal">2007</span>
<span class="normal">2008</span>
<span class="normal">2009</span>
<span class="normal">2010</span>
<span class="normal">2011</span>
<span class="normal">2012</span>
<span class="normal">2013</span>
<span class="normal">2014</span>
<span class="normal">2015</span>
<span class="normal">2016</span>
<span class="normal">2017</span>
<span class="normal">2018</span>
<span class="normal">2019</span>
<span class="normal">2020</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">verify_column_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pobj_connection</span><span class="p">,</span> <span class="n">pstr_db_name</span><span class="p">,</span> <span class="n">pstr_table_name</span><span class="p">,</span> <span class="n">pstr_col_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Description:</span>
<span class="sd">        |  This method is used to perform different operation on any column like checking its existence, its datatype, its max length, its NULL and</span>
<span class="sd">           Primtary key constraints etc.</span>

<span class="sd">    :param pobj_connection: This parameter contains the connection object provided by the user</span>
<span class="sd">    :type pobj_connection: Object</span>
<span class="sd">    :param pstr_db_name: This parameter contains the database name provided by the user</span>
<span class="sd">    :type pstr_db_name: string</span>
<span class="sd">    :param pstr_table_name: This parameter contains the table name provided by the user</span>
<span class="sd">    :type pstr_table_name: string</span>
<span class="sd">    :param pstr_col_name: This parameter contains the column name provided by the user</span>
<span class="sd">    :type pstr_col_name: string</span>
<span class="sd">    :param bln_col_existence: This flag tells us that the user wants to check the column&#39;s existence</span>
<span class="sd">    :type bln_col_existence: bool</span>
<span class="sd">    :param bln_data_type: This flag tells us that the user wants to get the Data Type of particular column</span>
<span class="sd">    :type bln_data_type: bool</span>
<span class="sd">    :param bln_max_length: This flag tells us that the user wants to get the Maximum length of particular column</span>
<span class="sd">    :type bln_max_length: bool</span>
<span class="sd">    :param bln_is_null: This flag tells us that the user wants to verify the NULL constraint of respective column</span>
<span class="sd">    :type bln_is_null: bool</span>
<span class="sd">    :param bln_is_not_null: This flag tells us that the user wants to verify the Not NULL constraint of respective column</span>
<span class="sd">    :type bln_is_not_null: bool</span>
<span class="sd">    :param bln_is_primary_key: This flag tells us that the user wants to verify the Primary Key constraint of respective column</span>
<span class="sd">    :type bln_is_primary_key: bool</span>
<span class="sd">    :param bln_is_not_primary_key: This flag tells us that the user wants to verify the No Primary Key constraint of respective column</span>
<span class="sd">    :type bln_is_not_primary_key: bool</span>

<span class="sd">    :return: dictionary</span>

<span class="sd">    Examples:</span>
<span class="sd">        | verify_column_metadata(connection,database_name,table_name,column_name,bln_col_existence=True)</span>
<span class="sd">        | verify_column_metadata(connection,database_name,table_name,column_name,pstr_data_type=True)</span>
<span class="sd">        | verify_column_metadata(connection,database_name,table_name,column_name,pstr_max_length=True)</span>
<span class="sd">        | verify_column_metadata(connection,database_name,table_name,column_name,bln_is_null=True)</span>
<span class="sd">        | verify_column_metadata(connection,database_name,table_name,column_name,bln_is_not_null=True)</span>
<span class="sd">        | verify_column_metadata(connection,database_name,table_name,column_name,bln_is_primary_key=True)</span>
<span class="sd">        | verify_column_metadata(connection,database_name,table_name,column_name,bln_is_not_primary_key=True)</span>
<span class="sd">        | verify_column_metadata(connection,database_name,table_name,column_name)</span>

<span class="sd">    .. warning::</span>
<span class="sd">        |  This method currently supports SQL Server, PostgreSQL and Oracle DB Servers.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">dict_result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">rs_resultset</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;mssql&#39;</span><span class="p">,</span> <span class="s1">&#39;oracle&#39;</span><span class="p">,</span> <span class="s1">&#39;postgresql&#39;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_custom_exception</span><span class="p">(</span>
                <span class="n">pstr_message</span><span class="o">=</span><span class="s2">&quot;Error -&gt; Provided parameters are not supported&quot;</span><span class="p">,</span>
                <span class="n">pbool_fail_on_exception</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;bln_col_existence&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;oracle&#39;</span><span class="p">):</span>
                <span class="n">lst_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                    <span class="s2">&quot;SELECT * FROM all_tab_columns WHERE table_name = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND column_name =&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39; and owner=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                                    <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;list&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">lst_result</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">):</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_col_existence&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_col_existence&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;postgresql&#39;</span><span class="p">):</span>
                <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                      <span class="s2">&quot;SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND COLUMN_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; and table_schema=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                                      <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">rs_resultset</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_col_existence&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_col_existence&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;mssql&#39;</span><span class="p">):</span>
                <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                      <span class="s2">&quot;use &quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span> <span class="o">+</span> <span class="s2">&quot; SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND COLUMN_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                                      <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">rs_resultset</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_col_existence&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_col_existence&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;pstr_data_type&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;oracle&#39;</span><span class="p">):</span>
                <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                      <span class="s2">&quot;SELECT data_type FROM all_tab_columns WHERE table_name = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND column_name =&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39; and owner=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                                      <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                <span class="n">pstr_datatype</span> <span class="o">=</span> <span class="n">rs_resultset</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">pstr_datatype</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;pstr_data_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;pstr_data_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pstr_datatype</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;postgresql&#39;</span><span class="p">):</span>
                <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                      <span class="s2">&quot;SELECT DATA_TYPE FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND COLUMN_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; and table_schema=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                                      <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                <span class="n">pstr_datatype</span> <span class="o">=</span> <span class="n">rs_resultset</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">pstr_datatype</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;pstr_data_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;pstr_data_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pstr_datatype</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;mssql&#39;</span><span class="p">):</span>
                <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                      <span class="s2">&quot;use &quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span> <span class="o">+</span> <span class="s2">&quot; SELECT DATA_TYPE FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND COLUMN_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                                      <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                <span class="n">pstr_datatype</span> <span class="o">=</span> <span class="n">rs_resultset</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">pstr_datatype</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;pstr_data_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;pstr_data_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pstr_datatype</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;pstr_max_length&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;postgresql&#39;</span><span class="p">):</span>
                <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                      <span class="s2">&quot;SELECT character_maximum_length FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND COLUMN_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; and table_schema=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                                      <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                <span class="n">pstr_maxlength</span> <span class="o">=</span> <span class="n">rs_resultset</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">pstr_maxlength</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="kc">None</span><span class="p">):</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;pstr_max_length&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;pstr_max_length&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pstr_maxlength</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;mssql&#39;</span><span class="p">):</span>
                <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                      <span class="s2">&quot;use &quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span> <span class="o">+</span> <span class="s2">&quot; Select * from sys.columns where name=N&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; and OBJECT_ID = OBJECT_ID(N&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span> <span class="o">+</span> <span class="s2">&quot;&#39;)&quot;</span><span class="p">,</span>
                                                      <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                <span class="n">pstr_maxlength</span> <span class="o">=</span> <span class="n">rs_resultset</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">pstr_maxlength</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="kc">None</span><span class="p">):</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;pstr_max_length&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;pstr_max_length&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pstr_maxlength</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">5</span><span class="p">])</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;oracle&#39;</span><span class="p">):</span>
                <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                      <span class="s2">&quot;SELECT data_length FROM all_tab_columns WHERE table_name = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND column_name =&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39; and owner=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                                      <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                <span class="n">pstr_maxlength</span> <span class="o">=</span> <span class="n">rs_resultset</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">pstr_maxlength</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="kc">None</span><span class="p">):</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;pstr_max_length&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;pstr_max_length&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pstr_maxlength</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;bln_is_null&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;oracle&#39;</span><span class="p">):</span>
                <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                      <span class="s2">&quot;SELECT nullable FROM all_tab_columns WHERE table_name = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND column_name =&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39; and owner=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                                      <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                <span class="n">bln_isnull</span> <span class="o">=</span> <span class="n">rs_resultset</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">bln_isnull</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;N&#39;</span><span class="p">):</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_null&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_null&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;postgresql&#39;</span><span class="p">):</span>
                <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                      <span class="s2">&quot;SELECT is_nullable FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND COLUMN_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; and table_schema=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                                      <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                <span class="n">bln_isnull</span> <span class="o">=</span> <span class="n">rs_resultset</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">bln_isnull</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;NO&#39;</span><span class="p">):</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_null&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_null&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;mssql&#39;</span><span class="p">):</span>
                <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                      <span class="s2">&quot;use &quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span> <span class="o">+</span> <span class="s2">&quot; SELECT is_nullable FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND COLUMN_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                                      <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                <span class="n">bln_isnull</span> <span class="o">=</span> <span class="n">rs_resultset</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">bln_isnull</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;NO&#39;</span><span class="p">):</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_null&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_null&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;bln_is_not_null&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;oracle&#39;</span><span class="p">):</span>
                <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                      <span class="s2">&quot;SELECT nullable FROM all_tab_columns WHERE table_name = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND column_name =&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39; and owner=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                                      <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                <span class="n">bln_isnull</span> <span class="o">=</span> <span class="n">rs_resultset</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">bln_isnull</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;N&#39;</span><span class="p">):</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_not_null&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_not_null&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;postgresql&#39;</span><span class="p">):</span>
                <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                      <span class="s2">&quot;SELECT is_nullable FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND COLUMN_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; and table_schema=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                                      <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                <span class="n">bln_isnull</span> <span class="o">=</span> <span class="n">rs_resultset</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">bln_isnull</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;NO&#39;</span><span class="p">):</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_not_null&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_not_null&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;mssql&#39;</span><span class="p">):</span>
                <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                      <span class="s2">&quot;use &quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span> <span class="o">+</span> <span class="s2">&quot; SELECT is_nullable FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND COLUMN_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                                      <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                <span class="n">bln_isnull</span> <span class="o">=</span> <span class="n">rs_resultset</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">bln_isnull</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;NO&#39;</span><span class="p">):</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_not_null&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_not_null&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;bln_is_primary_key&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;oracle&#39;</span><span class="p">):</span>
                <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                      <span class="s2">&quot;SELECT cols.table_name, cols.column_name, cols.position, cons.status, cons.owner FROM all_constraints cons, all_cons_columns cols WHERE cols.table_name =&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39;  and cols.owner=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND cols.column_name =&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND cons.constraint_type = &#39;P&#39; AND cons.constraint_name = cols.constraint_name AND cons.owner = cols.owner ORDER BY cols.table_name, cols.position&quot;</span><span class="p">,</span>
                                                      <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;list&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">rs_resultset</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">):</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_primary_key&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_primary_key&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;postgresql&#39;</span><span class="p">):</span>
                <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                      <span class="s2">&quot;SELECT K.TABLE_NAME, C.CONSTRAINT_TYPE, K.COLUMN_NAME, K.CONSTRAINT_NAME FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS AS C JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE AS K ON C.TABLE_NAME = K.TABLE_NAME AND C.CONSTRAINT_CATALOG = K.CONSTRAINT_CATALOG AND C.CONSTRAINT_SCHEMA = K.CONSTRAINT_SCHEMA AND C.CONSTRAINT_NAME = K.CONSTRAINT_NAME WHERE C.CONSTRAINT_TYPE = &#39;PRIMARY KEY&#39; And K.Table_Name=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; And K.Column_name=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; and K.table_schema=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; ORDER BY K.TABLE_NAME, C.CONSTRAINT_TYPE, K.CONSTRAINT_NAME&quot;</span><span class="p">,</span>
                                                      <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">rs_resultset</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_primary_key&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_primary_key&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;mssql&#39;</span><span class="p">):</span>
                <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                      <span class="s2">&quot;use &quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span> <span class="o">+</span> <span class="s2">&quot; SELECT K.TABLE_NAME, C.CONSTRAINT_TYPE, K.COLUMN_NAME, K.CONSTRAINT_NAME FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS AS C JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE AS K ON C.TABLE_NAME = K.TABLE_NAME AND C.CONSTRAINT_CATALOG = K.CONSTRAINT_CATALOG AND C.CONSTRAINT_SCHEMA = K.CONSTRAINT_SCHEMA AND C.CONSTRAINT_NAME = K.CONSTRAINT_NAME WHERE C.CONSTRAINT_TYPE = &#39;PRIMARY KEY&#39; And K.Table_Name=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; And K.Column_name=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; ORDER BY K.TABLE_NAME, C.CONSTRAINT_TYPE, K.CONSTRAINT_NAME&quot;</span><span class="p">,</span>
                                                      <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">rs_resultset</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_primary_key&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_primary_key&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;bln_is_not_primary_key&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;oracle&#39;</span><span class="p">):</span>
                <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                      <span class="s2">&quot;SELECT cols.table_name, cols.column_name, cols.position, cons.status, cons.owner FROM all_constraints cons, all_cons_columns cols WHERE cols.table_name =&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND cols.column_name =&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND cons.constraint_type = &#39;P&#39; AND cons.constraint_name = cols.constraint_name AND cons.owner = cols.owner ORDER BY cols.table_name, cols.position&quot;</span><span class="p">,</span>
                                                      <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;list&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">rs_resultset</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">):</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_not_primary_key&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_not_primary_key&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;postgresql&#39;</span><span class="p">):</span>
                <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                      <span class="s2">&quot;SELECT K.TABLE_NAME, C.CONSTRAINT_TYPE, K.COLUMN_NAME, K.CONSTRAINT_NAME FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS AS C JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE AS K ON C.TABLE_NAME = K.TABLE_NAME AND C.CONSTRAINT_CATALOG = K.CONSTRAINT_CATALOG AND C.CONSTRAINT_SCHEMA = K.CONSTRAINT_SCHEMA AND C.CONSTRAINT_NAME = K.CONSTRAINT_NAME WHERE C.CONSTRAINT_TYPE = &#39;PRIMARY KEY&#39; And K.Table_Name=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; And K.Column_name=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; and K.table_schema=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; ORDER BY K.TABLE_NAME, C.CONSTRAINT_TYPE, K.CONSTRAINT_NAME&quot;</span><span class="p">,</span>
                                                      <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">rs_resultset</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_not_primary_key&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_not_primary_key&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;mssql&#39;</span><span class="p">):</span>
                <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                      <span class="s2">&quot;use &quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span> <span class="o">+</span> <span class="s2">&quot; SELECT K.TABLE_NAME, C.CONSTRAINT_TYPE, K.COLUMN_NAME, K.CONSTRAINT_NAME FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS AS C JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE AS K ON C.TABLE_NAME = K.TABLE_NAME AND C.CONSTRAINT_CATALOG = K.CONSTRAINT_CATALOG AND C.CONSTRAINT_SCHEMA = K.CONSTRAINT_SCHEMA AND C.CONSTRAINT_NAME = K.CONSTRAINT_NAME WHERE C.CONSTRAINT_TYPE = &#39;PRIMARY KEY&#39; And K.Table_Name=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; And K.Column_name=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; ORDER BY K.TABLE_NAME, C.CONSTRAINT_TYPE, K.CONSTRAINT_NAME&quot;</span><span class="p">,</span>
                                                      <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">rs_resultset</span><span class="o">.</span><span class="n">rowcount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_not_primary_key&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">dict_result</span><span class="p">[</span><span class="s1">&#39;bln_is_not_primary_key&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dict_result</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">pobj_connection</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;oracle&#39;</span><span class="p">):</span>
                    <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                          <span class="s2">&quot;SELECT * FROM all_tab_columns WHERE table_name = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND column_name = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39; and owner=&#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_db_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                                          <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">rs_resultset</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">rs_resultset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_statement</span><span class="p">(</span><span class="n">pobj_connection</span><span class="p">,</span>
                                                          <span class="s2">&quot;SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_table_name</span> <span class="o">+</span> <span class="s2">&quot;&#39; AND COLUMN_NAME = &#39;&quot;</span> <span class="o">+</span> <span class="n">pstr_col_name</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
                                                          <span class="n">pstr_return_type</span><span class="o">=</span><span class="s1">&#39;resultset&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">rs_resultset</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">dict_result</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__obj_generic_exception</span><span class="o">.</span><span class="n">raise_generic_exception</span><span class="p">(</span>
            <span class="n">pstr_message</span><span class="o">=</span><span class="s2">&quot;Error -&gt; Column information id not given properly &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
            <span class="n">pbool_insert_kibana</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">pbool_trim_log</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pbool_log_local_exceptions</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">pbool_fail_on_exception</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">pbool_use_pytest_format</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../../../../../../..", "features": [], "search": "../../../../../../../../../assets/javascripts/workers/search.07f07601.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../../../../../../assets/javascripts/bundle.56dfad97.min.js"></script>
      
    
  </body>
</html>